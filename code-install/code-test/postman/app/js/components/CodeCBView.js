(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{"./integrations/codegen/components/CodeCBView.js":function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"default",(function(){return m}));var s,o=n("../../node_modules/react/index.js"),a=n.n(o),i=n("../../node_modules/mobx-react/dist/mobx-react.module.js"),r=n("../../node_modules/mobx/lib/mobx.module.js"),d=n("./appsdk/contextbar/ContextBarViewHeader.js"),c=n("./js/modules/services/AnalyticsService.js"),l=n("./integrations/codegen/components/CodeControls.js"),p=n("./integrations/codegen/components/CodeSnippetEditor.js"),g=n("./js/services/CodeGeneratorExperimental.js"),h=n("./js/utils/ClipboardHelper.js"),u=n("./js/stores/get-store.js");let m=Object(i.observer)(s=class extends a.a.Component{constructor(t){super(t),this.state={activeLanguage:{language:"curl",variant:"cURL"},optionsArray:[],optionsPreference:{},codeSnippet:"",originalSnippetHash:"",codeCopied:!1,selectedLanguage:{}},this.handleCodeTypeSelect=this.handleCodeTypeSelect.bind(this),this.handleSnippetChange=this.handleSnippetChange.bind(this),this.handleCopyCode=this.handleCopyCode.bind(this),this.store=Object(u.getStore)("CodegenStore"),this.throttledGenerateSnippet=e.throttle(this.handleCodeTypeSelect.bind(this),500,{leading:!0,trailing:!0})}componentDidMount(){var t={id:this.store.languagePreference},{language:n,variant:s}=e.isObject(t.id)?t:JSON.parse(t.id);this.disposePreviewReaction=Object(r.reaction)((()=>{let e=Object(u.getStore)("EditorStore").find(this.props.contextData.editorId),t=e&&e.model;return t&&t.viewState&&Object(r.toJS)(t.viewState.previewRequest)}),(()=>{this.throttledGenerateSnippet(this.state.selectedLanguage)})),this.handleCodeTypeSelect(t),c.default.addEventV2({category:"codegen",action:"open_codegen_contextbar",label:`${n}_${s}`})}componentWillUnmount(){this.disposePreviewReaction&&this.disposePreviewReaction()}componentDidUpdate(t){const{id:n}=t.contextData||{};n!==e.get(this.props.contextData,"id")&&this.handleCodeTypeSelect(this.state.selectedLanguage)}hash(e){return n("../../node_modules/crypto-browserify/index.js").createHash("sha1").update(e).digest("base64")}handleCodeTypeSelect(t){e.isEmpty(t)||this.setState({selectedLanguage:t});let n,s=e.isEmpty(t)?this.store.languagePreference:JSON.parse(t.id),{language:o,variant:a}=s,i={};this.setState({activeLanguage:{language:o,variant:a}}),g.default.getOptions(o,a).then((e=>{e&&e.length&&(this.setState({optionsArray:e}),e.forEach((e=>{i[e.id]=e.default})))})).catch((e=>{this.setState({optionsArray:[]}),pm.logger.error(`CodeCBView~handleCodeTypeSelect - ${e}`)})).then((()=>{n=this.store.getSnippetOptionForLanguage(o,a)||i,this.setState({optionsPreference:n})})).then((()=>{let e=this.props.contextData&&this.props.contextData.type;g.default.getSnippet(this.props.contextData.editorId,{language:o,variant:a,optionsPreference:n},e).then((e=>{if(!e)return;let t=this.hash(e.snippet);t!==this.state.originalSnippetHash&&this.setState({codeSnippet:e.snippet,originalSnippetHash:t},(()=>{let e=JSON.stringify({language:o,variant:a});this.store.updateLanguagePreference(e)}))}))}))}handleSnippetChange(e){this.setState({codeSnippet:e})}handleCopyCode(){h.default.copy(this.state.codeSnippet),this.setState({codeCopied:!0}),clearTimeout(this.timeout),this.timeout=setTimeout((()=>{this.setState({codeCopied:!1})}),1500)}render(){let t,n=e.get(this.state.activeLanguage,"language","curl"),{controller:s={}}=this.props||{},o=e.get(this.state.activeLanguage,"variant","cURL"),i=s.labelEditorMap&&s.labelEditorMap[`${n}_${o}`]?s.labelEditorMap[`${n}_${o}`].editorMode:"powershell",r={indentationType:this.state.optionsPreference.indentType?e.toLower(this.state.optionsPreference.indentType):null,indentationSize:this.state.optionsPreference.indentCount||null},c=this.store.getSnippetOptions();return s.editor&&(t=s.editor.isDirty),"dart"===i&&(i="powershell"),a.a.createElement("div",{className:"context-bar-code-snippet-view"},a.a.createElement(d.ContextBarViewHeader,{title:"代码片段",onClose:this.props.onClose}),a.a.createElement("div",{className:"context-bar-code-snippet-body"},a.a.createElement(l.default,{codeCopied:this.state.codeCopied,languageList:s.languageList,onSelectLanguage:this.handleCodeTypeSelect,selectedLanguage:this.state.selectedLanguage,handleCopyCode:this.handleCopyCode,snippetOptions:c,isDirty:t}),a.a.createElement(p.default,{indentation:r,codeSnippet:this.state.codeSnippet,editorMode:i,handleSnippetChange:this.handleSnippetChange})))}})||s}.call(this,n("./node_modules/lodash/lodash.js"))},"./integrations/codegen/components/CodeControls.js":function(e,t,n){"use strict";n.r(t),function(e){var s=n("../../node_modules/react/index.js"),o=n.n(s),a=n("../../node_modules/@postman/aether/esmLib/index.js"),i=n("./integrations/codegen/components/ContextBarCodegenDropdown.js"),r=n("./js/components/base/Buttons.js"),d=n("./js/modules/controllers/ViewHierarchyController.js");class c extends o.a.Component{constructor(e){super(e),this.openLanguageSettingsModal=()=>{d.ModalViewManager.onMount((()=>{pm.mediator.trigger("openLanguageSettingsModel",this.props.selectedLanguage)}))},this.openLanguageSettingsModal=this.openLanguageSettingsModal.bind(this)}componentDidUpdate(t){let n=this.props.snippetOptions,s=t.snippetOptions,o=JSON.parse(this.props.selectedLanguage.id),a=e.get(o,"language","curl"),i=e.get(o,"variant","cURL");(JSON.stringify(s[`${a}_${i}`])!==JSON.stringify(n[`${a}_${i}`])||!this.props.isDirty&&t.isDirty)&&this.props.onSelectLanguage(this.props.selectedLanguage)}render(){return o.a.createElement("div",{className:"context-bar-codegen-controls"},o.a.createElement("div",{className:"context-bar-codegen-controls-left"},o.a.createElement("div",{className:"context-bar-codegen-controls-left__dropdown"},o.a.createElement(i.default,{selectedTarget:this.props.selectedLanguage,onTargetSelect:this.props.onSelectLanguage,menuClassName:"context-bar-codegen-dropdown",filterItems:this.props.languageList})),o.a.createElement("div",{className:"context-bar-codegen-controls-left__setting"},o.a.createElement(r.Button,{type:"tertiary",onClick:this.openLanguageSettingsModal},o.a.createElement(a.Icon,{name:"icon-descriptive-setting-stroke",className:"language-settings-icon",tooltip:"代码设置"})))),o.a.createElement("div",{className:"context-bar-codegen-controls-right"},o.a.createElement("div",{className:"context-bar-codegen-controls-right__copy"},this.props.codeCopied?o.a.createElement(r.Button,{onClick:this.props.handleCopyCode,tooltip:"已拷贝"},o.a.createElement(a.Icon,{name:"icon-state-success-stroke",className:"code-copied-icon"})):o.a.createElement(r.Button,{type:"tertiary",onClick:this.props.handleCopyCode,tooltip:"拷贝片段"},o.a.createElement(a.Icon,{name:"icon-action-copy-stroke",className:"code-copy-icon"})))))}}t.default=c}.call(this,n("./node_modules/lodash/lodash.js"))},"./integrations/codegen/components/CodeSnippetEditor.js":function(e,t,n){"use strict";n.r(t);var s=n("../../node_modules/react/index.js"),o=n.n(s),a=n("./appsdk/components/editors/texteditor/TextEditor.js");class i extends o.a.Component{constructor(e){super(e)}render(){return o.a.createElement("div",{className:"context-bar-code-snippet-editor"},o.a.createElement(a.default,{ref:e=>e&&e.focus(),indentation:this.props.indentation,value:this.props.codeSnippet,language:this.props.editorMode,onChange:this.props.handleSnippetChange,wordWrap:!0,ref:"editor"}))}}t.default=i},"./integrations/codegen/components/ContextBarCodegenDropdown.js":function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"default",(function(){return d}));var s=n("../../node_modules/react/index.js"),o=n.n(s),a=n("./js/components/base/InputSelectV2.js"),i=n("./js/components/base/XPaths/XPath.js"),r=n("./js/components/base/SearchHighlighter.js");class d extends s.Component{constructor(e){super(e),this.selectedTarget=this.selectedTarget.bind(this)}getFilteredList(t,n,s={}){return!n||s.firstRender?t:e.filter(t,(t=>t.id&&e.includes(t.name.toLowerCase(),n.toLowerCase())))}selectedTarget(){var t=this.props.filterItems,n=this.props.selectedTarget,s=e.find(t,(e=>e.id===n.id));return s||{id:'{language:"curl",variant:"cURL"}',name:"cURL"}}getOption(e,t,n={}){const s=e.name,a=e.id;return t&&!n.firstRender?o.a.createElement(i.default,null,o.a.createElement("div",{className:"input-select-item",key:a},o.a.createElement(r.default,{source:s,query:t}))):o.a.createElement(i.default,null,o.a.createElement("div",{className:"input-select-item",key:a},s))}render(){var{filterItems:e}=this.props;return o.a.createElement("div",{className:"context-bar-dropdown-wrapper"},o.a.createElement("div",null,o.a.createElement(a.InputSelectV2,{style:{height:"32px"},onSelect:this.props.onTargetSelect,getFilteredList:this.getFilteredList.bind(this,e),optionRenderer:this.getOption,selectedItem:this.selectedTarget(),ref:"inputSelect",menuClassName:this.props.menuClassName,getInputValue:e=>e.name||""})))}}}.call(this,n("./node_modules/lodash/lodash.js"))}}]);