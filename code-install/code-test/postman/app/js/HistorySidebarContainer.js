(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{"./integrations/proxy/components/ProxyHistorySidebarListItem.js":function(e,t,s){"use strict";s.r(t),function(e){s.d(t,"default",(function(){return A}));var o,i=s("../../node_modules/react/index.js"),n=s.n(i),r=s("../../node_modules/react-dom/index.js"),l=s("./node_modules/moment/moment.js"),a=s.n(l),d=s("./node_modules/classnames/index.js"),c=s.n(d),h=s("../../node_modules/@postman/aether/esmLib/index.js"),p=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),m=s("./js/components/base/Avatar.js"),u=s("./js/components/base/Tooltips.js"),S=s("./js/containers/apps/requester/sidebar/SidebarListItem.js"),b=s("./js/stores/get-store.js"),g=s("./runtime-repl/_common/DisabledTooltipConstants.js"),y=s("./js/components/base/Dropdowns.js"),E=s("./js/services/NavigationService.js"),T=s("./integrations/proxy/services/ProxyHistoryService.js"),_=s("./js/controllers/ShortcutsList.js"),I=s("./integrations/proxy/helpers/constants.js"),O=s("./integrations/navigation/constants.js");let A=Object(p.observer)(o=class extends i.Component{constructor(e){super(e),this.state={isTooltipVisible:!1},this.proxyStore=Object(b.getStore)("ProxySessionsSettingsStore"),this.userAvatar=n.a.createRef(),this.handleSelect=this.handleSelect.bind(this),this.handleAction=this.handleAction.bind(this),this.showTooltip=this.showTooltip.bind(this),this.hideTooltip=this.hideTooltip.bind(this),this.getLeftAlignedComponents=this.getLeftAlignedComponents.bind(this),this.getActionMenuItems=this.getActionMenuItems.bind(this),this.handleRenameSubmit=this.handleRenameSubmit.bind(this),this.containerRef=this.containerRef.bind(this),this.handleDropdownActionSelect=this.handleDropdownActionSelect.bind(this)}componentDidMount(){this.selfNode=Object(r.findDOMNode)(this),this.props.observeSizeChange&&this.props.observeSizeChange(this.selfNode)}componentWillUpdate(e){if(!this.props.selected&&e.selected){const e=Object(r.findDOMNode)(this);e&&e.scrollIntoViewIfNeeded&&e.scrollIntoViewIfNeeded()}}componentWillUnmount(){this.props.unobserveSizeChange&&this.props.unobserveSizeChange(this.selfNode,this.props.index)}getClasses(){return c()({"history-sidebar-list-item":!0,"history-sidebar-list-item__proxy-history":!0,"is-selected":this.props.selected})}getTooltipText(e,t){return e?t?g.DISABLED_TOOLTIP_IS_OFFLINE:g.DISABLED_TOOLTIP_NO_PERMISSION:"删除历史"}getLeftAlignedComponents(e){if(!e)return n.a.createElement("div",{className:"history-sidebar__indent"});const t=c()({"history-sidebar-list-item-updatedBy":!0,hovered:e}),s=Object(b.getStore)("CurrentUserStore").teamMembers.get(String(this.props.owner)),o=s&&(s.name||s.username);return n.a.createElement("div",{className:t,onMouseOver:this.showTooltip,onMouseLeave:this.hideTooltip},this.props.owner&&"0"!==this.props.owner?n.a.createElement(m.default,{ref:this.userAvatar,size:"small",userId:this.props.owner}):n.a.createElement(h.Icon,{name:"icon-descriptive-user-stroke",color:"content-color-secondary"}),this.userAvatar.current&&n.a.createElement(u.Tooltip,{immediate:!0,show:this.state.isTooltipVisible,target:this.userAvatar.current,placement:"right"},n.a.createElement(u.TooltipBody,null,n.a.createElement("div",{className:"history-sidebar-list-item-avatar-tooltip"},n.a.createElement(h.Text,{type:"body-medium"},o),n.a.createElement(h.Text,{type:"body-medium"},a()(this.props.createdAt).format("DD MMM YYYY, h:mm A"))))))}showTooltip(){this.setState({isTooltipVisible:!0})}hideTooltip(){this.setState({isTooltipVisible:!1})}handleSelect(){this.proxyStore.find(this.props.id)?this.proxyStore.update({id:this.props.id,name:this.props.name}):this.proxyStore.add({id:this.props.id,name:this.props.name,reqData:[],source:this.props.source,totalRecords:0});let t,s,o={name:this.props.name,source:this.props.source};this.props.state===I.SESSION_STATES.RUNNING?(t=O.CAPTURE_REQUESTS_SESSIONS_CONFIGURE_PAGE_IDENTIFIER,s={proxyId:I.CONFIGURE_PAGE_ID}):(t=O.CAPTURE_REQUEST_POST_SESSION_PAGE_IDENTIFIER,s={proxySessionId:this.props.id},e.assign(o,{createdAt:this.props.createdAt,fromActiveSession:!1})),E.default.transitionTo(t,s,{},{additionalContext:o})}handleAction(e){this.props.onSelectAction(e,{proxyhistory:[this.props.id]})}getProxySidebarIcon(e){return e==I.SESSION_STATES.RUNNING?n.a.createElement(h.IconActionCaptureStroke,{color:"content-color-success"}):n.a.createElement(h.IconActionCaptureStroke,null)}getActionMenuItems(e){let t=!1;return e===I.SESSION_STATES.RUNNING&&(t=!0),n.a.createElement(y.DropdownMenu,{"align-right":!0},n.a.createElement(y.MenuItem,{key:"proxy-rename",refKey:"proxy-rename"},n.a.createElement("div",{className:"dropdown-menu-item-label"},"Rename Session")),n.a.createElement(y.MenuItem,{key:"proxy-delete",refKey:"delete",disabled:t,disabledText:"Session is in progress"},n.a.createElement("div",{className:"dropdown-menu-item-label"},"Delete Session"),n.a.createElement("div",{className:"dropdown-menu-item-shortcut"},Object(_.getShortcutByName)("delete"))))}async handleRenameSubmit(e){await T.default.updateProxyHistory({id:this.props.id,name:e}),this.proxyStore.update({id:this.props.id,name:e}),pm.toasts.success("Session renamed successfully")}containerRef(e){this.listItemRef=e}handleEditName(){e.invoke(this.listItemRef,"editText")}handleDropdownActionSelect(e){"proxy-rename"===e&&this.handleEditName(),"delete"===e&&this.props.onSelectAction("delete",{proxyhistory:[this.props.id]})}render(){return n.a.createElement("div",{"data-index":this.props.index},n.a.createElement(S.default,{ref:this.containerRef,text:this.props.name,icon:this.getProxySidebarIcon(this.props.state),isSelected:this.props.isSelected,onClick:this.handleSelect,className:this.getClasses(),leftMetaComponent:this.getLeftAlignedComponents,state:this.props.state,moreActions:this.getActionMenuItems(this.props.state),onRename:this.handleRenameSubmit,onActionsDropdownSelect:this.handleDropdownActionSelect}))}})||o}.call(this,s("./node_modules/lodash/lodash.js"))},"./runtime-repl/history/HistoryActionsConstants.js":function(e,t,s){"use strict";s.r(t),s.d(t,"ACTION_TYPE_SAVE",(function(){return o})),s.d(t,"ACTION_TYPE_MONITOR",(function(){return i})),s.d(t,"ACTION_TYPE_DOCUMENT",(function(){return n})),s.d(t,"ACTION_TYPE_MOCK",(function(){return r})),s.d(t,"ACTION_TYPE_DELETE",(function(){return l})),s.d(t,"ACTION_TYPE_DOWNLOAD",(function(){return a}));const o="save",i="monitor",n="document",r="mock",l="delete",a="download"},"./runtime-repl/history/HistoryActionsTooltipConstants.js":function(e,t,s){"use strict";s.r(t),s.d(t,"ACTION_TYPE_DELETE_REQUEST_TOOLTIP",(function(){return o})),s.d(t,"ACTION_TYPE_DELETE_REQUESTS_TOOLTIP",(function(){return i})),s.d(t,"ACTION_TYPE_SAVE_REQUEST_TOOLTIP",(function(){return n})),s.d(t,"ACTION_TYPE_SAVE_REQUESTS_TOOLTIP",(function(){return r}));const o="删除请求",i="删除项目",n="将请求添加到集合",r="将请求添加到集合"},"./runtime-repl/history/HistoryItemActionsDropdown.js":function(e,t,s){"use strict";s.r(t),function(e){s.d(t,"default",(function(){return I}));var o,i=s("../../node_modules/react/index.js"),n=s.n(i),r=s("./node_modules/classnames/index.js"),l=s.n(r),a=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),d=s("../../node_modules/@postman/aether/esmLib/index.js"),c=s("./js/components/base/Dropdowns.js"),h=s("./js/components/base/Buttons.js"),p=s("./js/utils/PluralizeHelper.js"),m=s("./runtime-repl/history/HistoryActionsConstants.js"),u=s("./runtime-repl/_common/ScratchpadConstants.js"),S=s("./runtime-repl/_common/DisabledTooltipConstants.js"),b=s("./js/stores/get-store.js"),g=s("./js/constants/MoreButtonTooltipConstant.js"),y=s("./js/controllers/ShortcutsList.js"),E=s("./runtime-repl/collection/_api/CollectionStoreV2.js"),T=s("./collaboration/workspace/types/PermissionTypes.ts");const _="不适用于集合运行项目";let I=Object(a.observer)(o=class extends i.Component{constructor(e){super(e),this.handleSelect=this.handleSelect.bind(this),this.handleShortcutSelect=this.handleShortcutSelect.bind(this),this.handleToggle=this.handleToggle.bind(this)}async componentDidMount(){this.collectionList=await E.default.subscribe()}getKeymapHandlers(){return{delete:pm.shortcuts.handle("delete",this.handleShortcutSelect.bind(this,m.ACTION_TYPE_DELETE))}}handleShortcutSelect(e){pm.mediator.trigger("focusSidebar"),this.handleSelect(e)}handleSelect(e){this.props.onSelect&&this.props.onSelect(e),this.handleToggle(!1)}handleToggle(e){this.props.onToggle&&this.props.onToggle(e)}getDropDownActionWrapperClasses(){return l()({"collection-sidebar-request-dropdown-actions-wrapper":!0})}getDisabledText(e){if(e)return Object(b.getStore)("OnlineStatusStore").userCanSave?S.DISABLED_TOOLTIP_NO_PERMISSION:S.DISABLED_TOOLTIP_IS_OFFLINE}getAddRequestTooltip(e,t){return e?t?_:S.DISABLED_TOOLTIP_NO_PERMISSION:S.DISABLED_TOOLTIP_IS_OFFLINE}render(){const t=p.default.pluralize({count:this.props.count,singular:"请求",plural:"请求"}),{userCanSave:s}=Object(b.getStore)("OnlineStatusStore"),o=Object(b.getStore)("ActiveWorkspacePermissionStore"),i=o&&o.permissions,r=!e.get(i,T.WORKSPACE_PERMISSIONS.ADD_MOCK_TO_WORKSPACE,!0),l=!e.get(i,T.WORKSPACE_PERMISSIONS.ADD_MONITOR_TO_WORKSPACE,!0),a=s&&e.get(i,T.WORKSPACE_PERMISSIONS.REMOVE_HISTORY_FROM_WORKSPACE,!0),E=this.collectionList&&!e.isEmpty(this.collectionList.unsafeEditableCollections),I=e.get(i,T.WORKSPACE_PERMISSIONS.ADD_COLLECTION_TO_WORKSPACE,!0),O=E||I;return n.a.createElement("div",{className:this.getDropDownActionWrapperClasses()},n.a.createElement(c.Dropdown,{keyMapHandlers:this.getKeymapHandlers(),ref:"menu",onSelect:this.handleSelect,onToggle:this.handleToggle,className:"collection-sidebar-request-actions-dropdown history-sidebar-multiple-request-selected-dropdown"},n.a.createElement(c.DropdownButton,{dropdownStyle:"nocaret",type:"custom"},n.a.createElement(h.Button,{className:"history-sidebar-list-item__button__options",tooltip:g.ACTION_TYPE_VIEW_MORE_ACTIONS_TOOLTIP}," ",n.a.createElement(d.Icon,{name:"icon-action-options-stroke",className:"history-sidebar-list-item__actions__options pm-icon pm-icon-normal"}))),n.a.createElement(c.DropdownMenu,{"align-right":!0},n.a.createElement(c.MenuItem,{refKey:m.ACTION_TYPE_SAVE,disabled:!s||this.props.disableRequestSpecificActions||!O,disabledText:this.getAddRequestTooltip(s,O)},n.a.createElement("div",{className:"dropdown-menu-item-label"},`保存${t}`)),n.a.createElement(c.MenuItem,{refKey:m.ACTION_TYPE_MONITOR,disabled:!s||this.props.disableRequestSpecificActions||l,disabledText:s?this.props.disableRequestSpecificActions?_:S.DISABLED_TOOLTIP_WORKSPACE_VIEWER:S.DISABLED_TOOLTIP_IS_OFFLINE},n.a.createElement("div",{className:"dropdown-menu-item-label"},`监视${t}`)),n.a.createElement(c.MenuItem,{refKey:m.ACTION_TYPE_DOCUMENT,disabled:!s||this.props.disableRequestSpecificActions,disabledText:s?this.props.disableRequestSpecificActions?_:u.DISABLED_IN_SCRATCHPAD_TOOLTIP:S.DISABLED_TOOLTIP_IS_OFFLINE},n.a.createElement("div",{className:"dropdown-menu-item-label"},`${t}文档`)),n.a.createElement(c.MenuItem,{refKey:m.ACTION_TYPE_MOCK,disabled:!s||this.props.disableRequestSpecificActions||r,disabledText:s?this.props.disableRequestSpecificActions?_:S.DISABLED_TOOLTIP_WORKSPACE_VIEWER:S.DISABLED_TOOLTIP_IS_OFFLINE},n.a.createElement("div",{className:"dropdown-menu-item-label"},`模拟${t}`)),"browser"!==window.SDK_PLATFORM&&n.a.createElement(c.MenuItem,{refKey:m.ACTION_TYPE_DOWNLOAD,disabled:!s||!this.props.disableRequestSpecificActions,disabledText:s?"您只能导出集合运行":S.DISABLED_TOOLTIP_IS_OFFLINE},n.a.createElement("div",{className:"dropdown-menu-item-label"},"导出")),n.a.createElement(c.MenuItem,{refKey:m.ACTION_TYPE_DELETE,disabled:!a,disabledText:this.getDisabledText(!a)},n.a.createElement("div",{className:"dropdown-menu-item-label"},"删除"),n.a.createElement("div",{className:"dropdown-menu-item-shortcut"},Object(y.getShortcutByName)("delete"))))))}})||o}.call(this,s("./node_modules/lodash/lodash.js"))},"./runtime-repl/history/HistoryListCollectionRunItem.js":function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return T}));var o,i=s("../../node_modules/react/index.js"),n=s.n(i),r=s("../../node_modules/react-dom/index.js"),l=s("./node_modules/classnames/index.js"),a=s.n(l),d=s("../../node_modules/@postman/aether/esmLib/index.js"),c=s("./node_modules/moment/moment.js"),h=s.n(c),p=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),m=s("./js/components/base/Buttons.js"),u=s("./js/components/base/Avatar.js"),S=s("./js/components/base/Tooltips.js"),b=s("./runtime-repl/history/HistoryActionsConstants.js"),g=s("./runtime-repl/_common/DisabledTooltipConstants.js"),y=s("./js/stores/get-store.js"),E=s("./js/containers/apps/requester/sidebar/SidebarListItem.js");let T=Object(p.observer)(o=class extends i.Component{constructor(e){super(e),this.state={dropdownOpen:!1,isTooltipVisible:!1},this.userAvatar=n.a.createRef(),this.handleSelect=this.handleSelect.bind(this),this.handleDropdownToggle=this.handleDropdownToggle.bind(this),this.handleDropdownActionSelect=this.handleDropdownActionSelect.bind(this),this.handleRemoveRun=this.handleRemoveRun.bind(this),this.showTooltip=this.showTooltip.bind(this),this.hideTooltip=this.hideTooltip.bind(this),this.getRightAlignedComponents=this.getRightAlignedComponents.bind(this),this.getLeftAlignedComponents=this.getLeftAlignedComponents.bind(this)}componentDidMount(){this.selfNode=Object(r.findDOMNode)(this),this.props.observeSizeChange&&this.props.observeSizeChange(this.selfNode)}componentWillUnmount(){this.props.unobserveSizeChange&&this.props.unobserveSizeChange(this.selfNode,this.props.index)}componentWillUpdate(e){if(!this.props.selected&&e.selected){const e=Object(r.findDOMNode)(this);e&&e.scrollIntoViewIfNeeded&&e.scrollIntoViewIfNeeded()}}showTooltip(){this.setState({isTooltipVisible:!0})}hideTooltip(){this.setState({isTooltipVisible:!1})}handleSelect(e){e.stopPropagation();const t={ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};this.props.onSelect&&this.props.onSelect({id:this.props.id,type:"collectionrun"},t)}getClasses(){return a()({"history-sidebar-list-item":!0,"history-sidebar-list-item__collection":!0,"is-hovered":this.state.dropdownOpen,"is-selected":this.props.selected})}handleDropdownToggle(e){e!==this.state.dropdownOpen&&this.setState({dropdownOpen:e})}handleDropdownActionSelect(e){this.props.onSelectAction(e,{runs:[this.props.id]})}handleRemoveRun(e){e.stopPropagation(),this.handleDropdownActionSelect(b.ACTION_TYPE_DELETE)}getTooltipText(e){return e?Object(y.getStore)("OnlineStatusStore").userCanSave?g.DISABLED_TOOLTIP_NO_PERMISSION:g.DISABLED_TOOLTIP_IS_OFFLINE:"删除集合运行"}getLeftAlignedComponents(e,t){const s=a()({"history-sidebar-list-item-updatedBy":!0,hovered:e});if(!e&&!t)return n.a.createElement("div",{className:"history-sidebar__indent"});const o=Object(y.getStore)("CurrentUserStore").teamMembers.get(this.props.owner),i=o&&(o.name||o.username);return n.a.createElement("div",{className:s,onMouseEnter:this.showTooltip,onMouseLeave:this.hideTooltip},this.props.owner&&"0"!==this.props.owner?n.a.createElement(u.default,{ref:this.userAvatar,size:"small",userId:this.props.owner}):n.a.createElement(d.Icon,{name:"icon-descriptive-user-stroke",className:"pm-icon pm-icon-normal"}),this.userAvatar.current&&n.a.createElement(S.Tooltip,{immediate:!0,show:this.state.isTooltipVisible,target:this.userAvatar.current,placement:"right"},n.a.createElement(S.TooltipBody,null,n.a.createElement("div",null,n.a.createElement("div",null,i),n.a.createElement("div",null,h()(this.props.createdAt).format("DD MMM YYYY, h:mm A"))))))}getRightAlignedComponents(e,t){const s=a()({"sidebar-list-item__right-section-actions":!0,hovered:e});if(!e&&!t)return null;const o=Object(y.getStore)("PermissionStore"),{userCanSave:i}=Object(y.getStore)("OnlineStatusStore"),r=i&&o.can("delete","collectionrun",this.props.id);return n.a.createElement("div",{className:s},n.a.createElement(m.Button,{className:"history-sidebar-list-item__button__delete",type:"icon",onClick:this.handleRemoveRun,disabled:!r,tooltip:this.getTooltipText(!r)},n.a.createElement(d.Icon,{name:"icon-action-delete-stroke",className:"history-sidebar-list-item__actions__delete pm-icon pm-icon-normal"})))}render(){return n.a.createElement(E.default,{"data-index":this.props.index,text:this.props.name,icon:"icon-action-run-stroke",isSelected:this.props.selected,onClick:this.handleSelect,className:this.getClasses(),rightMetaComponent:this.getRightAlignedComponents,leftMetaComponent:this.getLeftAlignedComponents})}})||o},"./runtime-repl/history/HistoryListErrorItem.js":function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return n}));var o=s("../../node_modules/react/index.js"),i=s.n(o);function n(e){return i.a.createElement("div",{className:"history-sidebar-list-item-group"},i.a.createElement("div",{className:"history-sidebar-list-item-group__error"},"无法加载项."," ",i.a.createElement("span",{onClick:e.onRetry},"重试")))}},"./runtime-repl/history/HistoryListItem.js":function(e,t,s){"use strict";s.r(t),function(e){s.d(t,"default",(function(){return v}));var o,i=s("../../node_modules/react/index.js"),n=s.n(i),r=s("../../node_modules/react-dom/index.js"),l=s("./node_modules/classnames/index.js"),a=s.n(l),d=s("./node_modules/moment/moment.js"),c=s.n(d),h=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),p=s("../../node_modules/@postman/aether/esmLib/index.js"),m=s("./js/components/base/Buttons.js"),u=s("./js/components/base/Dropdowns.js"),S=s("./js/components/base/Avatar.js"),b=s("./js/components/base/Tooltips.js"),g=s("./js/containers/apps/requester/sidebar/SidebarListItem.js"),y=s("./runtime-repl/history/HistoryActionsConstants.js"),E=s("./runtime-repl/_common/DisabledTooltipConstants.js"),T=s("./runtime-repl/_common/ScratchpadConstants.js"),_=s("./js/stores/get-store.js"),I=s("./runtime-repl/history/HistoryActionsTooltipConstants.js"),O=s("./runtime-repl/request-http/RequestIcon.js"),A=s("./js/controllers/ShortcutsList.js"),C=s("./runtime-repl/collection/_api/CollectionStoreV2.js"),f=s("./collaboration/workspace/types/PermissionTypes.ts");let v=Object(h.observer)(o=class extends i.Component{constructor(e){super(e),this.state={dropdownOpen:!1,isTooltipVisible:!1},this.userAvatar=n.a.createRef(),this.handleSelect=this.handleSelect.bind(this),this.handleDropdownToggle=this.handleDropdownToggle.bind(this),this.handleDropdownActionSelect=this.handleDropdownActionSelect.bind(this),this.handleAddRequestToCollectionClick=this.handleAddRequestToCollectionClick.bind(this),this.handleRemoveRequest=this.handleRemoveRequest.bind(this),this.showTooltip=this.showTooltip.bind(this),this.hideTooltip=this.hideTooltip.bind(this),this.getLeftAlignedComponents=this.getLeftAlignedComponents.bind(this),this.getRightAlignedComponents=this.getRightAlignedComponents.bind(this)}async componentDidMount(){this.selfNode=Object(r.findDOMNode)(this),this.props.observeSizeChange&&this.props.observeSizeChange(this.selfNode),this.collectionList=await C.default.subscribe()}componentWillUnmount(){this.props.unobserveSizeChange&&this.props.unobserveSizeChange(this.selfNode,this.props.index)}componentWillUpdate(e){if(!this.props.selected&&e.selected){const e=Object(r.findDOMNode)(this);if(!e)return;e.scrollIntoViewIfNeeded?e.scrollIntoViewIfNeeded():e.scrollIntoView()}}showTooltip(){this.setState({isTooltipVisible:!0})}hideTooltip(){this.setState({isTooltipVisible:!1})}handleSelect(e){e.stopPropagation();const t={ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};this.props.onSelect&&this.props.onSelect({id:this.props.id,type:"request"},t)}getClasses(){return a()({"history-sidebar-list-item":!0,"history-sidebar-list-item__request":!0,"is-hovered":this.state.dropdownOpen,"is-selected":this.props.selected})}handleDropdownToggle(e){e!==this.state.dropdownOpen&&this.setState({dropdownOpen:e})}handleDropdownActionSelect(e){this.props.onSelectAction(e,{requests:[this.props.id],from:"history_single"})}handleAddRequestToCollectionClick(e){e.stopPropagation(),this.handleDropdownActionSelect(y.ACTION_TYPE_SAVE,{from:"history_single"})}handleRemoveRequest(e){e.stopPropagation(),this.handleDropdownActionSelect(y.ACTION_TYPE_DELETE)}getTooltipText(e,t){return e?t?E.DISABLED_TOOLTIP_IS_OFFLINE:E.DISABLED_TOOLTIP_NO_PERMISSION:I.ACTION_TYPE_DELETE_REQUEST_TOOLTIP}getDisabledText(e,t){return t?E.DISABLED_TOOLTIP_IS_OFFLINE:E.DISABLED_TOOLTIP_NO_PERMISSION}getLeftAlignedComponents(e,t){const s=a()({"history-sidebar-list-item-updatedBy":!0,hovered:e});if(!e&&!t)return n.a.createElement("div",{className:"history-sidebar__indent"});const o=Object(_.getStore)("CurrentUserStore").teamMembers.get(this.props.lastUpdatedBy),i=o&&(o.name||o.username);return n.a.createElement("div",{className:s,onMouseEnter:this.showTooltip,onMouseLeave:this.hideTooltip},this.props.lastUpdatedBy&&"0"!==this.props.lastUpdatedBy?n.a.createElement(S.default,{ref:this.userAvatar,size:"small",userId:this.props.lastUpdatedBy}):n.a.createElement(p.Icon,{name:"icon-descriptive-user-stroke",className:"pm-icon pm-icon-normal"}),this.userAvatar.current&&n.a.createElement(b.Tooltip,{immediate:!0,show:this.state.isTooltipVisible,target:this.userAvatar.current,placement:"right"},n.a.createElement(b.TooltipBody,null,n.a.createElement("div",null,n.a.createElement("div",null,i),n.a.createElement("div",null,c()(this.props.createdAt).format("DD MMM YYYY, h:mm A"))))))}getSaveRequestTooltip(e,t){return e?t?I.ACTION_TYPE_SAVE_REQUEST_TOOLTIP:E.DISABLED_TOOLTIP_NO_PERMISSION:E.DISABLED_TOOLTIP_IS_OFFLINE}getRightAlignedComponents(t,s){const o=a()({"sidebar-list-item__right-section-actions":!0,hovered:t});if(!t&&!s)return null;const i=Object(_.getStore)("PermissionStore"),{userCanSave:r}=Object(_.getStore)("OnlineStatusStore"),l=r&&i.can("delete","history",this.props.id),d=this.collectionList&&!e.isEmpty(this.collectionList.unsafeEditableCollections),c=Object(_.getStore)("ActiveWorkspacePermissionStore"),h=c&&c.permissions,u=e.get(h,f.WORKSPACE_PERMISSIONS.ADD_COLLECTION_TO_WORKSPACE,!0),S=d||u;return n.a.createElement("div",{className:o},n.a.createElement(m.Button,{className:"history-sidebar-list-item__button__add",type:"icon",onClick:this.handleAddRequestToCollectionClick,disabled:!r||!S,tooltip:this.getSaveRequestTooltip(r,S)},n.a.createElement(p.Icon,{size:"large",name:"icon-action-add-stroke",className:"history-sidebar-list-item__actions__add pm-icon pm-icon-normal"})),n.a.createElement(m.Button,{className:"history-sidebar-list-item__button__delete",type:"icon",onClick:this.handleRemoveRequest,disabled:!l,tooltip:this.getTooltipText(!l,!r)},n.a.createElement(p.Icon,{name:"icon-action-delete-stroke",size:"large",className:"history-sidebar-list-item__actions__delete pm-icon pm-icon-normal"})))}getDisabledTooltip(e,t){return e?t?E.DISABLED_TOOLTIP_WORKSPACE_VIEWER:T.DISABLED_IN_SCRATCHPAD_TOOLTIP:E.DISABLED_TOOLTIP_IS_OFFLINE}getActionsMenuItems(t){const{userCanSave:s,userCanSaveAndSync:o}=Object(_.getStore)("OnlineStatusStore"),i=Object(_.getStore)("ActiveWorkspacePermissionStore"),r=i&&i.permissions,l=!e.get(r,f.WORKSPACE_PERMISSIONS.ADD_MOCK_TO_WORKSPACE,!0),a=!e.get(r,f.WORKSPACE_PERMISSIONS.ADD_MONITOR_TO_WORKSPACE,!0),d=!e.get(r,f.WORKSPACE_PERMISSIONS.ADD_COLLECTION_TO_WORKSPACE,!0),c=this.collectionList&&!e.isEmpty(this.collectionList.unsafeEditableCollections),h=e.get(r,f.WORKSPACE_PERMISSIONS.ADD_COLLECTION_TO_WORKSPACE,!0),p=c||h;return n.a.createElement(u.DropdownMenu,{"align-right":!0},n.a.createElement(u.MenuItem,{refKey:y.ACTION_TYPE_SAVE,disabled:!s||!p,disabledText:this.getSaveRequestTooltip(s,p)},n.a.createElement("div",{className:"dropdown-menu-item-label"},"保存请求")),n.a.createElement(u.MenuItem,{refKey:y.ACTION_TYPE_MONITOR,disabled:!o||a,disabledText:s?E.DISABLED_TOOLTIP_WORKSPACE_VIEWER:E.DISABLED_TOOLTIP_IS_OFFLINE},n.a.createElement("div",{className:"dropdown-menu-item-label"},"监视请求")),n.a.createElement(u.MenuItem,{refKey:y.ACTION_TYPE_DOCUMENT,disabled:!o||d,disabledText:this.getDisabledTooltip(s,d)},n.a.createElement("div",{className:"dropdown-menu-item-label"},"请求文档")),n.a.createElement(u.MenuItem,{refKey:y.ACTION_TYPE_MOCK,disabled:!o||l,disabledText:s?E.DISABLED_TOOLTIP_WORKSPACE_VIEWER:E.DISABLED_TOOLTIP_IS_OFFLINE},n.a.createElement("div",{className:"dropdown-menu-item-label"},"模拟请求")),n.a.createElement(u.MenuItem,{refKey:y.ACTION_TYPE_DELETE,disabled:!s||!t,disabledText:this.getDisabledText(!s)},n.a.createElement("div",{className:"dropdown-menu-item-label"},"删除"),n.a.createElement("div",{className:"dropdown-menu-item-shortcut"},Object(A.getShortcutByName)("delete"))))}render(){const e=Object(_.getStore)("PermissionStore").can("delete","history",this.props.id);return n.a.createElement(g.default,{"data-index":this.props.index,text:this.props.url,onClick:this.handleSelect,isSelected:this.props.selected,icon:n.a.createElement(O.default,{method:this.props.method||"GET"}),className:this.getClasses(),moreActions:this.getActionsMenuItems(e),rightMetaComponent:this.getRightAlignedComponents,leftMetaComponent:this.getLeftAlignedComponents,onActionsDropdownSelect:this.handleDropdownActionSelect})}})||o}.call(this,s("./node_modules/lodash/lodash.js"))},"./runtime-repl/history/HistoryListMetaItem.js":function(e,t,s){"use strict";s.r(t),function(e){s.d(t,"default",(function(){return b}));var o=s("../../node_modules/react/index.js"),i=s.n(o),n=s("./node_modules/classnames/index.js"),r=s.n(n),l=s("../../node_modules/@postman/aether/esmLib/index.js"),a=s("./js/components/base/Buttons.js"),d=s("./runtime-repl/history/HistoryActionsConstants.js"),c=s("./runtime-repl/_common/DisabledTooltipConstants.js"),h=s("./js/stores/get-store.js"),p=s("./runtime-repl/history/HistoryActionsTooltipConstants.js"),m=s("./runtime-repl/collection/_api/CollectionStoreV2.js"),u=s("./collaboration/workspace/types/PermissionTypes.ts"),S=s("./runtime-repl/history/HistoryItemActionsDropdown.js");class b extends o.PureComponent{constructor(e){super(e),this.state={dropdownOpen:!1,isHovered:!1},this.store=Object(h.getStore)("HistorySidebarStore"),this.handleToggleGroup=this.handleToggleGroup.bind(this),this.handleDropdownToggle=this.handleDropdownToggle.bind(this),this.handleDropdownActionSelect=this.handleDropdownActionSelect.bind(this),this.handleAddRequestToCollectionClick=this.handleAddRequestToCollectionClick.bind(this),this.handleRemoveRequest=this.handleRemoveRequest.bind(this),this.handleMouseEnter=this.handleMouseEnter.bind(this),this.handleMouseLeave=this.handleMouseLeave.bind(this)}async componentDidMount(){this.collectionList=await m.default.subscribe()}handleMouseEnter(){this.setState({isHovered:!0})}handleMouseLeave(){!this.state.dropdownOpen&&this.setState({isHovered:!1})}getCollapseButtonClasses(){return r()({caret:!0,"pm-icon":!0,"pm-icon-normal":!0,"is-closed":this.store.isItemCollapsed(this.props.name)})}getMetaClasses(){return r()({"history-sidebar-list-item-group__meta":!0,"is-hovered":this.state.dropdownOpen})}handleToggleGroup(){const{name:e}=this.props;if(this.store.isItemCollapsed(e))return this.store.expandItem(e);this.store.collapseItem(e)}handleDropdownToggle(e){e!==this.state.dropdownOpen&&this.setState({dropdownOpen:e})}handleDropdownActionSelect(t){const s={requests:e.reduce(this.props.items,((e,t)=>("request"===t.type&&e.push(t.id),e)),[]),runs:e.reduce(this.props.items,((e,t)=>("collectionrun"===t.type&&e.push(t.id),e)),[]),websockethistory:e.reduce(this.props.items,((e,t)=>("websockethistory"===t.type&&e.push(t.id),e)),[]),proxyhistory:e.reduce(this.props.items,((e,t)=>("proxyhistory"===t.type&&e.push(t.id),e)),[]),defaultCollectionName:this.props.name,from:"history_date_group"};t!==d.ACTION_TYPE_DELETE?this.props.onSelectAction(t,s):pm.mediator.trigger("showDeleteHistoryModal",(()=>{this.props.onSelectAction(t,s)}),{identifier:"selected"})}handleAddRequestToCollectionClick(e){e.stopPropagation(),this.handleDropdownActionSelect(d.ACTION_TYPE_SAVE)}handleRemoveRequest(e){e.stopPropagation(),this.handleDropdownActionSelect(d.ACTION_TYPE_DELETE)}getHistoryDeleteTooltip(e,t){return e?t?p.ACTION_TYPE_DELETE_REQUESTS_TOOLTIP:c.DISABLED_TOOLTIP_NO_PERMISSION:c.DISABLED_TOOLTIP_IS_OFFLINE}getAddRequestTooltip(e,t,s){return e?t?s?"不适用于集合运行项目":p.ACTION_TYPE_SAVE_REQUESTS_TOOLTIP:c.DISABLED_TOOLTIP_NO_PERMISSION:c.DISABLED_TOOLTIP_IS_OFFLINE}render(){const t=e.size(this.store.getSelectedItems())>1,{userCanSave:s}=Object(h.getStore)("OnlineStatusStore"),o=Object(h.getStore)("ActiveWorkspacePermissionStore"),n=o&&o.permissions,r=e.get(n,u.WORKSPACE_PERMISSIONS.REMOVE_HISTORY_FROM_WORKSPACE,!0),d=this.collectionList&&!e.isEmpty(this.collectionList.unsafeEditableCollections),c=e.get(n,u.WORKSPACE_PERMISSIONS.ADD_COLLECTION_TO_WORKSPACE,!0),p=d||c;return i.a.createElement("div",{className:"history-sidebar-list-item-group",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},i.a.createElement("div",{className:this.getMetaClasses(),onClick:this.handleToggleGroup},i.a.createElement("div",{className:"history-sidebar-list-item-group__name"},i.a.createElement(l.Icon,{name:"icon-direction-down",className:this.getCollapseButtonClasses()}),i.a.createElement("span",null,this.props.name)),!t&&this.state.isHovered&&i.a.createElement("div",{className:"history-sidebar-list-item-group__actions"},i.a.createElement(a.Button,{className:"history-sidebar-list-item__button__add",type:"icon",disabled:!s||this.props.disableRequestSpecificActions||!p,onClick:this.handleAddRequestToCollectionClick,tooltip:this.getAddRequestTooltip(s,p,this.props.disableRequestSpecificActions)},i.a.createElement(l.Icon,{name:"icon-action-add-stroke",className:"history-sidebar-list-item__actions__add pm-icon pm-icon-normal"})),i.a.createElement(a.Button,{className:"history-sidebar-list-item__button__delete",type:"icon",onClick:this.handleRemoveRequest,disabled:!s||!r,tooltip:this.getHistoryDeleteTooltip(s,r)},i.a.createElement(l.Icon,{name:"icon-action-delete-stroke",className:"history-sidebar-list-item__actions__delete pm-icon pm-icon-normal"})),i.a.createElement(S.default,{count:e.size(this.props.items),onSelect:this.handleDropdownActionSelect,onToggle:this.handleDropdownToggle,disableRequestSpecificActions:this.props.disableRequestSpecificActions,canAddRequest:this.props.canAddRequest}))))}}}.call(this,s("./node_modules/lodash/lodash.js"))},"./runtime-repl/history/HistorySidebar.js":function(e,t,s){"use strict";s.r(t),function(e){s.d(t,"default",(function(){return S}));var o,i=s("../../node_modules/react/index.js"),n=s.n(i),r=s("../../node_modules/react-dom/index.js"),l=s("./node_modules/pure-render-decorator/index.js"),a=s.n(l),d=s("./js/components/base/keymaps/KeyMaps.js"),c=s("./js/components/base/XPaths/XPath.js"),h=s("./runtime-repl/history/HistoryActionsConstants.js"),p=s("./js/stores/get-store.js"),m=s("./runtime-repl/history/HistorySidebarMenu.js"),u=s("./runtime-repl/history/HistorySidebarList.js");let S=a()(o=class extends i.Component{constructor(e){super(e),this.store=Object(p.getStore)("HistorySidebarStore"),this.historyStore=Object(p.getStore)("HistoryStore"),this.focus=this.focus.bind(this),this.groupItems=this.groupItems.bind(this),this.selectNext=this.selectNext.bind(this),this.selectPrev=this.selectPrev.bind(this),this.deleteItem=this.deleteItem.bind(this),this.selectItem=this.selectItem.bind(this),this.multiselectNextItem=this.multiselectNextItem.bind(this),this.multiselectPrevItem=this.multiselectPrevItem.bind(this)}getKeyMapHandlers(){return{groupItems:pm.shortcuts.handle("groupItems",this.groupItems),nextItem:pm.shortcuts.handle("nextItem",this.selectNext),prevItem:pm.shortcuts.handle("prevItem",this.selectPrev),delete:pm.shortcuts.handle("delete",this.deleteItem),multiselectNextItem:pm.shortcuts.handle("multiselectNextItem",this.multiselectNextItem),multiselectPrevItem:pm.shortcuts.handle("multiselectPrevtItem",this.multiselectPrevItem),select:pm.shortcuts.handle("select",this.selectItem),search:pm.shortcuts.handle("search"),saveCurrentRequest:e=>{e&&e.stopPropagation(),this.props.onSaveCurrentRequest()}}}focus(){const e=Object(r.findDOMNode)(this.refs.history);e&&e.focus()}selectNext(t){t&&t.preventDefault();const s=this.store.getNextItem();s&&e.invoke(this,"props.onSelect",s)}selectPrev(t){t&&t.preventDefault();const s=this.store.getPrevItem();s&&e.invoke(this,"props.onSelect",s)}deleteItem(t){if(document.activeElement.classList.contains("history-sidebar__filter"))return;t&&t.preventDefault();const s=this.store.getPrevItem();e.invoke(this,"props.onDeleteMultiple","selected",s)}selectItem(t){t&&t.preventDefault(),e.invoke(this,"refs.list.selectItem")}multiselectNextItem(t){t&&t.preventDefault();const s=this.store.getNextItem();s&&e.invoke(this,"props.onSelect",s,{metaKey:!0})}multiselectPrevItem(t){t&&t.preventDefault();const s=this.store.getPrevItem();s&&e.invoke(this,"props.onSelect",s,{metaKey:!0})}groupItems(){this.props.onSelectAction&&this.props.onSelectAction("all",h.ACTION_TYPE_SAVE,{requests:this.store.getSelectedItems(),from:"history_multiple"})}render(){return n.a.createElement(d.default,{handlers:this.getKeyMapHandlers(),keyMap:pm.shortcuts.getShortcuts()},n.a.createElement("div",{className:"history-sidebar",ref:"history"},n.a.createElement("div",{className:"history-sidebar-wrapper"},n.a.createElement(m.default,{historySidebar:this.store,historyStore:this.historyStore,enableHistoryResponseSaving:this.props.enableHistoryResponseSaving,isHistorySettingUpdating:this.props.isHistorySettingUpdating,onDeleteMultiple:this.props.onDeleteMultiple,onSelectAction:this.props.onSelectAction.bind(this,"all"),onToggleHistoryResponseSaving:this.props.onToggleHistoryResponseSaving}),n.a.createElement(c.default,{identifier:"history"},n.a.createElement(u.default,{ref:"list",initializing:this.props.initializing,isSocketConnected:this.props.isSocketConnected,isLoggedIn:this.props.isLoggedIn,workspace:this.props.workspace,onDeleteMultiple:this.props.onDeleteMultiple,onLoadMore:this.props.onLoadMore,onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction})))))}})||o}.call(this,s("./node_modules/lodash/lodash.js"))},"./runtime-repl/history/HistorySidebarContainer.js":function(e,t,s){"use strict";s.r(t),function(e){s.d(t,"default",(function(){return C}));var o,i=s("../../node_modules/react/index.js"),n=s.n(i),r=s("./node_modules/@postman/react-click-outside/dist/index.js"),l=s.n(r),a=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),d=s("./js/stores/get-store.js"),c=s("./js/modules/model-event.js"),h=s("./js/modules/pipelines/user-action.js"),p=s("./runtime-repl/history/HistorySidebar.js"),m=s("./runtime-repl/history/HistoryService.js"),u=s("./runtime-repl/history/_api/HistoryInterface.js"),S=s("./js/containers/new-button/CreateNewXService.js"),b=s("./runtime-repl/request-websocket/base/api/WebSocketRequestInterface.js"),g=s("./integrations/proxy/services/ProxyHistoryService.js"),y=s("./collaboration/workspace/types/PermissionTypes.ts"),E=s("./runtime-repl/runner/_api/RunnerInterface.js"),T=s("./runtime-repl/_common/ToastHelpers.js"),_=s("./runtime-repl/_common/WorkspaceHelpers.js"),I=s("./runtime-repl/history/HistoryActionsConstants.js"),O=s("./runtime-repl/_common/components/molecule.js"),A=s("./runtime-repl/runner/RunnerHelper.js");let C=l()(o=Object(a.observer)(o=class extends i.Component{constructor(t){super(t),this.store=Object(d.getStore)("HistorySidebarStore"),this.focus=this.focus.bind(this),this.handleLoadRequestDebounced=e.debounce(this.handleLoadRequest,100,{leading:!0}).bind(this),this.handleLoadCollectionRunDebounced=e.debounce(this.handleLoadCollectionRun,100,{leading:!0}).bind(this),this.handleLoadWebSocketHistoryDebounced=e.debounce(this.handleLoadWebSocketHistory,100,{leading:!0}).bind(this),this.handleActiveRequestChange=this.handleActiveRequestChange.bind(this),this.handleAddToCollection=this.handleAddToCollection.bind(this),this.handleDeleteMultiple=this.handleDeleteMultiple.bind(this),this.handleItemSelect=this.handleItemSelect.bind(this),this.handleSelectAction=this.handleSelectAction.bind(this),this.handleSelectHistoryAction=this.handleSelectHistoryAction.bind(this),this.handleSelectCollectionRunAction=this.handleSelectCollectionRunAction.bind(this),this.handleSelectWebSocketHistoryAction=this.handleSelectWebSocketHistoryAction.bind(this),this.handleproxyHistoryAction=this.handleproxyHistoryAction.bind(this)}UNSAFE_componentWillMount(){pm.mediator.on("activeRequestChanged",this.handleActiveRequestChange)}componentWillUnmount(){pm.mediator.off("activeRequestChanged",this.handleActiveRequestChange)}focus(){e.invoke(this,"refs.history.focus")}selectNext(){e.invoke(this,"refs.history.selectNext")}handleActiveRequestChange(e){this.store.itemExists(e)?this.store.resetSelection([e]):this.store.resetSelection()}handleClickOutside(t){if(!e.isEmpty(this.store.getSelectedItems())){const e=document.getElementsByClassName("ReactModal__Content")[0],s=document.querySelector(".history-sidebar-multiple-request-selected-dropdown");if(e&&e.contains(t.target)||s&&s.contains(t.target))return;this.store.resetSelection()}}handleLoadRequest(e,t=!1){e&&m.default.openHistoryInTab(e,{newTab:t,preview:!0})}handleLoadCollectionRun(e,t=!1){if(!e)return;const{uid:s}=Object(d.getStore)("RunnerRunStore").find(e)||{};Object(E.openRunInTab)(s,{newTab:t,preview:!t})}handleLoadWebSocketHistory(e,t=!1){e&&Object(b.openWebSocketHistoryTab)(e,{forceNew:t,preview:!t})}handleItemSelect({id:t,type:s},o={}){const i=e.includes(navigator.platform,"Mac");o.shiftKey&&(i?o.metaKey:o.ctrlKey)?("collectionrun"===s?this.handleLoadCollectionRunDebounced(t,!0):"websockethistory"===s?this.handleLoadWebSocketHistoryDebounced(t,!0):this.handleLoadRequestDebounced(t,!0),pm.mediator.trigger("focusSidebar")):o.ctrlKey||o.metaKey?this.store.isItemSelected(t)?this.store.unselectItem(t):this.store.selectItem(t):("collectionrun"===s?this.handleLoadCollectionRunDebounced(t,!1):"websockethistory"===s?this.handleLoadWebSocketHistoryDebounced(t,!1):this.handleLoadRequestDebounced(t,!1),pm.mediator.trigger("focusSidebar"),this.store.resetSelection([t]))}handleAddToCollection(t={}){const{requests:s}=t,o=e.isEmpty(s)?this.store.getSelectedItems():s;e.isEmpty(o)||Object(u.convertHistoryToRequests)(o,{populateIfPartial:!0}).then((s=>{1===e.size(s)?s[0]&&pm.mediator.trigger("showAddToCollectionModal",s[0],{from:t.from}):pm.mediator.trigger("addRequestsToCollection",s,t)}))}handleToggleHistoryResponseSaving(){if(!Object(_.isWorkspaceMember)())return Object(_.canJoinWorkspace)()?pm.mediator.trigger("openUnjoinedWorkspaceModal"):Object(_.isLoggedIn)()?pm.toasts.error("您没有执行该操作所需的权限."):pm.mediator.trigger("showSignInModal",{type:"history",origin:"history_save_response"});const e=Object(d.getStore)("HistorySettingsStore"),t={enableHistoryResponseSaving:!(e&&e.enableHistoryResponseSaving)};return e.updateSettings(t)}resetHistorySelection(e){e&&e.id?this.store.resetSelection([e.id]):this.store.resetSelection()}handleDeleteMultiple(t,s){const o=Object(d.getStore)("RunnerRunStore"),i=Object(d.getStore)("ActiveWorkspacePermissionStore"),n=i&&i.permissions,r=e.get(n,y.WORKSPACE_PERMISSIONS.REMOVE_HISTORY_FROM_WORKSPACE,!0);return Object(_.isWorkspaceMember)()?Object(d.getStore)("OnlineStatusStore").userCanSave?Promise.resolve().then((()=>{"all"===t?(Object(h.default)(Object(c.createEvent)("deleteAllInWorkspace","history",Object(d.getStore)("ActiveWorkspaceStore").id)),o.deleteRun(e.map(o.values,(e=>e.id))),Object(b.deleteWebSocketHistory)(),g.default.deleteProxyHistory()):"selected"===t&&(r?Object(h.default)(Object(c.createEvent)("deleteMultiple","history",{ids:this.store.getSelectedItems()},null,null)):pm.toasts.error("您没有权限删除历史."),r?Object(d.getStore)("RunnerRunStore").deleteRun(this.store.getSelectedItems()):pm.toasts.error("您没有权限删除集合运行."),Object(b.deleteWebSocketHistory)(this.store.getSelectedItems()),g.default.deleteProxyHistory(this.store.getSelectedItems()))})).then((()=>{this.resetHistorySelection(s)})).catch((()=>{this.resetHistorySelection(s)})):Object(T.showOfflineActionDisabledToast)():Object(_.canJoinWorkspace)()?pm.mediator.trigger("openUnjoinedWorkspaceModal"):Object(_.isLoggedIn)()?pm.toasts.error("您没有执行该操作所需的权限."):pm.mediator.trigger("showSignInModal",{type:"history",origin:"history_delete_multiple"})}handleAddRequestToService(t,s){const{requests:o,defaultCollectionName:i="",from:n=""}=t,r=e.isEmpty(o)?this.store.getSelectedItems():o;e.isEmpty(r)||Object(u.convertHistoryToRequests)(r).then((t=>{if(!e.isEmpty(t)){const e={name:i,from:n};S.default.create(s,{requests:t,opts:e},null,{from:"history_sidebar"})}}))}handleSelectHistoryAction(e,t){switch(e){case I.ACTION_TYPE_SAVE:if(!Object(d.getStore)("OnlineStatusStore").userCanSave)return Object(T.showOfflineActionDisabledToast)();this.handleAddToCollection(t);break;case I.ACTION_TYPE_MONITOR:this.handleAddRequestToService(t,"openCreateNewMonitorModal");break;case I.ACTION_TYPE_DOCUMENT:this.handleAddRequestToService(t,"openCreateNewDocumentationModal");break;case I.ACTION_TYPE_MOCK:this.handleAddRequestToService(t,"openCreateNewMockModal");break;case I.ACTION_TYPE_DELETE:if(!Object(d.getStore)("OnlineStatusStore").userCanSave)return Object(T.showOfflineActionDisabledToast)();Object(h.default)(Object(c.createEvent)("deleteMultiple","history",{ids:t.requests},null,null))}}handleSelectCollectionRunAction(e,t){switch(e){case I.ACTION_TYPE_DELETE:if(!Object(d.getStore)("OnlineStatusStore").userCanSave)return Object(T.showOfflineActionDisabledToast)();Object(d.getStore)("RunnerRunStore").deleteRun(t.runs);break;case I.ACTION_TYPE_DOWNLOAD:return Object(A.exportRuns)(t.runs);default:pm.logger.warn(`HistorySidebarContainer~handleSelectCollectionRunAction: ${e} - action not handled`)}}handleSelectWebSocketHistoryAction(e,t){if(e===I.ACTION_TYPE_DELETE){if(!Object(d.getStore)("OnlineStatusStore").userCanSave)return Object(T.showOfflineActionDisabledToast)();Object(b.deleteWebSocketHistory)(t.websockethistory)}}async handleproxyHistoryAction(e,t){if(e===I.ACTION_TYPE_DELETE)try{await g.default.deleteProxyHistory(t.proxyhistory)}catch(e){pm.toasts.error("The proxy session is in progress")}}handleSelectAction(t,s,o){return Object(_.isWorkspaceMember)()?"collectionrun"===t?(1===e.size(o.runs)&&s===I.ACTION_TYPE_DELETE&&this.store.unselectItem(o.runs[0]),o.runs&&this.handleSelectCollectionRunAction(s,o)):"websockethistory"===t?(1===e.size(o.websockethistory)&&s===I.ACTION_TYPE_DELETE&&this.store.unselectItem(o.websockethistory[0]),o.websockethistory&&this.handleSelectWebSocketHistoryAction(s,o)):"request"===t?(1===e.size(o.requests)&&s===I.ACTION_TYPE_DELETE&&this.store.unselectItem(o.requests[0]),this.handleSelectHistoryAction(s,o)):"proxyhistory"===t?(1===e.size(o.proxyhistory)&&s===I.ACTION_TYPE_DELETE&&this.store.unselectItem(o.proxyhistory[0]),o.proxyhistory&&this.handleproxyHistoryAction(s,o)):void("all"===t&&(o.runs&&this.handleSelectCollectionRunAction(s,o),o.requests&&this.handleSelectHistoryAction(s,o),o.websockethistory&&this.handleSelectWebSocketHistoryAction(s,o),o.proxyhistory&&this.handleproxyHistoryAction(s,o))):Object(_.canJoinWorkspace)()?pm.mediator.trigger("openUnjoinedWorkspaceModal"):Object(_.isLoggedIn)()?pm.toasts.error("您没有执行该操作所需的权限."):pm.mediator.trigger("showSignInModal",{type:"history",origin:`history_${s}`})}render(){const{isConsistentlyOffline:e}=Object(d.getStore)("SyncStatusStore");if(e&&this.store.loading)return n.a.createElement(O.SidebarOfflineState,null);const t=Object(d.getStore)("HistorySettingsStore"),s=Object(d.getStore)("SyncStatusStore"),o=Object(d.getStore)("CurrentUserStore"),i=Object(d.getStore)("HistoryStore"),r=Object(d.getStore)("ActiveWorkspaceStore"),l=t&&t.enableHistoryResponseSaving,a=t&&t.isUpdating;return n.a.createElement(p.default,{store:this.store,enableHistoryResponseSaving:l,isHistorySettingUpdating:a,initializing:o.isHydrating||i.isHydrating||!r.id,isLoggedIn:o.isLoggedIn,isSocketConnected:s.isSocketConnected,workspace:r.id,onSelectAction:this.handleSelectAction,onDeleteMultiple:this.handleDeleteMultiple,onSelect:this.handleItemSelect,onSaveCurrentRequest:this.handleAddToCollection,onToggleHistoryResponseSaving:this.handleToggleHistoryResponseSaving,ref:"history"})}})||o)||o}.call(this,s("./node_modules/lodash/lodash.js"))},"./runtime-repl/history/HistorySidebarErrorState.js":function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return r}));var o=s("../../node_modules/react/index.js"),i=s.n(o),n=s("./js/components/base/Buttons.js");function r(e){return i.a.createElement("div",{className:"history-sidebar-list-error"},i.a.createElement("h4",null,"无法加载历史"),i.a.createElement("p",null,"尝试加载历史项目时出了点问题. 检查您的互联网,然后重试."),i.a.createElement(n.Button,{type:"secondary",onClick:e.onRetry},"重试"))}},"./runtime-repl/history/HistorySidebarList.js":function(e,t,s){"use strict";s.r(t),function(e){s.d(t,"default",(function(){return A}));var o,i=s("../../node_modules/react/index.js"),n=s.n(i),r=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),l=s("./node_modules/react-window/dist/index.esm.js"),a=s("./node_modules/react-virtualized-auto-sizer/dist/index.esm.js"),d=s("../../node_modules/@postman/aether/esmLib/index.js"),c=s("./js/components/base/Buttons.js"),h=s("./js/utils/PluralizeHelper.js"),p=s("./runtime-repl/request-websocket/history/sidebar/components/WebSocketHistorySidebarListItem.js"),m=s("./js/stores/get-store.js"),u=s("./runtime-repl/history/HistorySidebarListEmptyItem.js"),S=s("./appsdk/sidebar/SidebarEmptyState/SidebarEmptyState.js"),b=s("./runtime-repl/history/HistoryListItem.js"),g=s("./runtime-repl/history/HistoryListMetaItem.js"),y=s("./runtime-repl/history/HistoryListErrorItem.js"),E=s("./runtime-repl/history/HistoryListCollectionRunItem.js"),T=s("./runtime-repl/history/HistorySidebarErrorState.js"),_=s("./appsdk/sidebar/SidebarLoadingState/SidebarLoadingState.js"),I=s("./integrations/proxy/components/ProxyHistorySidebarListItem.js");function O(){return O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},O.apply(this,arguments)}let A=Object(r.observer)(o=class extends i.Component{constructor(t){super(t),this.store=Object(m.getStore)("HistorySidebarStore"),this.requesterSidebarStore=Object(m.getStore)("RequesterSidebarStore"),this.handleToggleGroup=this.handleToggleGroup.bind(this),this.getListItem=this.getListItem.bind(this),this.getItemSize=this.getItemSize.bind(this),this.handleClearCachedHeight=this.handleClearCachedHeight.bind(this),this.observeSizeChange=this.observeSizeChange.bind(this),this.unobserveSizeChange=this.unobserveSizeChange.bind(this),this.handleItemsRender=this.handleItemsRender.bind(this),this.handleItemsRenderDebounced=e.debounce(this.handleItemsRender,1e3),this.handleListScroll=this.handleListScroll.bind(this),this.handleListScrollDebounced=e.debounce(this.handleListScroll,300),this.handleJumpToTop=this.handleJumpToTop.bind(this),this.handleRefresh=this.handleRefresh.bind(this),this.heightSet={},this.resizeObserver=new ResizeObserver((e=>{for(const t of e){if(!(t&&t.target&&t.target.dataset))return;const{index:e}=t.target.dataset;this.heightSet[e]=t.target.offsetHeight}this.handleClearCachedHeight(0)}))}componentDidMount(){this.props.initializing||this.store.load()}componentDidUpdate(e){this.props.initializing||(e.initializing?this.store.load():(this.props.workspace!==e.workspace||this.props.isLoggedIn&&!e.isLoggedIn)&&(this.store.load(),this.listRef&&this.listRef.scrollTo(0),this.store.setScrollOffset(0)))}observeSizeChange(e){this.resizeObserver&&this.resizeObserver.observe(e)}unobserveSizeChange(e,t){this.resizeObserver&&this.resizeObserver.unobserve(e),delete this.heightSet[t]}handleClearCachedHeight(e){this.listRef.resetAfterIndex(e)}handleToggleGroup(e){if(this.store.isItemCollapsed(e))return this.store.expandItem(e);this.store.collapseItem(e)}getItemSize(t){const s=e.get(this.store,["historyItems",t]);return"meta"===s.type||"error"===s.type?28:this.heightSet[t]||28}getListItem(t){const s=e.get(this.store,["historyItems",t.index]);return s?"error"===s.type?n.a.createElement("div",{className:"history-list__error",style:t.style},n.a.createElement(y.default,{key:s.name,onRetry:()=>"load-error"===s.key?this.store.load(!0):"load-more-error"===s.key?this.store.loadMore():void 0})):"meta"===s.type?n.a.createElement("div",{className:"history-list__meta",style:t.style},n.a.createElement(g.default,{name:s.name,key:s.name,onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction.bind(this,"all"),items:s.items,disableRequestSpecificActions:s.disableRequestSpecificActions})):"collectionrun"===s.type?n.a.createElement("div",{className:"history-list__collection-run",style:t.style},n.a.createElement(E.default,O({},s,{name:s.name,hideActions:e.size(this.store.getSelectedItems())>1,key:s.id,selected:this.store.isItemSelected(s.id),onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction.bind(this,"collectionrun"),observeSizeChange:this.observeSizeChange,unobserveSizeChange:this.unobserveSizeChange,index:t.index}))):"websockethistory"===s.type?n.a.createElement("div",{className:"history-list__websocket",style:t.style},n.a.createElement(p.default,O({},s,{key:s.id,isSelected:this.store.isItemSelected(s.id),onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction.bind(this,"websockethistory"),observeSizeChange:this.observeSizeChange,unobserveSizeChange:this.unobserveSizeChange,index:t.index}))):"proxyhistory"===s.type?n.a.createElement("div",{className:"history-list__proxy",style:t.style},n.a.createElement(I.default,O({},s,{key:s.id,isSelected:this.store.isItemSelected(s.id),onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction.bind(this,"proxyhistory"),observeSizeChange:this.observeSizeChange,unobserveSizeChange:this.unobserveSizeChange,index:t.index}))):n.a.createElement("div",{className:"history-list__item",style:t.style},n.a.createElement(b.default,O({},s,{hideActions:e.size(this.store.getSelectedItems())>1,key:s.id,selected:this.store.isItemSelected(s.id),onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction.bind(this,"request"),observeSizeChange:this.observeSizeChange,unobserveSizeChange:this.unobserveSizeChange,viewLargeBody:this.props.viewLargeBody,index:t.index}))):null}getNotification(){return this.store.showReloadNotification?n.a.createElement("div",{className:"history-sidebar-list__notification"},n.a.createElement(c.Button,{type:"primary",size:"small",className:"history-sidebar-list__refresh",onClick:this.handleRefresh},n.a.createElement(d.Icon,{name:"icon-action-refresh-stroke",color:"content-color-primary",size:"small",className:"pm-icon"}),"刷新")):this.store.newHistoryIds.size?n.a.createElement("div",{className:"history-sidebar-list__notification"},n.a.createElement(c.Button,{type:"primary",size:"small",className:"history-sidebar-list__more-on-top",onClick:this.handleJumpToTop},n.a.createElement(d.Icon,{name:"icon-direction-up",color:"content-color-primary",size:"small",className:"pm-icon"}),n.a.createElement("span",null,this.store.newHistoryIds.size," ","new"," ",h.default.pluralize({count:this.store.newHistoryIds.size,singular:"item",plural:"items"})))):null}handleListScroll({scrollOffset:e}){0===e&&this.store.newHistoryIds.size&&this.store.showNewHistory(),this.store.setScrollOffset(e)}handleItemsRender(e){this.store.scrolledToEnd||this.store.loadingMore||this.requesterSidebarStore.query||e.overscanStopIndex===e.visibleStopIndex&&this.store.loadMore()}handleJumpToTop(){this.listRef&&this.listRef.scrollTo(0)}handleRefresh(){this.listRef&&this.listRef.scrollTo(0),this.store.load(!0)}render(){const t=e=>n.a.createElement(r.Observer,null,this.getListItem.bind(this,e)),s=({height:e,width:s})=>n.a.createElement(r.Observer,null,(()=>n.a.createElement(l.VariableSizeList,{height:e,itemCount:this.store.historyItems.length,itemSize:this.getItemSize,width:s,ref:e=>{this.listRef=e},overscanCount:10,onItemsRendered:this.handleItemsRenderDebounced,onScroll:this.handleListScrollDebounced},t)));return e.isEmpty(this.store.historyItems)?this.props.initializing||this.store.loading?n.a.createElement("div",{className:"history-sidebar-list"},n.a.createElement(_.default,{hasHierarchy:!0})):this.store.loadError?"您没有权限查看历史在这个工作区"===this.store.loadError.message?n.a.createElement("div",{className:"history-sidebar-list-permission-error"},n.a.createElement(S.default,{illustration:n.a.createElement(d.IllustrationNoPermission,null),title:"您没有权限查看历史",message:"只有团队成员才能查看此工作区的历史"})):n.a.createElement("div",{className:"history-sidebar-list"},n.a.createElement(T.default,{onRetry:()=>this.store.load(!0)})):n.a.createElement("div",{className:"history-sidebar-list"},n.a.createElement(u.default,{query:this.store.searchQuery})):n.a.createElement("div",{className:"history-sidebar-list",ref:"history"},this.getNotification(),n.a.createElement(a.default,null,s))}})||o}.call(this,s("./node_modules/lodash/lodash.js"))},"./runtime-repl/history/HistorySidebarListEmptyItem.js":function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return p}));var o,i=s("../../node_modules/react/index.js"),n=s.n(i),r=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),l=s("../../node_modules/@postman/aether/esmLib/index.js"),a=s("./js/constants/AppUrlConstants.js"),d=s("./js/external-navigation/ExternalNavigationService.js"),c=s("./appsdk/sidebar/SidebarEmptyState/SidebarEmptyState.js"),h=s("./appsdk/sidebar/SidebarNoResultsFound/SidebarNoResultsFound.js");let p=Object(r.observer)(o=class extends i.Component{constructor(e){super(e),this.handleShowMeHow=this.handleShowMeHow.bind(this)}handleShowMeHow(){Object(d.openExternalLink)(a.SEND_FIRST_REQUEST_DOCS,"_blank")}render(){return this.props.query?n.a.createElement(h.default,{searchQuery:this.props.query,illustration:n.a.createElement(l.IllustrationNoHistory,null)}):n.a.createElement(c.default,{illustration:n.a.createElement(l.IllustrationNoHistory,null),title:"您尚未发送任何请求.",message:"您在此工作区中发送的任何请求都将显示在此处.",action:{label:"告诉我怎么做",handler:this.handleShowMeHow}})}})||o},"./runtime-repl/history/HistorySidebarMenu.js":function(e,t,s){"use strict";s.r(t),function(e){s.d(t,"default",(function(){return O}));var o,i=s("../../node_modules/react/index.js"),n=s.n(i),r=s("./node_modules/classnames/index.js"),l=s.n(r),a=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),d=s("../../node_modules/@postman/aether/esmLib/index.js"),c=s("./js/components/base/Buttons.js"),h=s("./js/components/base/ToggleSwitch.js"),p=s("./js/components/base/Dropdowns.js"),m=s("./js/components/base/Tooltips.js"),u=s("./runtime-repl/_common/ToastHelpers.js"),S=s("./runtime-repl/history/HistoryActionsConstants.js"),b=s("./runtime-repl/runner/RunnerHelper.js"),g=s("./js/stores/get-store.js"),y=s("./js/containers/apps/requester/sidebar/SidebarListActions.js"),E=s("./runtime-repl/_common/DisabledTooltipConstants.js"),T=s("./collaboration/workspace/types/PermissionTypes.ts"),_=s("./runtime-repl/history/HistoryActionsTooltipConstants.js"),I=s("./runtime-repl/history/HistoryItemActionsDropdown.js");let O=Object(a.observer)(o=class extends i.Component{constructor(e){super(e),this.state={dropdownOpen:!1,showResponseToggleTooltip:!1},this.handleDeleteClick=this.handleDeleteClick.bind(this),this.handleDropdownToggle=this.handleDropdownToggle.bind(this),this.handleDropdownActionSelect=this.handleDropdownActionSelect.bind(this),this.handleAddToCollectionClick=this.handleAddToCollectionClick.bind(this),this.handleDeleteSelected=this.handleDeleteSelected.bind(this),this.handleSearchChange=this.handleSearchChange.bind(this),this.handleActionsDropdownSelect=this.handleActionsDropdownSelect.bind(this),this.handleSaveResponseToggle=this.handleSaveResponseToggle.bind(this),this.showResponseToggleTooltip=this.showResponseToggleTooltip.bind(this),this.hideResponseToggleTooltip=this.hideResponseToggleTooltip.bind(this),this.disableRequestItemOptions=this.disableRequestItemOptions.bind(this)}handleAddToCollectionClick(e){e.stopPropagation(),this.props.onSelectAction(S.ACTION_TYPE_SAVE,{requests:this.props.historySidebar.getSelectedItems(),from:"history_multiple"})}handleDeleteClick(){pm.mediator.trigger("showDeleteHistoryModal",(async()=>{try{this.props.onDeleteMultiple&&await this.props.onDeleteMultiple("all")}catch(e){pm.logger.error("无法删除历史",e),pm.toasts.error("无法删除历史")}}),{identifier:"all"})}handleDropdownToggle(e){e!==this.state.dropdownOpen&&this.setState({dropdownOpen:e})}handleDropdownActionSelect(e){return e===S.ACTION_TYPE_DELETE?Object(g.getStore)("OnlineStatusStore").userCanSave?void pm.mediator.trigger("showDeleteHistoryModal",(()=>{this.props.onDeleteMultiple("selected")}),{identifier:"selected"}):Object(u.showOfflineActionDisabledToast)():e===S.ACTION_TYPE_DOWNLOAD?Object(b.exportRuns)(this.props.historySidebar.getSelectedItems()):void this.props.onSelectAction(e,{requests:this.props.historySidebar.getSelectedItems(),from:"history_multiple"})}handleActionsDropdownSelect(e){if("history-sidebar--clear-all"===e)this.handleDeleteClick()}handleDeleteSelected(){this.handleDropdownActionSelect(S.ACTION_TYPE_DELETE)}disableRequestItemOptions(){const t=e.filter(this.props.historySidebar.historyItems,(e=>this.props.historySidebar.selectedItems.has(e.id)&&"request"===e.type));return e.isEmpty(t)}showResponseToggleTooltip(){this.setState({showResponseToggleTooltip:!0})}hideResponseToggleTooltip(){this.setState({showResponseToggleTooltip:!1})}handleSaveResponseToggle(e){e&&e.stopPropagation(),this.props.onToggleHistoryResponseSaving&&this.props.onToggleHistoryResponseSaving()}handleSearchChange(e){this.props.historySidebar.setSearchQuery(e)}getToggleSaveResponseClasses(e){return l()({"dropdown-menu-item history-sidebar-menu__actions-save-response-toggle":!0,"is-disabled":e})}getDeleteHistoryTooltip(e,t){return e?t?_.ACTION_TYPE_DELETE_REQUESTS_TOOLTIP:E.DISABLED_TOOLTIP_NO_PERMISSION:E.DISABLED_TOOLTIP_IS_OFFLINE}render(){const t=this.props.historySidebar.selectedItems.size,{userCanSave:s}=Object(g.getStore)("OnlineStatusStore"),o=Object(g.getStore)("ActiveWorkspacePermissionStore"),i=o&&o.permissions,r=e.get(i,T.WORKSPACE_PERMISSIONS.REMOVE_HISTORY_FROM_WORKSPACE,!0),l=!s||!r,a=!e.get(i,T.WORKSPACE_PERMISSIONS.UPDATE_WORKSPACE_META,!0);return t>1?n.a.createElement("div",{className:"history-sidebar-menu multiple-request-selected"},n.a.createElement("div",{className:"history-sidebar-menu__left"},n.a.createElement(d.Text,{type:"body-small",color:"content-color-primary"},t," ","项已选择")),n.a.createElement("div",{className:"history-sidebar-menu__right"},n.a.createElement("div",{className:"history-sidebar-menu__actions-delete-history-wrapper"},n.a.createElement(c.Button,{disabled:!s||!r,className:"history-sidebar-list-item__button__delete",type:"icon",onClick:this.handleDeleteSelected,tooltip:this.getDeleteHistoryTooltip(s,r)},n.a.createElement(d.Icon,{name:"icon-action-delete-stroke",size:"large",className:"history-sidebar-list-item__actions__delete pm-icon pm-icon-normal"})),n.a.createElement(I.default,{count:t,onSelect:this.handleDropdownActionSelect,onToggle:this.handleDropdownToggle,disableRequestSpecificActions:this.disableRequestItemOptions()})))):n.a.createElement("div",{className:"history-sidebar-menu"},n.a.createElement(y.default,{className:"history-sidebar__filter",onSearch:this.handleSearchChange,onActionsDropdownSelect:this.handleActionsDropdownSelect,searchQuery:this.props.historySidebar.searchQuery,moreActions:n.a.createElement(p.DropdownMenu,{className:"history-sidebar__header-actions-dropdown--menu"},!e.isEmpty(this.props.historySidebar.historyItems)&&n.a.createElement(p.MenuItem,{className:"history-sidebar__header-actions-dropdown--menu-item history-sidebar-menu__actions-delete-history-wrapper",key:"history-sidebar--clear-all",refKey:"history-sidebar--clear-all",disabled:l,disabledText:s?E.DISABLED_TOOLTIP_NO_PERMISSION:"你需要联网才能清除历史."},n.a.createElement("span",null,"全部清除")),n.a.createElement("div",{className:this.getToggleSaveResponseClasses(a||this.props.isHistorySettingUpdating),onClick:a?void 0:this.handleSaveResponseToggle,ref:e=>{this.saveResponseToggleContainerRef=e},onMouseEnter:this.showResponseToggleTooltip,onMouseLeave:this.hideResponseToggleTooltip},this.props.isHistorySettingUpdating?this.props.enableHistoryResponseSaving?"Disabling...":"Enabling...":"保存响应",n.a.createElement(h.default,{isActive:this.props.enableHistoryResponseSaving,activeLabel:"",inactiveLabel:"",disabled:a||this.props.isHistorySettingUpdating}),n.a.createElement(m.Tooltip,{className:"history-sidebar-menu--save-response__tooltip",show:this.state.showResponseToggleTooltip,target:this.saveResponseToggleContainerRef},n.a.createElement(m.TooltipBody,null,a?"您没有权限来执行此操作.":"关闭时, 不会保存响应标头和正文, 但会保存响应代码、时间、大小和语言将被保存以用于报告."))))}))}})||o}.call(this,s("./node_modules/lodash/lodash.js"))},"./runtime-repl/request-websocket/base/api/WebSocketRequestInterface.js":function(e,t,s){"use strict";s.r(t),function(e){s.d(t,"openWebSocketHistoryTab",(function(){return l})),s.d(t,"deleteWebSocketHistory",(function(){return a}));var o=s("./js/services/NavigationService.js"),i=s("./js/stores/get-store.js"),n=s("./runtime-repl/_common/NavigationConstants.js"),r=s("./runtime-repl/request-websocket/history/services/WebSocketHistoryService.js");function l(e,t={preview:!0}){return o.default.transitionTo(n.WORKFLOW_IDENTIFIER.OPEN_WEBSOCKET_HISTORY,{whid:e},{},{tabOptions:{preview:t.preview,forceNew:t.forceNew}})}function a(t){e.isString(t)&&(t=[t]),e.isArray(t)||void 0===t?(Object(i.getStore)("WebSocketHistoryStore").remove(t),r.default.deleteHistory(Object(i.getStore)("ActiveWorkspaceStore").id,t).catch((e=>{pm.logger.error("WebSocketRequestInterface~deleteHistory: Error in deleting websocket history",e)}))):pm.logger.warn("WebSocketRequestInterface~deleteWebSocketHistory: Invalid input.")}}.call(this,s("./node_modules/lodash/lodash.js"))},"./runtime-repl/request-websocket/history/sidebar/components/WebSocketHistorySidebarListItem.js":function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return E}));var o,i=s("../../node_modules/react/index.js"),n=s.n(i),r=s("../../node_modules/react-dom/index.js"),l=s("./node_modules/moment/moment.js"),a=s.n(l),d=s("./node_modules/classnames/index.js"),c=s.n(d),h=s("../../node_modules/@postman/aether/esmLib/index.js"),p=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),m=s("./js/components/base/Avatar.js"),u=s("./js/components/base/Tooltips.js"),S=s("./js/containers/apps/requester/sidebar/SidebarListItem.js"),b=s("./js/stores/get-store.js"),g=s("./runtime-repl/history/HistoryActionsConstants.js"),y=s("./runtime-repl/_common/DisabledTooltipConstants.js");let E=Object(p.observer)(o=class extends i.Component{constructor(e){super(e),this.state={isTooltipVisible:!1},this.userAvatar=n.a.createRef(),this.handleSelect=this.handleSelect.bind(this),this.handleAction=this.handleAction.bind(this),this.handleDelete=this.handleDelete.bind(this),this.showTooltip=this.showTooltip.bind(this),this.hideTooltip=this.hideTooltip.bind(this),this.getLeftAlignedComponents=this.getLeftAlignedComponents.bind(this),this.getRightAlignedComponents=this.getRightAlignedComponents.bind(this)}componentDidMount(){this.selfNode=Object(r.findDOMNode)(this),this.props.observeSizeChange&&this.props.observeSizeChange(this.selfNode)}componentWillUpdate(e){if(!this.props.selected&&e.selected){const e=Object(r.findDOMNode)(this);e&&e.scrollIntoViewIfNeeded&&e.scrollIntoViewIfNeeded()}}componentWillUnmount(){this.props.unobserveSizeChange&&this.props.unobserveSizeChange(this.selfNode,this.props.index)}getClasses(){return c()({"history-sidebar-list-item":!0,"history-sidebar-list-item__websocket-history":!0,"is-selected":this.props.selected})}getTooltipText(e,t){return e?t?y.DISABLED_TOOLTIP_IS_OFFLINE:y.DISABLED_TOOLTIP_NO_PERMISSION:"删除历史"}getLeftAlignedComponents(e){if(!e)return n.a.createElement("div",{className:"history-sidebar__indent"});const t=c()({"history-sidebar-list-item-updatedBy":!0,hovered:e}),s=Object(b.getStore)("CurrentUserStore").teamMembers.get(String(this.props.owner)),o=s&&(s.name||s.username);return n.a.createElement("div",{className:t,onMouseOver:this.showTooltip,onMouseLeave:this.hideTooltip},this.props.owner&&"0"!==this.props.owner?n.a.createElement(m.default,{ref:this.userAvatar,size:"small",userId:this.props.owner}):n.a.createElement(h.Icon,{name:"icon-descriptive-user-stroke",color:"content-color-secondary"}),this.userAvatar.current&&n.a.createElement(u.Tooltip,{immediate:!0,show:this.state.isTooltipVisible,target:this.userAvatar.current,placement:"right"},n.a.createElement(u.TooltipBody,null,n.a.createElement("div",{className:"history-sidebar-list-item-avatar-tooltip"},n.a.createElement(h.Text,{type:"body-medium"},o),n.a.createElement(h.Text,{type:"body-medium"},a()(this.props.createdAt).format("DD MMM YYYY, h:mm A"))))))}getRightAlignedComponents(e){const t=c()({"sidebar-list-item__right-section-actions":!0,hovered:e});if(!e)return null;const s=Object(b.getStore)("PermissionStore"),{userCanSave:o}=Object(b.getStore)("OnlineStatusStore"),i=o&&s.can("delete","history");return n.a.createElement("div",{className:t},n.a.createElement(h.Button,{type:"tertiary",icon:"icon-action-delete-stroke",onClick:this.handleDelete,isDisabled:!i,tooltip:this.getTooltipText(!i,!o)}))}showTooltip(){this.setState({isTooltipVisible:!0})}hideTooltip(){this.setState({isTooltipVisible:!1})}handleSelect(e){e.stopPropagation();const t={ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};this.props.onSelect&&this.props.onSelect({id:this.props.id,type:"websockethistory"},t)}handleAction(e){this.props.onSelectAction(e,{websockethistory:[this.props.id]})}handleDelete(e){e.stopPropagation(),this.handleAction(g.ACTION_TYPE_DELETE)}render(){return n.a.createElement("div",{"data-index":this.props.index},n.a.createElement(S.default,{text:this.props.url,icon:"icon-entity-websocket-stroke",isSelected:this.props.isSelected,onClick:this.handleSelect,className:this.getClasses(),leftMetaComponent:this.getLeftAlignedComponents,rightMetaComponent:this.getRightAlignedComponents}))}})||o}}]);