(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{14628:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"default",(function(){return m}));var a,i=n(2),s=n.n(i),o=n(2353),r=n(1656),l=n(2372),c=n(1874),p=n(14629),d=n(14631),g=n(5463),h=n(3136),u=n(1662);let m=Object(o.observer)(a=class extends s.a.Component{constructor(t){super(t),this.state={activeLanguage:{language:"curl",variant:"cURL"},optionsArray:[],optionsPreference:{},codeSnippet:"",originalSnippetHash:"",codeCopied:!1,selectedLanguage:{}},this.handleCodeTypeSelect=this.handleCodeTypeSelect.bind(this),this.handleSnippetChange=this.handleSnippetChange.bind(this),this.handleCopyCode=this.handleCopyCode.bind(this),this.store=Object(u.getStore)("CodegenStore"),this.throttledGenerateSnippet=e.throttle(this.handleCodeTypeSelect.bind(this),500,{leading:!0,trailing:!0})}componentDidMount(){var t={id:this.store.languagePreference},{language:n,variant:a}=e.isObject(t.id)?t:JSON.parse(t.id);this.disposePreviewReaction=Object(r.reaction)((()=>{let e=Object(u.getStore)("EditorStore").find(this.props.contextData.editorId),t=e&&e.model;return t&&t.viewState&&Object(r.toJS)(t.viewState.previewRequest)}),(()=>{this.throttledGenerateSnippet(this.state.selectedLanguage)})),this.handleCodeTypeSelect(t),c.default.addEventV2({category:"codegen",action:"open_codegen_contextbar",label:`${n}_${a}`})}componentWillUnmount(){this.disposePreviewReaction&&this.disposePreviewReaction()}componentDidUpdate(t){const{id:n}=t.contextData||{};n!==e.get(this.props.contextData,"id")&&this.handleCodeTypeSelect(this.state.selectedLanguage)}hash(e){return n(1170).createHash("sha1").update(e).digest("base64")}handleCodeTypeSelect(t){e.isEmpty(t)||this.setState({selectedLanguage:t});let n,a=e.isEmpty(t)?this.store.languagePreference:JSON.parse(t.id),{language:i,variant:s}=a,o={};this.setState({activeLanguage:{language:i,variant:s}}),g.default.getOptions(i,s).then((e=>{e&&e.length&&(this.setState({optionsArray:e}),e.forEach((e=>{o[e.id]=e.default})))})).catch((e=>{this.setState({optionsArray:[]}),pm.logger.error(`CodeCBView~handleCodeTypeSelect - ${e}`)})).then((()=>{n=this.store.getSnippetOptionForLanguage(i,s)||o,this.setState({optionsPreference:n})})).then((()=>{let e=this.props.contextData&&this.props.contextData.type;g.default.getSnippet(this.props.contextData.editorId,{language:i,variant:s,optionsPreference:n},e).then((e=>{if(!e)return;let t=this.hash(e.snippet);t!==this.state.originalSnippetHash&&this.setState({codeSnippet:e.snippet,originalSnippetHash:t},(()=>{let e=JSON.stringify({language:i,variant:s});this.store.updateLanguagePreference(e)}))}))}))}handleSnippetChange(e){this.setState({codeSnippet:e})}handleCopyCode(){h.default.copy(this.state.codeSnippet),this.setState({codeCopied:!0}),clearTimeout(this.timeout),this.timeout=setTimeout((()=>{this.setState({codeCopied:!1})}),1500)}render(){let t,n=e.get(this.state.activeLanguage,"language","curl"),{controller:a={}}=this.props||{},i=e.get(this.state.activeLanguage,"variant","cURL"),o=a.labelEditorMap&&a.labelEditorMap[`${n}_${i}`]?a.labelEditorMap[`${n}_${i}`].editorMode:"powershell",r={indentationType:this.state.optionsPreference.indentType?e.toLower(this.state.optionsPreference.indentType):null,indentationSize:this.state.optionsPreference.indentCount||null},c=this.store.getSnippetOptions();return a.editor&&(t=a.editor.isDirty),"dart"===o&&(o="powershell"),s.a.createElement("div",{className:"context-bar-code-snippet-view"},s.a.createElement(l.ContextBarViewHeader,{title:"代码片段",onClose:this.props.onClose}),s.a.createElement("div",{className:"context-bar-code-snippet-body"},s.a.createElement(p.default,{codeCopied:this.state.codeCopied,languageList:a.languageList,onSelectLanguage:this.handleCodeTypeSelect,selectedLanguage:this.state.selectedLanguage,handleCopyCode:this.handleCopyCode,snippetOptions:c,isDirty:t}),s.a.createElement(d.default,{indentation:r,codeSnippet:this.state.codeSnippet,editorMode:o,handleSnippetChange:this.handleSnippetChange})))}})||a}.call(this,n(574))},14629:function(e,t,n){"use strict";n.r(t),function(e){var a=n(2),i=n.n(a),s=n(9),o=n(14630),r=n(2373),l=n(3112);class c extends i.a.Component{constructor(e){super(e),this.openLanguageSettingsModal=()=>{l.ModalViewManager.onMount((()=>{pm.mediator.trigger("openLanguageSettingsModel",this.props.selectedLanguage)}))},this.openLanguageSettingsModal=this.openLanguageSettingsModal.bind(this)}componentDidUpdate(t){let n=this.props.snippetOptions,a=t.snippetOptions,i=JSON.parse(this.props.selectedLanguage.id),s=e.get(i,"language","curl"),o=e.get(i,"variant","cURL");(JSON.stringify(a[`${s}_${o}`])!==JSON.stringify(n[`${s}_${o}`])||!this.props.isDirty&&t.isDirty)&&this.props.onSelectLanguage(this.props.selectedLanguage)}render(){return i.a.createElement("div",{className:"context-bar-codegen-controls"},i.a.createElement("div",{className:"context-bar-codegen-controls-left"},i.a.createElement("div",{className:"context-bar-codegen-controls-left__dropdown"},i.a.createElement(o.default,{selectedTarget:this.props.selectedLanguage,onTargetSelect:this.props.onSelectLanguage,menuClassName:"context-bar-codegen-dropdown",filterItems:this.props.languageList})),i.a.createElement("div",{className:"context-bar-codegen-controls-left__setting"},i.a.createElement(r.Button,{type:"tertiary",onClick:this.openLanguageSettingsModal},i.a.createElement(s.Icon,{name:"icon-descriptive-setting-stroke",className:"language-settings-icon",tooltip:"代码设置"})))),i.a.createElement("div",{className:"context-bar-codegen-controls-right"},i.a.createElement("div",{className:"context-bar-codegen-controls-right__copy"},this.props.codeCopied?i.a.createElement(r.Button,{onClick:this.props.handleCopyCode,tooltip:"已拷贝"},i.a.createElement(s.Icon,{name:"icon-state-success-stroke",className:"code-copied-icon"})):i.a.createElement(r.Button,{type:"tertiary",onClick:this.props.handleCopyCode,tooltip:"拷贝片段"},i.a.createElement(s.Icon,{name:"icon-action-copy-stroke",className:"code-copy-icon"})))))}}t.default=c}.call(this,n(574))},14630:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"default",(function(){return l}));var a=n(2),i=n.n(a),s=n(3100),o=n(2397),r=n(3693);class l extends a.Component{constructor(e){super(e),this.selectedTarget=this.selectedTarget.bind(this)}getFilteredList(t,n,a={}){return!n||a.firstRender?t:e.filter(t,(t=>t.id&&e.includes(t.name.toLowerCase(),n.toLowerCase())))}selectedTarget(){var t=this.props.filterItems,n=this.props.selectedTarget,a=e.find(t,(e=>e.id===n.id));return a||{id:'{language:"curl",variant:"cURL"}',name:"cURL"}}getOption(e,t,n={}){const a=e.name,s=e.id;return t&&!n.firstRender?i.a.createElement(o.default,null,i.a.createElement("div",{className:"input-select-item",key:s},i.a.createElement(r.default,{source:a,query:t}))):i.a.createElement(o.default,null,i.a.createElement("div",{className:"input-select-item",key:s},a))}render(){var{filterItems:e}=this.props;return i.a.createElement("div",{className:"context-bar-dropdown-wrapper"},i.a.createElement("div",null,i.a.createElement(s.InputSelectV2,{style:{height:"32px"},onSelect:this.props.onTargetSelect,getFilteredList:this.getFilteredList.bind(this,e),optionRenderer:this.getOption,selectedItem:this.selectedTarget(),ref:"inputSelect",menuClassName:this.props.menuClassName,getInputValue:e=>e.name||""})))}}}.call(this,n(574))},14631:function(e,t,n){"use strict";n.r(t);var a=n(2),i=n.n(a),s=n(3142);class o extends i.a.Component{constructor(e){super(e)}render(){return i.a.createElement("div",{className:"context-bar-code-snippet-editor"},i.a.createElement(s.default,{ref:e=>e&&e.focus(),indentation:this.props.indentation,value:this.props.codeSnippet,language:this.props.editorMode,onChange:this.props.handleSnippetChange,wordWrap:!0,ref:"editor"}))}}t.default=o},34478:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"default",(function(){return m}));var a,i=n(2),s=n.n(i),o=n(2353),r=n(1656),l=n(7326),c=n(2778),p=n(34479),d=n(34481),g=n(12974),h=n(7145),u=n(5929);let m=Object(o.observer)(a=class extends s.a.Component{constructor(t){super(t),this.state={activeLanguage:{language:"curl",variant:"cURL"},optionsArray:[],optionsPreference:{},codeSnippet:"",originalSnippetHash:"",codeCopied:!1,selectedLanguage:{}},this.handleCodeTypeSelect=this.handleCodeTypeSelect.bind(this),this.handleSnippetChange=this.handleSnippetChange.bind(this),this.handleCopyCode=this.handleCopyCode.bind(this),this.store=Object(u.getStore)("CodegenStore"),this.throttledGenerateSnippet=e.throttle(this.handleCodeTypeSelect.bind(this),500,{leading:!0,trailing:!0})}componentDidMount(){var t={id:this.store.languagePreference},{language:n,variant:a}=e.isObject(t.id)?t:JSON.parse(t.id);this.disposePreviewReaction=Object(r.reaction)((()=>{let e=Object(u.getStore)("EditorStore").find(this.props.contextData.editorId),t=e&&e.model;return t&&t.viewState&&Object(r.toJS)(t.viewState.previewRequest)}),(()=>{this.throttledGenerateSnippet(this.state.selectedLanguage)})),this.handleCodeTypeSelect(t),c.default.addEventV2({category:"codegen",action:"open_codegen_contextbar",label:`${n}_${a}`})}componentWillUnmount(){this.disposePreviewReaction&&this.disposePreviewReaction()}componentDidUpdate(t){const{id:n}=t.contextData||{};n!==e.get(this.props.contextData,"id")&&this.handleCodeTypeSelect(this.state.selectedLanguage)}hash(e){return n(1170).createHash("sha1").update(e).digest("base64")}handleCodeTypeSelect(t){e.isEmpty(t)||this.setState({selectedLanguage:t});let n,a=e.isEmpty(t)?this.store.languagePreference:JSON.parse(t.id),{language:i,variant:s}=a,o={};this.setState({activeLanguage:{language:i,variant:s}}),g.default.getOptions(i,s).then((e=>{e&&e.length&&(this.setState({optionsArray:e}),e.forEach((e=>{o[e.id]=e.default})))})).catch((e=>{this.setState({optionsArray:[]}),pm.logger.error(`CodeCBView~handleCodeTypeSelect - ${e}`)})).then((()=>{n=this.store.getSnippetOptionForLanguage(i,s)||o,this.setState({optionsPreference:n})})).then((()=>{let e=this.props.contextData&&this.props.contextData.type;g.default.getSnippet(this.props.contextData.editorId,{language:i,variant:s,optionsPreference:n},e).then((e=>{if(!e)return;let t=this.hash(e.snippet);t!==this.state.originalSnippetHash&&this.setState({codeSnippet:e.snippet,originalSnippetHash:t},(()=>{let e=JSON.stringify({language:i,variant:s});this.store.updateLanguagePreference(e)}))}))}))}handleSnippetChange(e){this.setState({codeSnippet:e})}handleCopyCode(){h.default.copy(this.state.codeSnippet),this.setState({codeCopied:!0}),clearTimeout(this.timeout),this.timeout=setTimeout((()=>{this.setState({codeCopied:!1})}),1500)}render(){let t,n=e.get(this.state.activeLanguage,"language","curl"),{controller:a={}}=this.props||{},i=e.get(this.state.activeLanguage,"variant","cURL"),o=a.labelEditorMap&&a.labelEditorMap[`${n}_${i}`]?a.labelEditorMap[`${n}_${i}`].editorMode:"powershell",r={indentationType:this.state.optionsPreference.indentType?e.toLower(this.state.optionsPreference.indentType):null,indentationSize:this.state.optionsPreference.indentCount||null},c=this.store.getSnippetOptions();return a.editor&&(t=a.editor.isDirty),"dart"===o&&(o="powershell"),s.a.createElement("div",{className:"context-bar-code-snippet-view"},s.a.createElement(l.ContextBarViewHeader,{title:"代码片段",onClose:this.props.onClose}),s.a.createElement("div",{className:"context-bar-code-snippet-body"},s.a.createElement(p.default,{codeCopied:this.state.codeCopied,languageList:a.languageList,onSelectLanguage:this.handleCodeTypeSelect,selectedLanguage:this.state.selectedLanguage,handleCopyCode:this.handleCopyCode,snippetOptions:c,isDirty:t}),s.a.createElement(d.default,{indentation:r,codeSnippet:this.state.codeSnippet,editorMode:o,handleSnippetChange:this.handleSnippetChange})))}})||a}.call(this,n(2753))},34479:function(e,t,n){"use strict";n.r(t),function(e){var a=n(2),i=n.n(a),s=n(9),o=n(34480),r=n(7124),l=n(6056);class c extends i.a.Component{constructor(e){super(e),this.openLanguageSettingsModal=()=>{l.ModalViewManager.onMount((()=>{pm.mediator.trigger("openLanguageSettingsModel",this.props.selectedLanguage)}))},this.openLanguageSettingsModal=this.openLanguageSettingsModal.bind(this)}componentDidUpdate(t){let n=this.props.snippetOptions,a=t.snippetOptions,i=JSON.parse(this.props.selectedLanguage.id),s=e.get(i,"language","curl"),o=e.get(i,"variant","cURL");(JSON.stringify(a[`${s}_${o}`])!==JSON.stringify(n[`${s}_${o}`])||!this.props.isDirty&&t.isDirty)&&this.props.onSelectLanguage(this.props.selectedLanguage)}render(){return i.a.createElement("div",{className:"context-bar-codegen-controls"},i.a.createElement("div",{className:"context-bar-codegen-controls-left"},i.a.createElement("div",{className:"context-bar-codegen-controls-left__dropdown"},i.a.createElement(o.default,{selectedTarget:this.props.selectedLanguage,onTargetSelect:this.props.onSelectLanguage,menuClassName:"context-bar-codegen-dropdown",filterItems:this.props.languageList})),i.a.createElement("div",{className:"context-bar-codegen-controls-left__setting"},i.a.createElement(r.Button,{type:"tertiary",onClick:this.openLanguageSettingsModal},i.a.createElement(s.Icon,{name:"icon-descriptive-setting-stroke",className:"language-settings-icon",tooltip:"代码设置"})))),i.a.createElement("div",{className:"context-bar-codegen-controls-right"},i.a.createElement("div",{className:"context-bar-codegen-controls-right__copy"},this.props.codeCopied?i.a.createElement(r.Button,{onClick:this.props.handleCopyCode,tooltip:"已拷贝"},i.a.createElement(s.Icon,{name:"icon-state-success-stroke",className:"code-copied-icon"})):i.a.createElement(r.Button,{type:"tertiary",onClick:this.props.handleCopyCode,tooltip:"拷贝片段"},i.a.createElement(s.Icon,{name:"icon-action-copy-stroke",className:"code-copy-icon"})))))}}t.default=c}.call(this,n(2753))},34480:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"default",(function(){return l}));var a=n(2),i=n.n(a),s=n(8604),o=n(7321),r=n(8955);class l extends a.Component{constructor(e){super(e),this.selectedTarget=this.selectedTarget.bind(this)}getFilteredList(t,n,a={}){return!n||a.firstRender?t:e.filter(t,(t=>t.id&&e.includes(t.name.toLowerCase(),n.toLowerCase())))}selectedTarget(){var t=this.props.filterItems,n=this.props.selectedTarget,a=e.find(t,(e=>e.id===n.id));return a||{id:'{language:"curl",variant:"cURL"}',name:"cURL"}}getOption(e,t,n={}){const a=e.name,s=e.id;return t&&!n.firstRender?i.a.createElement(o.default,null,i.a.createElement("div",{className:"input-select-item",key:s},i.a.createElement(r.default,{source:a,query:t}))):i.a.createElement(o.default,null,i.a.createElement("div",{className:"input-select-item",key:s},a))}render(){var{filterItems:e}=this.props;return i.a.createElement("div",{className:"context-bar-dropdown-wrapper"},i.a.createElement("div",null,i.a.createElement(s.InputSelectV2,{style:{height:"32px"},onSelect:this.props.onTargetSelect,getFilteredList:this.getFilteredList.bind(this,e),optionRenderer:this.getOption,selectedItem:this.selectedTarget(),ref:"inputSelect",menuClassName:this.props.menuClassName,getInputValue:e=>e.name||""})))}}}.call(this,n(2753))},34481:function(e,t,n){"use strict";n.r(t);var a=n(2),i=n.n(a),s=n(8772);class o extends i.a.Component{constructor(e){super(e)}render(){return i.a.createElement("div",{className:"context-bar-code-snippet-editor"},i.a.createElement(s.default,{ref:e=>e&&e.focus(),indentation:this.props.indentation,value:this.props.codeSnippet,language:this.props.editorMode,onChange:this.props.handleSnippetChange,wordWrap:!0,ref:"editor"}))}}t.default=o}}]);