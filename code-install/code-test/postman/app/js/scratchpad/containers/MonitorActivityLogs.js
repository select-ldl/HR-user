(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{24609:function(e,t,i){"use strict";i.r(t),function(e){i.d(t,"default",(function(){return E}));var r,s=i(2),o=i.n(s),a=i(2353),n=i(2825),l=i.n(n),c=i(7326),m=i(24610),d=i(24615),p=i(5929),h=i(8314),u=i(8621),f=i(7124),v=i(9),y=i(24616),g=i(8317);function S(){return S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},S.apply(this,arguments)}let E=Object(a.observer)(r=class extends s.Component{constructor(t){super(t),this.handleSearch=e.debounce((e=>{const t=u.default.getMonitorIdFromActiveRoute();this.setState({isFilterApplied:!0,filter:e}),this.props.controller.monitorActivityStore.getActivitiesByMonitor({monitorId:t,members:Object.keys(e.members),page:1},!0),this.props.controller.monitorActivityStore.setActiveMonitorId(t)}),600),this.state={isFilterApplied:!1,filter:{members:{}}},this.handleLoadMore=this.handleLoadMore.bind(this),this.canViewActivityLogs=this.canViewActivityLogs.bind(this),this.handleRefresh=this.handleRefresh.bind(this),this.handleSearch=this.handleSearch.bind(this),this.getRefreshTextClass=this.getRefreshTextClass.bind(this),this.getWorkspaceUsers=this.getWorkspaceUsers.bind(this),this.handleFilterSelect=this.handleFilterSelect.bind(this),this.monitorPermissionStore=new h.default}getRefreshTextClass(){return l()({"pm-activity-section__refresh__btn":!0,"is-loading":this.props.controller.monitorActivityStore.loading})}handleLoadMore(){this.props.controller.monitorActivityStore.getActivitiesByMonitor({monitorId:this.props.controller.monitorActivityStore.activeMonitorId,members:Object.keys(this.state.filter.members),page:this.props.controller.monitorActivityStore.nextPage},!1),this.props.controller.monitorActivityStore.setMoreLoading(!0)}canViewActivityLogs(){return this.monitorPermissionStore.can("viewActivityLogs",this.props.contextData.id)}handleRefresh(){const e=u.default.getMonitorIdFromActiveRoute();this.setState({isFilterApplied:!1,filter:{members:{}}}),this.props.controller.monitorActivityStore.getActivitiesByMonitor({monitorId:e,page:1},!0),this.props.controller.monitorActivityStore.setActiveMonitorId(e)}handleFilterSelect(t,i,r){let s={};s=r?S({},this.state.filter.members,{[t]:e.find(i,{id:t})}):e.omitBy(this.state.filter.members,{id:t}),this.setState({isFilterApplied:!0,filter:{members:s}},(()=>{this.handleSearch(this.state.filter)}))}getWorkspaceUsers(){const t=e.get(Object(p.getStore)("ActiveWorkspaceStore"),"members"),i={};return e.forEach(t,(t=>{let r=Object(p.getStore)("CurrentUserStore").teamMembers.get(t.id);e.isEmpty(r)||(i[t.id]=e.omit(S({},r),["role"]))})),i}render(){let t=this.getWorkspaceUsers();return o.a.createElement("div",{className:"contextCustomScroll"},o.a.createElement(c.ContextBarViewHeader,{title:this.props.title,onClose:this.props.onClose},o.a.createElement(f.Button,{onClick:this.handleRefresh,className:this.getRefreshTextClass(),tooltip:this.props.controller.monitorActivityStore.isOffline?g.TOOLTIP_TEXT.isOffline:g.TOOLTIP_TEXT.isOnline,disabled:this.props.controller.monitorActivityStore.isOffline||this.props.controller.monitorActivityStore.loading},o.a.createElement(v.Icon,{className:"pm-activity-section__refresh__btn__icon",name:"icon-action-refresh-stroke",color:"content-color-primary",size:"large"})),Object(p.getStore)("CurrentUserStore").isLoggedIn&&t&&o.a.createElement(y.default,{filtersApplied:this.state.filter,loadingUsers:Object(p.getStore)("CurrentUserStore").isHydrating||!e.size(t),handleRefresh:this.handleRefresh,handleSearch:this.handleSearch,isFilterApplied:this.state.isFilterApplied,workspaceUsers:t,handleSelect:this.handleFilterSelect,disabled:this.props.controller.monitorActivityStore.isOffline,tooltip:this.props.controller.monitorActivityStore.isOffline?g.TOOLTIP_TEXT.isOffline:g.ACTIVITY_LOGS_FILTER})),o.a.createElement("div",{className:"monitor-activity"},this.props.controller.monitorActivityStore.isOffline&&!this.props.controller.monitorActivityStore.values.length?o.a.createElement(d.default,null):o.a.createElement(m.default,{isFilterApplied:this.state.isFilterApplied,activities:this.props.controller.monitorActivityStore.values,teamUsers:Object(p.getStore)("TeamStore").allTeamMembers,nextPage:this.props.controller.monitorActivityStore.nextPage,loading:this.props.controller.monitorActivityStore.loading,error:this.props.controller.monitorActivityStore.error,loaded:this.props.controller.monitorActivityStore.loaded,loadingMore:this.props.controller.monitorActivityStore.loadingMore,handleLoadMore:this.handleLoadMore,listLoading:this.props.controller.monitorActivityStore.listLoading,moreLoading:this.props.controller.monitorActivityStore.moreLoading,canViewActivityLogs:this.canViewActivityLogs(),isOffline:this.props.controller.monitorActivityStore.isOffline})))}})||r}.call(this,i(2753))},24610:function(e,t,i){"use strict";i.r(t),i.d(t,"LoadMore",(function(){return S})),i.d(t,"fetchTeamUsers",(function(){return E})),i.d(t,"default",(function(){return A}));var r=i(2),s=i.n(r),o=i(2753),a=i.n(o),n=i(9),l=i(7121),c=i(24611),m=i(24613),d=i(5929),p=i(8342),h=i(8343),u=i(24614),f=i(8317),v=i(6913);function y(){return y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},y.apply(this,arguments)}function g(e){const t=new Date(e),i=[f.MONTH_NAMES[t.getMonth()],`${t.getDate()},`,t.getFullYear()].join(" "),r=function(e){const t=new Date(e),i=new Date(t.toDateString()),r=new Date,s=new Date(r.toDateString()),o=Math.abs(i-s),a=Math.ceil(o/864e5);if(i<s)return-a;return a}(e);return 0===r?"Today":-1===r?"Yesterday":i}function S(e){let t;return e.show?(t=e.loading?s.a.createElement(l.default,{className:"loader-activity-logs"}):e.nextPage?s.a.createElement(n.Button,{type:"outline",onClick:e.onClick,isDisabled:e.isOffline,text:f.ACTIVITY_LOGS_LOAD_MORE,fullWidth:!0,tooltip:e.isOffline&&f.TOOLTIP_TEXT.isOffline}):f.ACTIVITY_LOGS_LIST_END,s.a.createElement("div",{className:"monitor-activity__load-more"},t)):null}function E(e){return Object.assign({},...Object.entries(y({},e)).map((([e,t])=>({[Number(t.id)]:t}))))}function A(e){const{activities:t,loading:i,nextPage:r,moreLoading:o,error:n}=e,y=function(e){if(a.a.isEmpty(e))return[];let t="",i=[];return e.forEach((e=>{let r=new Date(e.timestamp).toDateString(),s=g(e.timestamp);r!==t?(t=r,i.push({name:s,items:[e]})):i[i.length-1].items.push(e)})),i}(t);return Object(d.getStore)("CurrentUserStore").isLoggedIn?e.canViewActivityLogs?n?s.a.createElement(u.default,null):i&&!o||a.a.isEmpty(t)&&i?s.a.createElement(l.default,{className:"loader-activity-logs"}):a.a.isEmpty(t)&&!i?s.a.createElement(m.default,{isFilterApplied:e.isFilterApplied}):s.a.createElement("div",{className:"pm-activity-feed"},s.a.createElement("div",{className:"pm-activity-section-container"},a.a.map(y,(t=>{let i="",r=!1;return s.a.createElement("div",{className:"pm-activity-section",key:t.name},s.a.createElement("div",{className:"pm-monitor-activity-section__date"},t.name),a.a.map(t.items,(t=>(r=i!==t.actor.id,i=t.actor.id,s.a.createElement(c.default,{activity:t,key:t.id,showUserIcon:r,isOffline:e.isOffline})))))}))),s.a.createElement(S,{loading:i,nextPage:r,show:!a.a.isEmpty(t),onClick:e.handleLoadMore,isOffline:e.isOffline})):s.a.createElement("div",{className:"activity-logs-public-view"},s.a.createElement("div",{className:"empty-state-activity-logs"}),s.a.createElement("div",{className:"activity-logs-public-view__entity"},f.PERMISSION_TEXT.CONSOLE_DISABLED_MSG)):s.a.createElement("div",{className:"activity-logs-public-view"},s.a.createElement(p.default,{title:f.SIGN_IN_MESSAGE.title,subtitle:f.SIGN_IN_MESSAGE.subTitle,onSignIn:function(){h.default.initiateLogin({isSignup:!1})},onCreateAccount:function(){const e=Object(v.getAllParams)({utm_content:"monitor_activity_feed",utm_term:"sign_up"});h.default.initiateLogin({isSignup:!0,queryParams:e})}}))}},24611:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return h}));var r=i(2),s=i.n(r),o=i(2825),a=i.n(o),n=i(7113),l=i.n(n),c=i(8317),m=i(8767),d=i(24612);function p(){return p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},p.apply(this,arguments)}function h(e){const{activity:t,showUserIcon:i}=e;let r;var o;return 0===l.a.getFormattedDate(t.timestamp)?r=l.a.getFormattedTime(t.timestamp):(o=t.timestamp,r=new Date(o).toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})),s.a.createElement("div",{className:a()({"pm-activity-list-item":!0,"show-user":i,"activity-logs-offline":e.isOffline})},i&&s.a.createElement("div",{className:"pm-monitor-activity-list-item__icon"},s.a.createElement(m.default,{type:"user",customPic:t.actor.profilePicUrl,userId:t.actor.id,size:"large"})),s.a.createElement("p",{className:"pm-activity-list-item__time"},r),s.a.createElement("div",{className:"pm-activity-list-item__text"},0!==t.actor.id&&s.a.createElement(d.default,p({},t.actor,{showAvatar:!1,allowAlias:!0})),0!==t.actor.id?Object(c.getUserVisibleAction)(t.action):Object(c.getUserVisibleSystemAction)(t.action,t.context)))}},24613:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return l}));var r=i(2),s=i.n(r),o=i(9),a=i(8309),n=i(8317);function l(e){return s.a.createElement(a.default,{body:e.isFilterApplied?n.ACTIVITY_LOGS_EMPTY_STATE.withFiltersSubText:n.ACTIVITY_LOGS_EMPTY_STATE.subText,title:e.isFilterApplied?n.ACTIVITY_LOGS_EMPTY_STATE.withFiltersText:n.ACTIVITY_LOGS_EMPTY_STATE.text,illustration:s.a.createElement(o.IllustrationNoActivity,null),className:e.isFilterApplied?"activity-logs-empty-state-no-logs-with-filters":"activity-logs-empty-state-no-logs"})}},24614:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return c}));var r=i(2),s=i.n(r),o=i(2756),a=i.n(o),n=i(9),l=i(8317);class c extends r.Component{constructor(e){super(e)}render(){return s.a.createElement("div",{className:"monitor-contextbar-error-view"},s.a.createElement("div",{className:"monitor-contextbar-error-view__illustration"},s.a.createElement(n.IllustrationUnableToLoad,null)),s.a.createElement("div",{className:"monitor-contextbar-error-view__title"},s.a.createElement(n.Heading,{type:"h4",color:"content-color-secondary",text:this.props.title})),s.a.createElement("div",null,s.a.createElement("div",{className:"monitor-contextbar-error-view__subtitle"},s.a.createElement(n.Text,{type:"body-medium",color:"content-color-secondary"},this.props.subtitle))))}}c.defaultProps={title:l.MONITOR_ACTION_ERROR.activityLoadFailure,subtitle:l.MONITOR_ACTION_ERROR.retry},c.propTypes={title:a.a.string,message:a.a.string}},24616:function(e,t,i){"use strict";i.r(t),function(e){i.d(t,"default",(function(){return y}));var r,s=i(2),o=i.n(s),a=i(2353),n=i(8767),l=i(2752),c=i(7307),m=i(9547),d=i(7121),p=i(2825),h=i.n(p),u=i(7124),f=i(9),v=i(8317);let y=Object(a.observer)(r=class extends s.Component{constructor(e){super(e),this.state={isFilterApplied:e.isFilterApplied,searchQuery:"",searchResults:[]},this.handleFuzzySearch=this.handleFuzzySearch.bind(this),this.getClasses=this.getClasses.bind(this)}handleFuzzySearch(e,t){this.setState({searchQuery:e,searchResults:t})}getClasses(){return h()({"select-dropdown-container":!0,applied:this.state.isFilterApplied,selected:!this.state.isFilterApplied&&this.state.isSelected})}render(){const t=e.map(e.cloneDeep(this.props.workspaceUsers),(e=>(e.name=e.name||e.username,e)));let i=this.state.searchQuery?this.state.searchResults:t;return o.a.createElement("div",{className:h()(this.props.className)},o.a.createElement(c.Dropdown,{className:this.getClasses()},o.a.createElement(c.DropdownButton,{dropdownStyle:"nocaret"},o.a.createElement(u.Button,{type:"tertiary",tooltip:this.props.tooltip,disabled:this.props.disabled},o.a.createElement(f.Icon,{name:"icon-action-filter-stroke"}))),o.a.createElement(c.DropdownMenu,null,this.props.disabled?"":o.a.createElement("div",{className:"select-dropdown"},o.a.createElement(m.default,{searchQuery:this.state.searchQuery,placeholder:"Search for user",onChange:this.handleFuzzySearch,items:t,searchFields:["name","email"]}),o.a.createElement("div",{className:h()({"select-dropdown-list":!0,isLoading:this.props.loadingUsers})},this.props.loadingUsers?o.a.createElement(d.default,null):i&&i.length?e.map(i,(e=>o.a.createElement("div",{key:e.id,className:"select-dropdown-item",onClick:this.props.handleSelect.bind(this,e.id,i,!this.props.filtersApplied.members[e.id])},o.a.createElement(n.default,{size:"small",userId:e.id,customPic:e.profilePicUrl,linkProfile:!1}),o.a.createElement("span",{className:"select-dropdown-item-text",title:e.name},e.name),o.a.createElement(l.Checkbox,{onChange:this.props.handleSelect.bind(this,e.id,i),className:"select-dropdown-item-checkbox",checked:this.props.filtersApplied.members[e.id]})))):o.a.createElement("div",{className:"activity-user-filter-dropdown-no-user"},v.ACTIVITY_LOGS_NO_USERS))))))}})||r}.call(this,i(2753))}}]);