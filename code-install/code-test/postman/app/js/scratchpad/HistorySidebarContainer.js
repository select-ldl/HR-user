(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{14526:function(e,t,s){"use strict";s.r(t),function(e){s.d(t,"default",(function(){return O}));var i,o=s(2),n=s.n(o),r=s(2375),l=s.n(r),a=s(2353),c=s(1662),d=s(1661),h=s(1908),p=s(14527),m=s(2322),u=s(5321),S=s(3187),g=s(3122),b=s(2340),T=s(14528),E=s(4446),y=s(3838);let O=l()(i=Object(a.observer)(i=class extends o.Component{constructor(t){super(t),this.store=Object(c.getStore)("HistorySidebarStore"),this.focus=this.focus.bind(this),this.handleLoadRequestDebounced=e.debounce(this.handleLoadRequest,100,{leading:!0}).bind(this),this.handleLoadCollectionRunDebounced=e.debounce(this.handleLoadCollectionRun,100,{leading:!0}).bind(this),this.handleLoadWebSocketHistoryDebounced=e.debounce(this.handleLoadWebSocketHistory,100,{leading:!0}).bind(this),this.handleActiveRequestChange=this.handleActiveRequestChange.bind(this),this.handleAddToCollection=this.handleAddToCollection.bind(this),this.handleDeleteMultiple=this.handleDeleteMultiple.bind(this),this.handleItemSelect=this.handleItemSelect.bind(this),this.handleSelectAction=this.handleSelectAction.bind(this),this.handleSelectHistoryAction=this.handleSelectHistoryAction.bind(this),this.handleSelectCollectionRunAction=this.handleSelectCollectionRunAction.bind(this),this.handleSelectWebSocketHistoryAction=this.handleSelectWebSocketHistoryAction.bind(this)}UNSAFE_componentWillMount(){pm.mediator.on("activeRequestChanged",this.handleActiveRequestChange)}componentWillUnmount(){pm.mediator.off("activeRequestChanged",this.handleActiveRequestChange)}focus(){e.invoke(this,"refs.history.focus")}selectNext(){e.invoke(this,"refs.history.selectNext")}handleActiveRequestChange(e){this.store.itemExists(e)?this.store.resetSelection([e]):this.store.resetSelection()}handleClickOutside(t){if(!e.isEmpty(this.store.getSelectedItems())){const e=document.getElementsByClassName("ReactModal__Content")[0],s=document.querySelector(".history-sidebar-multiple-request-selected-dropdown");if(e&&e.contains(t.target)||s&&s.contains(t.target))return;this.store.resetSelection()}}handleLoadRequest(e,t=!1){e&&m.default.openHistoryInTab(e,{newTab:t,preview:!0})}handleLoadCollectionRun(e,t=!1){if(!e)return;const{uid:s}=Object(c.getStore)("RunnerRunStore").find(e)||{};Object(S.openRunInTab)(s,{newTab:t,preview:!t})}handleLoadWebSocketHistory(e,t=!1){e&&Object(E.openWebSocketHistoryTab)(e,{forceNew:t,preview:!t})}handleItemSelect({id:t,type:s},i={}){const o=e.includes(navigator.platform,"Mac");i.shiftKey&&(o?i.metaKey:i.ctrlKey)?("collectionrun"===s?this.handleLoadCollectionRunDebounced(t,!0):"websockethistory"===s?this.handleLoadWebSocketHistoryDebounced(t,!0):this.handleLoadRequestDebounced(t,!0),pm.mediator.trigger("focusSidebar")):i.ctrlKey||i.metaKey?this.store.isItemSelected(t)?this.store.unselectItem(t):this.store.selectItem(t):("collectionrun"===s?this.handleLoadCollectionRunDebounced(t,!1):"websockethistory"===s?this.handleLoadWebSocketHistoryDebounced(t,!1):this.handleLoadRequestDebounced(t,!1),pm.mediator.trigger("focusSidebar"),this.store.resetSelection([t]))}handleAddToCollection(t={}){const{requests:s}=t,i=e.isEmpty(s)?this.store.getSelectedItems():s;e.isEmpty(i)||m.default.convertHistoryToRequests(i).then((s=>{1===e.size(s)?s[0]&&pm.mediator.trigger("showAddToCollectionModal",s[0],{from:t.from}):pm.mediator.trigger("addRequestsToCollection",s,t)}))}handleToggleHistoryResponseSaving(){if(!Object(b.isWorkspaceMember)())return Object(b.canJoinWorkspace)()?pm.mediator.trigger("openUnjoinedWorkspaceModal"):Object(b.isLoggedIn)()?pm.toasts.error("您没有执行该操作所需的权限."):pm.mediator.trigger("showSignInModal",{type:"history",origin:"history_save_response"});const e=Object(c.getStore)("ActiveWorkspaceStore").settings,t={enableHistoryResponseSaving:!(e&&e.enableHistoryResponseSaving)};return Object(h.default)(Object(d.createEvent)("updateSettings","workspace",{id:Object(c.getStore)("ActiveWorkspaceStore").id,settings:t})).catch((e=>{const t=e.isFriendly?e.message:"无法更新工作区设置";pm.toasts.error(t,{dedupeId:"ws-settings-error"})}))}resetHistorySelection(e){e&&e.id?this.store.resetSelection([e.id]):this.store.resetSelection()}handleDeleteMultiple(t,s){const i=Object(c.getStore)("PermissionStore"),o=Object(c.getStore)("RunnerRunStore");return Object(b.isWorkspaceMember)()?Object(c.getStore)("OnlineStatusStore").userCanSave?Promise.resolve().then((()=>{"all"===t?(Object(h.default)(Object(d.createEvent)("deleteAllInWorkspace","history",Object(c.getStore)("ActiveWorkspaceStore").id)),o.deleteRun(e.map(o.values,(e=>e.id))),Object(E.deleteWebSocketHistory)()):"selected"===t&&(i.can("delete","history")?Object(h.default)(Object(d.createEvent)("deleteMultiple","history",{ids:this.store.getSelectedItems()},null,null)):pm.toasts.error("您没有权限删除历史."),i.can("delete","collectionrun")?Object(c.getStore)("RunnerRunStore").deleteRun(this.store.getSelectedItems()):pm.toasts.error("您没有权限删除集合运行."),Object(E.deleteWebSocketHistory)(this.store.getSelectedItems()))})).then((()=>{this.resetHistorySelection(s)})).catch((()=>{this.resetHistorySelection(s)})):Object(g.showOfflineActionDisabledToast)():Object(b.canJoinWorkspace)()?pm.mediator.trigger("openUnjoinedWorkspaceModal"):Object(b.isLoggedIn)()?pm.toasts.error("您没有执行该操作所需的权限."):pm.mediator.trigger("showSignInModal",{type:"history",origin:"history_delete_multiple"})}handleAddRequestToService(t,s){const{requests:i,defaultCollectionName:o="",from:n=""}=t,r=e.isEmpty(i)?this.store.getSelectedItems():i;e.isEmpty(r)||m.default.convertHistoryToRequests(r).then((t=>{if(!e.isEmpty(t)){const e={name:o,from:n};u.default.create(s,{requests:t,opts:e},null,{from:"history_sidebar"})}}))}handleSelectHistoryAction(e,t){switch(e){case T.ACTION_TYPE_SAVE:if(!Object(c.getStore)("OnlineStatusStore").userCanSave)return Object(g.showOfflineActionDisabledToast)();this.handleAddToCollection(t);break;case T.ACTION_TYPE_MONITOR:this.handleAddRequestToService(t,"openCreateNewMonitorModal");break;case T.ACTION_TYPE_DOCUMENT:this.handleAddRequestToService(t,"openCreateNewDocumentationModal");break;case T.ACTION_TYPE_MOCK:this.handleAddRequestToService(t,"openCreateNewMockModal");break;case T.ACTION_TYPE_DELETE:if(!Object(c.getStore)("OnlineStatusStore").userCanSave)return Object(g.showOfflineActionDisabledToast)();Object(h.default)(Object(d.createEvent)("deleteMultiple","history",{ids:t.requests},null,null))}}handleSelectCollectionRunAction(e,t){switch(e){case T.ACTION_TYPE_DELETE:if(!Object(c.getStore)("OnlineStatusStore").userCanSave)return Object(g.showOfflineActionDisabledToast)();Object(c.getStore)("RunnerRunStore").deleteRun(t.runs);break;case T.ACTION_TYPE_DOWNLOAD:return Object(y.exportRuns)(t.runs);default:pm.logger.warn(`HistorySidebarContainer~handleSelectCollectionRunAction: ${e} - action not handled`)}}handleSelectWebSocketHistoryAction(e,t){if(e===T.ACTION_TYPE_DELETE){if(!Object(c.getStore)("OnlineStatusStore").userCanSave)return Object(g.showOfflineActionDisabledToast)();Object(E.deleteWebSocketHistory)(t.websockethistory)}}handleSelectAction(t,s,i){return Object(b.isWorkspaceMember)()?"collectionrun"===t?(1===e.size(i.runs)&&s===T.ACTION_TYPE_DELETE&&this.store.unselectItem(i.runs[0]),i.runs&&this.handleSelectCollectionRunAction(s,i)):"websockethistory"===t?(1===e.size(i.websockethistory)&&s===T.ACTION_TYPE_DELETE&&this.store.unselectItem(i.websockethistory[0]),i.websockethistory&&this.handleSelectWebSocketHistoryAction(s,i)):"request"===t?(1===e.size(i.requests)&&s===T.ACTION_TYPE_DELETE&&this.store.unselectItem(i.requests[0]),this.handleSelectHistoryAction(s,i)):void("all"===t&&(i.runs&&this.handleSelectCollectionRunAction(s,i),i.requests&&this.handleSelectHistoryAction(s,i),i.websockethistory&&this.handleSelectWebSocketHistoryAction(s,i))):Object(b.canJoinWorkspace)()?pm.mediator.trigger("openUnjoinedWorkspaceModal"):Object(b.isLoggedIn)()?pm.toasts.error("您没有执行该操作所需的权限."):pm.mediator.trigger("showSignInModal",{type:"history",origin:`history_${s}`})}render(){const e=Object(c.getStore)("ActiveWorkspaceStore").settings,t=Object(c.getStore)("SyncStatusStore"),s=Object(c.getStore)("CurrentUserStore"),i=Object(c.getStore)("HistoryStore"),o=Object(c.getStore)("ActiveWorkspaceStore"),r=e&&e.enableHistoryResponseSaving;return n.a.createElement(p.default,{store:this.store,enableHistoryResponseSaving:r,initializing:s.isHydrating||i.isHydrating||!o.id,isLoggedIn:s.isLoggedIn,isSocketConnected:t.isSocketConnected,workspace:o.id,onSelectAction:this.handleSelectAction,onDeleteMultiple:this.handleDeleteMultiple,onSelect:this.handleItemSelect,onSaveCurrentRequest:this.handleAddToCollection,onToggleHistoryResponseSaving:this.handleToggleHistoryResponseSaving,ref:"history"})}})||i)||i}.call(this,s(574))},14527:function(e,t,s){"use strict";s.r(t),function(e){s.d(t,"default",(function(){return S}));var i,o=s(2),n=s.n(o),r=s(5),l=s(2850),a=s.n(l),c=s(2845),d=s(2397),h=s(14528),p=s(1662),m=s(14529),u=s(14532);let S=a()(i=class extends o.Component{constructor(e){super(e),this.store=Object(p.getStore)("HistorySidebarStore"),this.historyStore=Object(p.getStore)("HistoryStore"),this.focus=this.focus.bind(this),this.groupItems=this.groupItems.bind(this),this.selectNext=this.selectNext.bind(this),this.selectPrev=this.selectPrev.bind(this),this.deleteItem=this.deleteItem.bind(this),this.selectItem=this.selectItem.bind(this),this.multiselectNextItem=this.multiselectNextItem.bind(this),this.multiselectPrevItem=this.multiselectPrevItem.bind(this)}getKeyMapHandlers(){return{groupItems:pm.shortcuts.handle("groupItems",this.groupItems),nextItem:pm.shortcuts.handle("nextItem",this.selectNext),prevItem:pm.shortcuts.handle("prevItem",this.selectPrev),delete:pm.shortcuts.handle("delete",this.deleteItem),multiselectNextItem:pm.shortcuts.handle("multiselectNextItem",this.multiselectNextItem),multiselectPrevItem:pm.shortcuts.handle("multiselectPrevtItem",this.multiselectPrevItem),select:pm.shortcuts.handle("select",this.selectItem),search:pm.shortcuts.handle("search"),saveCurrentRequest:e=>{e&&e.stopPropagation(),this.props.onSaveCurrentRequest()}}}focus(){const e=Object(r.findDOMNode)(this.refs.history);e&&e.focus()}selectNext(t){t&&t.preventDefault();const s=this.store.getNextItem();s&&e.invoke(this,"props.onSelect",s)}selectPrev(t){t&&t.preventDefault();const s=this.store.getPrevItem();s&&e.invoke(this,"props.onSelect",s)}deleteItem(t){if(document.activeElement.classList.contains("history-sidebar__filter"))return;t&&t.preventDefault();const s=this.store.getPrevItem();e.invoke(this,"props.onDeleteMultiple","selected",s)}selectItem(t){t&&t.preventDefault(),e.invoke(this,"refs.list.selectItem")}multiselectNextItem(t){t&&t.preventDefault();const s=this.store.getNextItem();s&&e.invoke(this,"props.onSelect",s,{metaKey:!0})}multiselectPrevItem(t){t&&t.preventDefault();const s=this.store.getPrevItem();s&&e.invoke(this,"props.onSelect",s,{metaKey:!0})}groupItems(){this.props.onSelectAction&&this.props.onSelectAction("all",h.ACTION_TYPE_SAVE,{requests:this.store.getSelectedItems(),from:"history_multiple"})}render(){return n.a.createElement(c.default,{handlers:this.getKeyMapHandlers(),keyMap:pm.shortcuts.getShortcuts()},n.a.createElement("div",{className:"history-sidebar",ref:"history"},n.a.createElement("div",{className:"history-sidebar-wrapper"},n.a.createElement(m.default,{historySidebar:this.store,historyStore:this.historyStore,enableHistoryResponseSaving:this.props.enableHistoryResponseSaving,onDeleteMultiple:this.props.onDeleteMultiple,onSelectAction:this.props.onSelectAction.bind(this,"all"),onToggleHistoryResponseSaving:this.props.onToggleHistoryResponseSaving}),n.a.createElement(d.default,{identifier:"history"},n.a.createElement(u.default,{ref:"list",initializing:this.props.initializing,isSocketConnected:this.props.isSocketConnected,isLoggedIn:this.props.isLoggedIn,workspace:this.props.workspace,onDeleteMultiple:this.props.onDeleteMultiple,onLoadMore:this.props.onLoadMore,onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction})))))}})||i}.call(this,s(574))},14528:function(e,t,s){"use strict";s.r(t),s.d(t,"ACTION_TYPE_SAVE",(function(){return i})),s.d(t,"ACTION_TYPE_MONITOR",(function(){return o})),s.d(t,"ACTION_TYPE_DOCUMENT",(function(){return n})),s.d(t,"ACTION_TYPE_MOCK",(function(){return r})),s.d(t,"ACTION_TYPE_DELETE",(function(){return l})),s.d(t,"ACTION_TYPE_DOWNLOAD",(function(){return a}));const i="save",o="monitor",n="document",r="mock",l="delete",a="download"},14529:function(e,t,s){"use strict";s.r(t),function(e){s.d(t,"default",(function(){return O}));var i,o=s(2),n=s.n(o),r=s(2357),l=s.n(r),a=s(2353),c=s(9),d=s(2373),h=s(3717),p=s(2844),m=s(2374),u=s(3122),S=s(14528),g=s(3838),b=s(1662),T=s(14503),E=s(14530),y=s(14531);let O=Object(a.observer)(i=class extends o.Component{constructor(e){super(e),this.state={dropdownOpen:!1,showResponseToggleTooltip:!1},this.handleDeleteClick=this.handleDeleteClick.bind(this),this.handleDropdownToggle=this.handleDropdownToggle.bind(this),this.handleDropdownActionSelect=this.handleDropdownActionSelect.bind(this),this.handleAddToCollectionClick=this.handleAddToCollectionClick.bind(this),this.handleDeleteSelected=this.handleDeleteSelected.bind(this),this.handleSearchChange=this.handleSearchChange.bind(this),this.handleActionsDropdownSelect=this.handleActionsDropdownSelect.bind(this),this.handleSaveResponseToggle=this.handleSaveResponseToggle.bind(this),this.showResponseToggleTooltip=this.showResponseToggleTooltip.bind(this),this.hideResponseToggleTooltip=this.hideResponseToggleTooltip.bind(this),this.disableRequestItemOptions=this.disableRequestItemOptions.bind(this)}handleAddToCollectionClick(e){e.stopPropagation(),this.props.onSelectAction(S.ACTION_TYPE_SAVE,{requests:this.props.historySidebar.getSelectedItems(),from:"history_multiple"})}handleDeleteClick(){pm.mediator.trigger("showDeleteHistoryModal",(async()=>{try{this.props.onDeleteMultiple&&await this.props.onDeleteMultiple("all")}catch(e){pm.logger.error("无法删除历史",e),pm.toasts.error("无法删除历史")}}),{identifier:"all"})}handleDropdownToggle(e){e!==this.state.dropdownOpen&&this.setState({dropdownOpen:e})}handleDropdownActionSelect(e){return e===S.ACTION_TYPE_DELETE?Object(b.getStore)("OnlineStatusStore").userCanSave?void pm.mediator.trigger("showDeleteHistoryModal",(()=>{this.props.onDeleteMultiple("selected")}),{identifier:"selected"}):Object(u.showOfflineActionDisabledToast)():e===S.ACTION_TYPE_DOWNLOAD?Object(g.exportRuns)(this.props.historySidebar.getSelectedItems()):void this.props.onSelectAction(e,{requests:this.props.historySidebar.getSelectedItems(),from:"history_multiple"})}handleActionsDropdownSelect(e){if("history-sidebar--clear-all"===e)this.handleDeleteClick()}handleDeleteSelected(){this.handleDropdownActionSelect(S.ACTION_TYPE_DELETE)}disableRequestItemOptions(){const t=e.filter(this.props.historySidebar.historyItems,(e=>this.props.historySidebar.selectedItems.has(e.id)&&"request"===e.type));return e.isEmpty(t)}showResponseToggleTooltip(){this.setState({showResponseToggleTooltip:!0})}hideResponseToggleTooltip(){this.setState({showResponseToggleTooltip:!1})}handleSaveResponseToggle(e){e&&e.stopPropagation(),this.props.onToggleHistoryResponseSaving&&this.props.onToggleHistoryResponseSaving()}handleSearchChange(e){this.props.historySidebar.setSearchQuery(e)}getToggleSaveResponseClasses(e){return l()({"dropdown-menu-item history-sidebar-menu__actions-save-response-toggle":!0,"is-disabled":e})}render(){const t=this.props.historySidebar.selectedItems.size,{isLoggedIn:s}=Object(b.getStore)("CurrentUserStore"),{isOffline:i,userCanSave:o}=Object(b.getStore)("OnlineStatusStore"),r=i&&s,l=!Object(b.getStore)("PermissionStore").can("editMeta","workspace",Object(b.getStore)("ActiveWorkspaceStore").id);return t>1?n.a.createElement("div",{className:"history-sidebar-menu multiple-request-selected"},n.a.createElement("div",{className:"history-sidebar-menu__left"},n.a.createElement(c.Text,{type:"body-small",color:"content-color-primary"},t," ","项已选择")),n.a.createElement("div",{className:"history-sidebar-menu__right"},n.a.createElement("div",{className:"history-sidebar-menu__actions-delete-history-wrapper"},n.a.createElement(d.Button,{disabled:!o,className:"history-sidebar-list-item__button__delete",type:"icon",onClick:this.handleDeleteSelected,tooltip:E.ACTION_TYPE_DELETE_REQUESTS_TOOLTIP},n.a.createElement(c.Icon,{name:"icon-action-delete-stroke",size:"large",className:"history-sidebar-list-item__actions__delete pm-icon pm-icon-normal"})),n.a.createElement(y.default,{count:t,onSelect:this.handleDropdownActionSelect,onToggle:this.handleDropdownToggle,disableRequestSpecificActions:this.disableRequestItemOptions()})))):n.a.createElement("div",{className:"history-sidebar-menu"},n.a.createElement(T.default,{className:"history-sidebar__filter",onSearch:this.handleSearchChange,onActionsDropdownSelect:this.handleActionsDropdownSelect,searchQuery:this.props.historySidebar.searchQuery,moreActions:n.a.createElement(p.DropdownMenu,{className:"history-sidebar__header-actions-dropdown--menu"},!e.isEmpty(this.props.historySidebar.historyItems)&&n.a.createElement(p.MenuItem,{className:"history-sidebar__header-actions-dropdown--menu-item history-sidebar-menu__actions-delete-history-wrapper",key:"history-sidebar--clear-all",refKey:"history-sidebar--clear-all",disabled:r,disabledText:"你需要联网才能清除历史."},n.a.createElement("span",null,"全部清除")),n.a.createElement("div",{className:this.getToggleSaveResponseClasses(l),onClick:l?void 0:this.handleSaveResponseToggle,ref:e=>{this.saveResponseToggleContainerRef=e},onMouseEnter:this.showResponseToggleTooltip,onMouseLeave:this.hideResponseToggleTooltip},"保存响应",n.a.createElement(h.default,{isActive:this.props.enableHistoryResponseSaving,activeLabel:"",inactiveLabel:""}),n.a.createElement(m.Tooltip,{className:"history-sidebar-menu--save-response__tooltip",show:this.state.showResponseToggleTooltip,target:this.saveResponseToggleContainerRef},n.a.createElement(m.TooltipBody,null,l?"您没有权限来执行此操作.":"关闭时, 不会保存响应标头和正文, 但会保存响应代码、时间、大小和语言将被保存以用于报告."))))}))}})||i}.call(this,s(574))},14530:function(e,t,s){"use strict";s.r(t),s.d(t,"ACTION_TYPE_DELETE_REQUEST_TOOLTIP",(function(){return i})),s.d(t,"ACTION_TYPE_DELETE_REQUESTS_TOOLTIP",(function(){return o})),s.d(t,"ACTION_TYPE_SAVE_REQUEST_TOOLTIP",(function(){return n})),s.d(t,"ACTION_TYPE_SAVE_REQUESTS_TOOLTIP",(function(){return r}));const i="删除请求",o="删除项目",n="将请求添加到集合",r="将请求添加到集合"},14531:function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return y}));var i,o=s(2),n=s.n(o),r=s(2357),l=s.n(r),a=s(2353),c=s(9),d=s(2844),h=s(2373),p=s(3833),m=s(14528),u=s(3697),S=s(3123),g=s(1662),b=s(3646),T=s(3631);const E="不适用于集合运行项目";let y=Object(a.observer)(i=class extends o.Component{constructor(e){super(e),this.handleSelect=this.handleSelect.bind(this),this.handleShortcutSelect=this.handleShortcutSelect.bind(this),this.handleToggle=this.handleToggle.bind(this)}getKeymapHandlers(){return{delete:pm.shortcuts.handle("delete",this.handleShortcutSelect.bind(this,m.ACTION_TYPE_DELETE))}}handleShortcutSelect(e){pm.mediator.trigger("focusSidebar"),this.handleSelect(e)}handleSelect(e){this.props.onSelect&&this.props.onSelect(e),this.handleToggle(!1)}handleToggle(e){this.props.onToggle&&this.props.onToggle(e)}getDropDownActionWrapperClasses(){return l()({"collection-sidebar-request-dropdown-actions-wrapper":!0})}getDisabledText(e){if(e)return Object(g.getStore)("OnlineStatusStore").userCanSave?S.DISABLED_TOOLTIP_NO_PERMISSION:S.DISABLED_TOOLTIP_IS_OFFLINE}render(){const e=p.default.pluralize({count:this.props.count,singular:"请求",plural:"请求"}),t=Object(g.getStore)("PermissionStore"),{userCanSave:s}=Object(g.getStore)("OnlineStatusStore"),i=s&&t.can("delete","history");return n.a.createElement("div",{className:this.getDropDownActionWrapperClasses()},n.a.createElement(d.Dropdown,{keyMapHandlers:this.getKeymapHandlers(),ref:"menu",onSelect:this.handleSelect,onToggle:this.handleToggle,className:"collection-sidebar-request-actions-dropdown history-sidebar-multiple-request-selected-dropdown"},n.a.createElement(d.DropdownButton,{dropdownStyle:"nocaret",type:"custom"},n.a.createElement(h.Button,{className:"history-sidebar-list-item__button__options",tooltip:b.ACTION_TYPE_VIEW_MORE_ACTIONS_TOOLTIP}," ",n.a.createElement(c.Icon,{name:"icon-action-options-stroke",className:"history-sidebar-list-item__actions__options pm-icon pm-icon-normal"}))),n.a.createElement(d.DropdownMenu,{"align-right":!0},n.a.createElement(d.MenuItem,{refKey:m.ACTION_TYPE_SAVE,disabled:!s||this.props.disableRequestSpecificActions,disabledText:s?E:S.DISABLED_TOOLTIP_IS_OFFLINE},n.a.createElement("div",{className:"dropdown-menu-item-label"},`保存${e}`)),n.a.createElement(d.MenuItem,{refKey:m.ACTION_TYPE_MONITOR,disabled:!s||this.props.disableRequestSpecificActions,disabledText:s?this.props.disableRequestSpecificActions?E:u.DISABLED_IN_SCRATCHPAD_TOOLTIP:S.DISABLED_TOOLTIP_IS_OFFLINE},n.a.createElement("div",{className:"dropdown-menu-item-label"},`监视${e}`)),n.a.createElement(d.MenuItem,{refKey:m.ACTION_TYPE_DOCUMENT,disabled:!s||this.props.disableRequestSpecificActions,disabledText:s?this.props.disableRequestSpecificActions?E:u.DISABLED_IN_SCRATCHPAD_TOOLTIP:S.DISABLED_TOOLTIP_IS_OFFLINE},n.a.createElement("div",{className:"dropdown-menu-item-label"},`${e}文档`)),n.a.createElement(d.MenuItem,{refKey:m.ACTION_TYPE_MOCK,disabled:!s||this.props.disableRequestSpecificActions,disabledText:s?this.props.disableRequestSpecificActions?E:u.DISABLED_IN_SCRATCHPAD_TOOLTIP:S.DISABLED_TOOLTIP_IS_OFFLINE},n.a.createElement("div",{className:"dropdown-menu-item-label"},`模拟${e}`)),"browser"!==window.SDK_PLATFORM&&n.a.createElement(d.MenuItem,{refKey:m.ACTION_TYPE_DOWNLOAD,disabled:!s||!this.props.disableRequestSpecificActions,disabledText:s?"您只能导出集合运行":S.DISABLED_TOOLTIP_IS_OFFLINE},n.a.createElement("div",{className:"dropdown-menu-item-label"},"导出")),n.a.createElement(d.MenuItem,{refKey:m.ACTION_TYPE_DELETE,disabled:!i,disabledText:this.getDisabledText(!i)},n.a.createElement("div",{className:"dropdown-menu-item-label"},"删除"),n.a.createElement("div",{className:"dropdown-menu-item-shortcut"},Object(T.getShortcutByName)("delete"))))))}})||i},14532:function(e,t,s){"use strict";s.r(t),function(e){s.d(t,"default",(function(){return I}));var i,o=s(2),n=s.n(o),r=s(2353),l=s(2830),a=s(4459),c=s(9),d=s(2373),h=s(3833),p=s(1662),m=s(14533),u=s(14534),S=s(14492),g=s(14535),b=s(14536),T=s(14537),E=s(14538),y=s(14539),O=s(5156);function _(){return _=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e},_.apply(this,arguments)}let I=Object(r.observer)(i=class extends o.Component{constructor(t){super(t),this.store=Object(p.getStore)("HistorySidebarStore"),this.requesterSidebarStore=Object(p.getStore)("RequesterSidebarStore"),this.handleToggleGroup=this.handleToggleGroup.bind(this),this.getListItem=this.getListItem.bind(this),this.getItemSize=this.getItemSize.bind(this),this.handleClearCachedHeight=this.handleClearCachedHeight.bind(this),this.observeSizeChange=this.observeSizeChange.bind(this),this.unobserveSizeChange=this.unobserveSizeChange.bind(this),this.handleItemsRender=this.handleItemsRender.bind(this),this.handleItemsRenderDebounced=e.debounce(this.handleItemsRender,1e3),this.handleListScroll=this.handleListScroll.bind(this),this.handleListScrollDebounced=e.debounce(this.handleListScroll,300),this.handleJumpToTop=this.handleJumpToTop.bind(this),this.handleRefresh=this.handleRefresh.bind(this),this.heightSet={},this.resizeObserver=new ResizeObserver((e=>{for(const t of e){if(!(t&&t.target&&t.target.dataset))return;const{index:e}=t.target.dataset;this.heightSet[e]=t.target.offsetHeight}this.handleClearCachedHeight(0)}))}componentDidMount(){this.props.initializing||this.store.load()}componentDidUpdate(e){this.props.initializing||(e.initializing?this.store.load():(this.props.workspace!==e.workspace||this.props.isLoggedIn&&!e.isLoggedIn)&&(this.store.load(),this.listRef&&this.listRef.scrollTo(0),this.store.setScrollOffset(0)))}observeSizeChange(e){this.resizeObserver&&this.resizeObserver.observe(e)}unobserveSizeChange(e,t){this.resizeObserver&&this.resizeObserver.unobserve(e),delete this.heightSet[t]}handleClearCachedHeight(e){this.listRef.resetAfterIndex(e)}handleToggleGroup(e){if(this.store.isItemCollapsed(e))return this.store.expandItem(e);this.store.collapseItem(e)}getItemSize(t){const s=e.get(this.store,["historyItems",t]);return"meta"===s.type||"error"===s.type?28:this.heightSet[t]||28}getListItem(t){const s=e.get(this.store,["historyItems",t.index]);return s?"error"===s.type?n.a.createElement("div",{className:"history-list__error",style:t.style},n.a.createElement(T.default,{key:s.name,onRetry:()=>"load-error"===s.key?this.store.load(!0):"load-more-error"===s.key?this.store.loadMore():void 0})):"meta"===s.type?n.a.createElement("div",{className:"history-list__meta",style:t.style},n.a.createElement(b.default,{name:s.name,key:s.name,onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction.bind(this,"all"),items:s.items,disableRequestSpecificActions:s.disableRequestSpecificActions})):"collectionrun"===s.type?n.a.createElement("div",{className:"history-list__collection-run",style:t.style},n.a.createElement(E.default,_({},s,{name:s.name,hideActions:e.size(this.store.getSelectedItems())>1,key:s.id,selected:this.store.isItemSelected(s.id),onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction.bind(this,"collectionrun"),observeSizeChange:this.observeSizeChange,unobserveSizeChange:this.unobserveSizeChange,index:t.index}))):"websockethistory"===s.type?n.a.createElement("div",{className:"history-list__websocket",style:t.style},n.a.createElement(u.default,_({},s,{key:s.id,isSelected:this.store.isItemSelected(s.id),onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction.bind(this,"websockethistory"),observeSizeChange:this.observeSizeChange,unobserveSizeChange:this.unobserveSizeChange,index:t.index}))):n.a.createElement("div",{className:"history-list__item",style:t.style},n.a.createElement(g.default,_({},s,{hideActions:e.size(this.store.getSelectedItems())>1,key:s.id,selected:this.store.isItemSelected(s.id),onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction.bind(this,"request"),observeSizeChange:this.observeSizeChange,unobserveSizeChange:this.unobserveSizeChange,viewLargeBody:this.props.viewLargeBody,index:t.index}))):null}getNotification(){return this.store.showReloadNotification?n.a.createElement("div",{className:"history-sidebar-list__notification"},n.a.createElement(d.Button,{type:"primary",size:"small",className:"history-sidebar-list__refresh",onClick:this.handleRefresh},n.a.createElement(c.Icon,{name:"icon-action-refresh-stroke",color:"content-color-primary",size:"small",className:"pm-icon"}),"刷新")):this.store.newHistoryIds.size?n.a.createElement("div",{className:"history-sidebar-list__notification"},n.a.createElement(d.Button,{type:"primary",size:"small",className:"history-sidebar-list__more-on-top",onClick:this.handleJumpToTop},n.a.createElement(c.Icon,{name:"icon-direction-up",color:"content-color-primary",size:"small",className:"pm-icon"}),n.a.createElement("span",null,this.store.newHistoryIds.size," ","new"," ",h.default.pluralize({count:this.store.newHistoryIds.size,singular:"item",plural:"items"})))):null}handleListScroll({scrollOffset:e}){0===e&&this.store.newHistoryIds.size&&this.store.showNewHistory(),this.store.setScrollOffset(e)}handleItemsRender(e){this.store.scrolledToEnd||this.store.loadingMore||this.requesterSidebarStore.query||e.overscanStopIndex===e.visibleStopIndex&&this.store.loadMore()}handleJumpToTop(){this.listRef&&this.listRef.scrollTo(0)}handleRefresh(){this.listRef&&this.listRef.scrollTo(0),this.store.load(!0)}render(){const t=e=>n.a.createElement(r.Observer,null,this.getListItem.bind(this,e)),s=({height:e,width:s})=>n.a.createElement(r.Observer,null,(()=>n.a.createElement(l.VariableSizeList,{height:e,itemCount:this.store.historyItems.length,itemSize:this.getItemSize,width:s,ref:e=>{this.listRef=e},overscanCount:10,onItemsRendered:this.handleItemsRenderDebounced,onScroll:this.handleListScrollDebounced},t)));return e.isEmpty(this.store.historyItems)?this.props.initializing||this.store.loading?n.a.createElement("div",{className:"history-sidebar-list"},n.a.createElement(O.default,{hasHierarchy:!0})):this.store.loadError?"您没有权限查看历史在这个工作区"===this.store.loadError.message?n.a.createElement("div",{className:"history-sidebar-list-permission-error"},n.a.createElement(S.default,{illustration:n.a.createElement(c.IllustrationNoPermission,null),title:"您没有权限查看历史",message:"只有团队成员才能查看此工作区的历史"})):n.a.createElement("div",{className:"history-sidebar-list"},n.a.createElement(y.default,{onRetry:()=>this.store.load(!0)})):n.a.createElement("div",{className:"history-sidebar-list"},n.a.createElement(m.default,{query:this.store.searchQuery})):n.a.createElement("div",{className:"history-sidebar-list",ref:"history"},this.getNotification(),n.a.createElement(a.default,null,s))}})||i}.call(this,s(574))},14533:function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return p}));var i,o=s(2),n=s.n(o),r=s(2353),l=s(9),a=s(3128),c=s(1872),d=s(14492),h=s(14493);let p=Object(r.observer)(i=class extends o.Component{constructor(e){super(e),this.handleShowMeHow=this.handleShowMeHow.bind(this)}handleShowMeHow(){Object(c.openExternalLink)(a.SEND_FIRST_REQUEST_DOCS,"_blank")}render(){return this.props.query?n.a.createElement(h.default,{searchQuery:this.props.query,illustration:n.a.createElement(l.IllustrationNoHistory,null)}):n.a.createElement(d.default,{illustration:n.a.createElement(l.IllustrationNoHistory,null),title:"您尚未发送任何请求.",message:"您在此工作区中发送的任何请求都将显示在此处.",action:{label:"告诉我怎么做",handler:this.handleShowMeHow}})}})||i},14534:function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return E}));var i,o=s(2),n=s.n(o),r=s(5),l=s(3133),a=s.n(l),c=s(2357),d=s.n(c),h=s(9),p=s(2353),m=s(3134),u=s(2374),S=s(14522),g=s(1662),b=s(14528),T=s(3123);let E=Object(p.observer)(i=class extends o.Component{constructor(e){super(e),this.state={isTooltipVisible:!1},this.userAvatar=n.a.createRef(),this.handleSelect=this.handleSelect.bind(this),this.handleAction=this.handleAction.bind(this),this.handleDelete=this.handleDelete.bind(this),this.showTooltip=this.showTooltip.bind(this),this.hideTooltip=this.hideTooltip.bind(this),this.getLeftAlignedComponents=this.getLeftAlignedComponents.bind(this),this.getRightAlignedComponents=this.getRightAlignedComponents.bind(this)}componentDidMount(){this.selfNode=Object(r.findDOMNode)(this),this.props.observeSizeChange&&this.props.observeSizeChange(this.selfNode)}componentWillUpdate(e){if(!this.props.selected&&e.selected){const e=Object(r.findDOMNode)(this);e&&e.scrollIntoViewIfNeeded&&e.scrollIntoViewIfNeeded()}}componentWillUnmount(){this.props.unobserveSizeChange&&this.props.unobserveSizeChange(this.selfNode,this.props.index)}getClasses(){return d()({"history-sidebar-list-item":!0,"history-sidebar-list-item__websocket-history":!0,"is-selected":this.props.selected})}getTooltipText(e,t){return e?t?T.DISABLED_TOOLTIP_IS_OFFLINE:T.DISABLED_TOOLTIP_NO_PERMISSION:"删除历史"}getLeftAlignedComponents(e){if(!e)return n.a.createElement("div",{className:"history-sidebar__indent"});const t=d()({"history-sidebar-list-item-updatedBy":!0,hovered:e}),s=Object(g.getStore)("CurrentUserStore").teamMembers.get(String(this.props.owner)),i=s&&(s.name||s.username);return n.a.createElement("div",{className:t,onMouseOver:this.showTooltip,onMouseLeave:this.hideTooltip},this.props.owner&&"0"!==this.props.owner?n.a.createElement(m.default,{ref:this.userAvatar,size:"small",userId:this.props.owner}):n.a.createElement(h.Icon,{name:"icon-descriptive-user-stroke",color:"content-color-secondary"}),this.userAvatar.current&&n.a.createElement(u.Tooltip,{immediate:!0,show:this.state.isTooltipVisible,target:this.userAvatar.current,placement:"right"},n.a.createElement(u.TooltipBody,null,n.a.createElement("div",{className:"history-sidebar-list-item-avatar-tooltip"},n.a.createElement(h.Text,{type:"body-medium"},i),n.a.createElement(h.Text,{type:"body-medium"},a()(this.props.createdAt).format("DD MMM YYYY, h:mm A"))))))}getRightAlignedComponents(e){const t=d()({"sidebar-list-item__right-section-actions":!0,hovered:e});if(!e)return null;const s=Object(g.getStore)("PermissionStore"),{userCanSave:i}=Object(g.getStore)("OnlineStatusStore"),o=i&&s.can("delete","history");return n.a.createElement("div",{className:t},n.a.createElement(h.Button,{type:"tertiary",icon:"icon-action-delete-stroke",onClick:this.handleDelete,isDisabled:!o,tooltip:this.getTooltipText(!o,!i)}))}showTooltip(){this.setState({isTooltipVisible:!0})}hideTooltip(){this.setState({isTooltipVisible:!1})}handleSelect(e){e.stopPropagation();const t={ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};this.props.onSelect&&this.props.onSelect({id:this.props.id,type:"websockethistory"},t)}handleAction(e){this.props.onSelectAction(e,{websockethistory:[this.props.id]})}handleDelete(e){e.stopPropagation(),this.handleAction(b.ACTION_TYPE_DELETE)}render(){return n.a.createElement("div",{"data-index":this.props.index},n.a.createElement(S.default,{text:this.props.url,icon:"icon-entity-websocket-stroke",isSelected:this.props.isSelected,onClick:this.handleSelect,className:this.getClasses(),leftMetaComponent:this.getLeftAlignedComponents,rightMetaComponent:this.getRightAlignedComponents}))}})||i},14535:function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return A}));var i,o=s(2),n=s.n(o),r=s(5),l=s(2357),a=s.n(l),c=s(3133),d=s.n(c),h=s(2353),p=s(9),m=s(2373),u=s(2844),S=s(3134),g=s(2374),b=s(14522),T=s(14528),E=s(3123),y=s(3697),O=s(1662),_=s(14530),I=s(5169),f=s(3631);let A=Object(h.observer)(i=class extends o.Component{constructor(e){super(e),this.state={dropdownOpen:!1,isTooltipVisible:!1},this.userAvatar=n.a.createRef(),this.handleSelect=this.handleSelect.bind(this),this.handleDropdownToggle=this.handleDropdownToggle.bind(this),this.handleDropdownActionSelect=this.handleDropdownActionSelect.bind(this),this.handleAddRequestToCollectionClick=this.handleAddRequestToCollectionClick.bind(this),this.handleRemoveRequest=this.handleRemoveRequest.bind(this),this.showTooltip=this.showTooltip.bind(this),this.hideTooltip=this.hideTooltip.bind(this),this.getLeftAlignedComponents=this.getLeftAlignedComponents.bind(this),this.getRightAlignedComponents=this.getRightAlignedComponents.bind(this)}componentDidMount(){this.selfNode=Object(r.findDOMNode)(this),this.props.observeSizeChange&&this.props.observeSizeChange(this.selfNode)}componentWillUnmount(){this.props.unobserveSizeChange&&this.props.unobserveSizeChange(this.selfNode,this.props.index)}componentWillUpdate(e){if(!this.props.selected&&e.selected){const e=Object(r.findDOMNode)(this);if(!e)return;e.scrollIntoViewIfNeeded?e.scrollIntoViewIfNeeded():e.scrollIntoView()}}showTooltip(){this.setState({isTooltipVisible:!0})}hideTooltip(){this.setState({isTooltipVisible:!1})}handleSelect(e){e.stopPropagation();const t={ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};this.props.onSelect&&this.props.onSelect({id:this.props.id,type:"request"},t)}getClasses(){return a()({"history-sidebar-list-item":!0,"history-sidebar-list-item__request":!0,"is-hovered":this.state.dropdownOpen,"is-selected":this.props.selected})}handleDropdownToggle(e){e!==this.state.dropdownOpen&&this.setState({dropdownOpen:e})}handleDropdownActionSelect(e){this.props.onSelectAction(e,{requests:[this.props.id],from:"history_single"})}handleAddRequestToCollectionClick(e){e.stopPropagation(),this.handleDropdownActionSelect(T.ACTION_TYPE_SAVE,{from:"history_single"})}handleRemoveRequest(e){e.stopPropagation(),this.handleDropdownActionSelect(T.ACTION_TYPE_DELETE)}getTooltipText(e,t){return e?t?E.DISABLED_TOOLTIP_IS_OFFLINE:E.DISABLED_TOOLTIP_NO_PERMISSION:_.ACTION_TYPE_DELETE_REQUEST_TOOLTIP}getDisabledText(e,t){if(e)return t?E.DISABLED_TOOLTIP_IS_OFFLINE:E.DISABLED_TOOLTIP_NO_PERMISSION}getLeftAlignedComponents(e,t){const s=a()({"history-sidebar-list-item-updatedBy":!0,hovered:e});if(!e&&!t)return n.a.createElement("div",{className:"history-sidebar__indent"});const i=Object(O.getStore)("CurrentUserStore").teamMembers.get(this.props.lastUpdatedBy),o=i&&(i.name||i.username);return n.a.createElement("div",{className:s,onMouseEnter:this.showTooltip,onMouseLeave:this.hideTooltip},this.props.lastUpdatedBy&&"0"!==this.props.lastUpdatedBy?n.a.createElement(S.default,{ref:this.userAvatar,size:"small",userId:this.props.lastUpdatedBy}):n.a.createElement(p.Icon,{name:"icon-descriptive-user-stroke",className:"pm-icon pm-icon-normal"}),this.userAvatar.current&&n.a.createElement(g.Tooltip,{immediate:!0,show:this.state.isTooltipVisible,target:this.userAvatar.current,placement:"right"},n.a.createElement(g.TooltipBody,null,n.a.createElement("div",null,n.a.createElement("div",null,o),n.a.createElement("div",null,d()(this.props.createdAt).format("DD MMM YYYY, h:mm A"))))))}getRightAlignedComponents(e,t){const s=a()({"sidebar-list-item__right-section-actions":!0,hovered:e});if(!e&&!t)return null;const i=Object(O.getStore)("PermissionStore"),{userCanSave:o}=Object(O.getStore)("OnlineStatusStore"),r=o&&i.can("delete","history",this.props.id);return n.a.createElement("div",{className:s},n.a.createElement(m.Button,{className:"history-sidebar-list-item__button__add",type:"icon",onClick:this.handleAddRequestToCollectionClick,disabled:!o,tooltip:o?_.ACTION_TYPE_SAVE_REQUEST_TOOLTIP:E.DISABLED_TOOLTIP_IS_OFFLINE},n.a.createElement(p.Icon,{size:"large",name:"icon-action-add-stroke",className:"history-sidebar-list-item__actions__add pm-icon pm-icon-normal"})),n.a.createElement(m.Button,{className:"history-sidebar-list-item__button__delete",type:"icon",onClick:this.handleRemoveRequest,disabled:!r,tooltip:this.getTooltipText(!r,!o)},n.a.createElement(p.Icon,{name:"icon-action-delete-stroke",size:"large",className:"history-sidebar-list-item__actions__delete pm-icon pm-icon-normal"})))}getActionsMenuItems(e){const{userCanSave:t,userCanSaveAndSync:s}=Object(O.getStore)("OnlineStatusStore");return n.a.createElement(u.DropdownMenu,{"align-right":!0},n.a.createElement(u.MenuItem,{refKey:T.ACTION_TYPE_SAVE,disabled:!t,disabledText:E.DISABLED_TOOLTIP_IS_OFFLINE},n.a.createElement("div",{className:"dropdown-menu-item-label"},"保存请求")),n.a.createElement(u.MenuItem,{refKey:T.ACTION_TYPE_MONITOR,disabled:!s,disabledText:t?y.DISABLED_IN_SCRATCHPAD_TOOLTIP:E.DISABLED_TOOLTIP_IS_OFFLINE},n.a.createElement("div",{className:"dropdown-menu-item-label"},"监视请求")),n.a.createElement(u.MenuItem,{refKey:T.ACTION_TYPE_DOCUMENT,disabled:!s,disabledText:t?y.DISABLED_IN_SCRATCHPAD_TOOLTIP:E.DISABLED_TOOLTIP_IS_OFFLINE},n.a.createElement("div",{className:"dropdown-menu-item-label"},"请求文档")),n.a.createElement(u.MenuItem,{refKey:T.ACTION_TYPE_MOCK,disabled:!s,disabledText:t?y.DISABLED_IN_SCRATCHPAD_TOOLTIP:E.DISABLED_TOOLTIP_IS_OFFLINE},n.a.createElement("div",{className:"dropdown-menu-item-label"},"模拟请求")),n.a.createElement(u.MenuItem,{refKey:T.ACTION_TYPE_DELETE,disabled:!t||!e,disabledText:this.getDisabledText(!e,!t)},n.a.createElement("div",{className:"dropdown-menu-item-label"},"删除"),n.a.createElement("div",{className:"dropdown-menu-item-shortcut"},Object(f.getShortcutByName)("delete"))))}render(){const e=Object(O.getStore)("PermissionStore").can("delete","history",this.props.id);return n.a.createElement(b.default,{"data-index":this.props.index,text:this.props.url,onClick:this.handleSelect,isSelected:this.props.selected,icon:n.a.createElement(I.default,{method:this.props.method||"GET"}),className:this.getClasses(),moreActions:this.getActionsMenuItems(e),rightMetaComponent:this.getRightAlignedComponents,leftMetaComponent:this.getLeftAlignedComponents,onActionsDropdownSelect:this.handleDropdownActionSelect})}})||i},14536:function(e,t,s){"use strict";s.r(t),function(e){s.d(t,"default",(function(){return u}));var i=s(2),o=s.n(i),n=s(2357),r=s.n(n),l=s(9),a=s(2373),c=s(14528),d=s(3123),h=s(1662),p=s(14530),m=s(14531);class u extends i.PureComponent{constructor(e){super(e),this.state={dropdownOpen:!1,isHovered:!1},this.store=Object(h.getStore)("HistorySidebarStore"),this.handleToggleGroup=this.handleToggleGroup.bind(this),this.handleDropdownToggle=this.handleDropdownToggle.bind(this),this.handleDropdownActionSelect=this.handleDropdownActionSelect.bind(this),this.handleAddRequestToCollectionClick=this.handleAddRequestToCollectionClick.bind(this),this.handleRemoveRequest=this.handleRemoveRequest.bind(this),this.handleMouseEnter=this.handleMouseEnter.bind(this),this.handleMouseLeave=this.handleMouseLeave.bind(this)}handleMouseEnter(){this.setState({isHovered:!0})}handleMouseLeave(){!this.state.dropdownOpen&&this.setState({isHovered:!1})}getCollapseButtonClasses(){return r()({caret:!0,"pm-icon":!0,"pm-icon-normal":!0,"is-closed":this.store.isItemCollapsed(this.props.name)})}getMetaClasses(){return r()({"history-sidebar-list-item-group__meta":!0,"is-hovered":this.state.dropdownOpen})}handleToggleGroup(){const{name:e}=this.props;if(this.store.isItemCollapsed(e))return this.store.expandItem(e);this.store.collapseItem(e)}handleDropdownToggle(e){e!==this.state.dropdownOpen&&this.setState({dropdownOpen:e})}handleDropdownActionSelect(t){const s={requests:e.reduce(this.props.items,((e,t)=>("request"===t.type&&e.push(t.id),e)),[]),runs:e.reduce(this.props.items,((e,t)=>("collectionrun"===t.type&&e.push(t.id),e)),[]),websockethistory:e.reduce(this.props.items,((e,t)=>("websockethistory"===t.type&&e.push(t.id),e)),[]),defaultCollectionName:this.props.name,from:"history_date_group"};t!==c.ACTION_TYPE_DELETE?this.props.onSelectAction(t,s):pm.mediator.trigger("showDeleteHistoryModal",(()=>{this.props.onSelectAction(t,s)}),{identifier:"selected"})}handleAddRequestToCollectionClick(e){e.stopPropagation(),this.handleDropdownActionSelect(c.ACTION_TYPE_SAVE)}handleRemoveRequest(e){e.stopPropagation(),this.handleDropdownActionSelect(c.ACTION_TYPE_DELETE)}render(){const t=e.size(this.store.getSelectedItems())>1,{userCanSave:s}=Object(h.getStore)("OnlineStatusStore");return o.a.createElement("div",{className:"history-sidebar-list-item-group",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},o.a.createElement("div",{className:this.getMetaClasses(),onClick:this.handleToggleGroup},o.a.createElement("div",{className:"history-sidebar-list-item-group__name"},o.a.createElement(l.Icon,{name:"icon-direction-down",className:this.getCollapseButtonClasses()}),o.a.createElement("span",null,this.props.name)),!t&&this.state.isHovered&&o.a.createElement("div",{className:"history-sidebar-list-item-group__actions"},o.a.createElement(a.Button,{className:"history-sidebar-list-item__button__add",type:"icon",disabled:!s||this.props.disableRequestSpecificActions,onClick:this.handleAddRequestToCollectionClick,tooltip:s?this.props.disableRequestSpecificActions?"不适用于集合运行项目":p.ACTION_TYPE_SAVE_REQUESTS_TOOLTIP:d.DISABLED_TOOLTIP_IS_OFFLINE},o.a.createElement(l.Icon,{name:"icon-action-add-stroke",className:"history-sidebar-list-item__actions__add pm-icon pm-icon-normal"})),o.a.createElement(a.Button,{className:"history-sidebar-list-item__button__delete",type:"icon",onClick:this.handleRemoveRequest,disabled:!s,tooltip:s?p.ACTION_TYPE_DELETE_REQUESTS_TOOLTIP:d.DISABLED_TOOLTIP_IS_OFFLINE},o.a.createElement(l.Icon,{name:"icon-action-delete-stroke",className:"history-sidebar-list-item__actions__delete pm-icon pm-icon-normal"})),o.a.createElement(m.default,{count:e.size(this.props.items),onSelect:this.handleDropdownActionSelect,onToggle:this.handleDropdownToggle,disableRequestSpecificActions:this.props.disableRequestSpecificActions}))))}}}.call(this,s(574))},14537:function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return n}));var i=s(2),o=s.n(i);function n(e){return o.a.createElement("div",{className:"history-sidebar-list-item-group"},o.a.createElement("div",{className:"history-sidebar-list-item-group__error"},"无法加载项."," ",o.a.createElement("span",{onClick:e.onRetry},"重试")))}},14538:function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return y}));var i,o=s(2),n=s.n(o),r=s(5),l=s(2357),a=s.n(l),c=s(9),d=s(3133),h=s.n(d),p=s(2353),m=s(2373),u=s(3134),S=s(2374),g=s(14528),b=s(3123),T=s(1662),E=s(14522);let y=Object(p.observer)(i=class extends o.Component{constructor(e){super(e),this.state={dropdownOpen:!1,isTooltipVisible:!1},this.userAvatar=n.a.createRef(),this.handleSelect=this.handleSelect.bind(this),this.handleDropdownToggle=this.handleDropdownToggle.bind(this),this.handleDropdownActionSelect=this.handleDropdownActionSelect.bind(this),this.handleRemoveRun=this.handleRemoveRun.bind(this),this.showTooltip=this.showTooltip.bind(this),this.hideTooltip=this.hideTooltip.bind(this),this.getRightAlignedComponents=this.getRightAlignedComponents.bind(this),this.getLeftAlignedComponents=this.getLeftAlignedComponents.bind(this)}componentDidMount(){this.selfNode=Object(r.findDOMNode)(this),this.props.observeSizeChange&&this.props.observeSizeChange(this.selfNode)}componentWillUnmount(){this.props.unobserveSizeChange&&this.props.unobserveSizeChange(this.selfNode,this.props.index)}componentWillUpdate(e){if(!this.props.selected&&e.selected){const e=Object(r.findDOMNode)(this);e&&e.scrollIntoViewIfNeeded&&e.scrollIntoViewIfNeeded()}}showTooltip(){this.setState({isTooltipVisible:!0})}hideTooltip(){this.setState({isTooltipVisible:!1})}handleSelect(e){e.stopPropagation();const t={ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};this.props.onSelect&&this.props.onSelect({id:this.props.id,type:"collectionrun"},t)}getClasses(){return a()({"history-sidebar-list-item":!0,"history-sidebar-list-item__collection":!0,"is-hovered":this.state.dropdownOpen,"is-selected":this.props.selected})}handleDropdownToggle(e){e!==this.state.dropdownOpen&&this.setState({dropdownOpen:e})}handleDropdownActionSelect(e){this.props.onSelectAction(e,{runs:[this.props.id]})}handleRemoveRun(e){e.stopPropagation(),this.handleDropdownActionSelect(g.ACTION_TYPE_DELETE)}getTooltipText(e){return e?Object(T.getStore)("OnlineStatusStore").userCanSave?b.DISABLED_TOOLTIP_NO_PERMISSION:b.DISABLED_TOOLTIP_IS_OFFLINE:"删除集合运行"}getLeftAlignedComponents(e,t){const s=a()({"history-sidebar-list-item-updatedBy":!0,hovered:e});if(!e&&!t)return n.a.createElement("div",{className:"history-sidebar__indent"});const i=Object(T.getStore)("CurrentUserStore").teamMembers.get(this.props.owner),o=i&&(i.name||i.username);return n.a.createElement("div",{className:s,onMouseEnter:this.showTooltip,onMouseLeave:this.hideTooltip},this.props.owner&&"0"!==this.props.owner?n.a.createElement(u.default,{ref:this.userAvatar,size:"small",userId:this.props.owner}):n.a.createElement(c.Icon,{name:"icon-descriptive-user-stroke",className:"pm-icon pm-icon-normal"}),this.userAvatar.current&&n.a.createElement(S.Tooltip,{immediate:!0,show:this.state.isTooltipVisible,target:this.userAvatar.current,placement:"right"},n.a.createElement(S.TooltipBody,null,n.a.createElement("div",null,n.a.createElement("div",null,o),n.a.createElement("div",null,h()(this.props.createdAt).format("DD MMM YYYY, h:mm A"))))))}getRightAlignedComponents(e,t){const s=a()({"sidebar-list-item__right-section-actions":!0,hovered:e});if(!e&&!t)return null;const i=Object(T.getStore)("PermissionStore"),{userCanSave:o}=Object(T.getStore)("OnlineStatusStore"),r=o&&i.can("delete","collectionrun",this.props.id);return n.a.createElement("div",{className:s},n.a.createElement(m.Button,{className:"history-sidebar-list-item__button__delete",type:"icon",onClick:this.handleRemoveRun,disabled:!r,tooltip:this.getTooltipText(!r)},n.a.createElement(c.Icon,{name:"icon-action-delete-stroke",className:"history-sidebar-list-item__actions__delete pm-icon pm-icon-normal"})))}render(){return n.a.createElement(E.default,{"data-index":this.props.index,text:this.props.name,icon:"icon-action-run-stroke",isSelected:this.props.selected,onClick:this.handleSelect,className:this.getClasses(),rightMetaComponent:this.getRightAlignedComponents,leftMetaComponent:this.getLeftAlignedComponents})}})||i},14539:function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return r}));var i=s(2),o=s.n(i),n=s(2373);function r(e){return o.a.createElement("div",{className:"history-sidebar-list-error"},o.a.createElement("h4",null,"无法加载历史"),o.a.createElement("p",null,"尝试加载历史项目时出了点问题. 检查您的互联网,然后重试."),o.a.createElement(n.Button,{type:"secondary",onClick:e.onRetry},"重试"))}},24787:function(e,t,s){"use strict";s.r(t),function(e){s.d(t,"default",(function(){return A}));var i,o=s(2),n=s.n(o),r=s(7126),l=s.n(r),a=s(2353),c=s(5929),d=s(2789),h=s(6393),p=s(24788),m=s(6892),u=s(6885),S=s(12135),g=s(24802),b=s(12679),T=s(6367),E=s(7084),y=s(6732),O=s(6729),_=s(24789),I=s(8646),f=s(9578);let A=l()(i=Object(a.observer)(i=class extends o.Component{constructor(t){super(t),this.store=Object(c.getStore)("HistorySidebarStore"),this.focus=this.focus.bind(this),this.handleLoadRequestDebounced=e.debounce(this.handleLoadRequest,100,{leading:!0}).bind(this),this.handleLoadCollectionRunDebounced=e.debounce(this.handleLoadCollectionRun,100,{leading:!0}).bind(this),this.handleLoadWebSocketHistoryDebounced=e.debounce(this.handleLoadWebSocketHistory,100,{leading:!0}).bind(this),this.handleActiveRequestChange=this.handleActiveRequestChange.bind(this),this.handleAddToCollection=this.handleAddToCollection.bind(this),this.handleDeleteMultiple=this.handleDeleteMultiple.bind(this),this.handleItemSelect=this.handleItemSelect.bind(this),this.handleSelectAction=this.handleSelectAction.bind(this),this.handleSelectHistoryAction=this.handleSelectHistoryAction.bind(this),this.handleSelectCollectionRunAction=this.handleSelectCollectionRunAction.bind(this),this.handleSelectWebSocketHistoryAction=this.handleSelectWebSocketHistoryAction.bind(this),this.handleproxyHistoryAction=this.handleproxyHistoryAction.bind(this)}UNSAFE_componentWillMount(){pm.mediator.on("activeRequestChanged",this.handleActiveRequestChange)}componentWillUnmount(){pm.mediator.off("activeRequestChanged",this.handleActiveRequestChange)}focus(){e.invoke(this,"refs.history.focus")}selectNext(){e.invoke(this,"refs.history.selectNext")}handleActiveRequestChange(e){this.store.itemExists(e)?this.store.resetSelection([e]):this.store.resetSelection()}handleClickOutside(t){if(!e.isEmpty(this.store.getSelectedItems())){const e=document.getElementsByClassName("ReactModal__Content")[0],s=document.querySelector(".history-sidebar-multiple-request-selected-dropdown");if(e&&e.contains(t.target)||s&&s.contains(t.target))return;this.store.resetSelection()}}handleLoadRequest(e,t=!1){e&&m.default.openHistoryInTab(e,{newTab:t,preview:!0})}handleLoadCollectionRun(e,t=!1){if(!e)return;const{uid:s}=Object(c.getStore)("RunnerRunStore").find(e)||{};Object(E.openRunInTab)(s,{newTab:t,preview:!t})}handleLoadWebSocketHistory(e,t=!1){e&&Object(g.openWebSocketHistoryTab)(e,{forceNew:t,preview:!t})}handleItemSelect({id:t,type:s},i={}){const o=e.includes(navigator.platform,"Mac");i.shiftKey&&(o?i.metaKey:i.ctrlKey)?("collectionrun"===s?this.handleLoadCollectionRunDebounced(t,!0):"websockethistory"===s?this.handleLoadWebSocketHistoryDebounced(t,!0):this.handleLoadRequestDebounced(t,!0),pm.mediator.trigger("focusSidebar")):i.ctrlKey||i.metaKey?this.store.isItemSelected(t)?this.store.unselectItem(t):this.store.selectItem(t):("collectionrun"===s?this.handleLoadCollectionRunDebounced(t,!1):"websockethistory"===s?this.handleLoadWebSocketHistoryDebounced(t,!1):this.handleLoadRequestDebounced(t,!1),pm.mediator.trigger("focusSidebar"),this.store.resetSelection([t]))}handleAddToCollection(t={}){const{requests:s}=t,i=e.isEmpty(s)?this.store.getSelectedItems():s;e.isEmpty(i)||Object(u.convertHistoryToRequests)(i,{populateIfPartial:!0}).then((s=>{1===e.size(s)?s[0]&&pm.mediator.trigger("showAddToCollectionModal",s[0],{from:t.from}):pm.mediator.trigger("addRequestsToCollection",s,t)}))}handleToggleHistoryResponseSaving(){if(!Object(O.isWorkspaceMember)())return Object(O.canJoinWorkspace)()?pm.mediator.trigger("openUnjoinedWorkspaceModal"):Object(O.isLoggedIn)()?pm.toasts.error("您没有执行该操作所需的权限."):pm.mediator.trigger("showSignInModal",{type:"history",origin:"history_save_response"});const e=Object(c.getStore)("HistorySettingsStore"),t={enableHistoryResponseSaving:!(e&&e.enableHistoryResponseSaving)};return e.updateSettings(t)}resetHistorySelection(e){e&&e.id?this.store.resetSelection([e.id]):this.store.resetSelection()}handleDeleteMultiple(t,s){const i=Object(c.getStore)("RunnerRunStore"),o=Object(c.getStore)("ActiveWorkspacePermissionStore"),n=o&&o.permissions,r=e.get(n,T.WORKSPACE_PERMISSIONS.REMOVE_HISTORY_FROM_WORKSPACE,!0);return Object(O.isWorkspaceMember)()?Object(c.getStore)("OnlineStatusStore").userCanSave?Promise.resolve().then((()=>{"all"===t?(Object(h.default)(Object(d.createEvent)("deleteAllInWorkspace","history",Object(c.getStore)("ActiveWorkspaceStore").id)),i.deleteRun(e.map(i.values,(e=>e.id))),Object(g.deleteWebSocketHistory)(),b.default.deleteProxyHistory()):"selected"===t&&(r?Object(h.default)(Object(d.createEvent)("deleteMultiple","history",{ids:this.store.getSelectedItems()},null,null)):pm.toasts.error("您没有权限删除历史."),r?Object(c.getStore)("RunnerRunStore").deleteRun(this.store.getSelectedItems()):pm.toasts.error("您没有权限删除集合运行."),Object(g.deleteWebSocketHistory)(this.store.getSelectedItems()),b.default.deleteProxyHistory(this.store.getSelectedItems()))})).then((()=>{this.resetHistorySelection(s)})).catch((()=>{this.resetHistorySelection(s)})):Object(y.showOfflineActionDisabledToast)():Object(O.canJoinWorkspace)()?pm.mediator.trigger("openUnjoinedWorkspaceModal"):Object(O.isLoggedIn)()?pm.toasts.error("您没有执行该操作所需的权限."):pm.mediator.trigger("showSignInModal",{type:"history",origin:"history_delete_multiple"})}handleAddRequestToService(t,s){const{requests:i,defaultCollectionName:o="",from:n=""}=t,r=e.isEmpty(i)?this.store.getSelectedItems():i;e.isEmpty(r)||Object(u.convertHistoryToRequests)(r).then((t=>{if(!e.isEmpty(t)){const e={name:o,from:n};S.default.create(s,{requests:t,opts:e},null,{from:"history_sidebar"})}}))}handleSelectHistoryAction(e,t){switch(e){case _.ACTION_TYPE_SAVE:if(!Object(c.getStore)("OnlineStatusStore").userCanSave)return Object(y.showOfflineActionDisabledToast)();this.handleAddToCollection(t);break;case _.ACTION_TYPE_MONITOR:this.handleAddRequestToService(t,"openCreateNewMonitorModal");break;case _.ACTION_TYPE_DOCUMENT:this.handleAddRequestToService(t,"openCreateNewDocumentationModal");break;case _.ACTION_TYPE_MOCK:this.handleAddRequestToService(t,"openCreateNewMockModal");break;case _.ACTION_TYPE_DELETE:if(!Object(c.getStore)("OnlineStatusStore").userCanSave)return Object(y.showOfflineActionDisabledToast)();Object(h.default)(Object(d.createEvent)("deleteMultiple","history",{ids:t.requests},null,null))}}handleSelectCollectionRunAction(e,t){switch(e){case _.ACTION_TYPE_DELETE:if(!Object(c.getStore)("OnlineStatusStore").userCanSave)return Object(y.showOfflineActionDisabledToast)();Object(c.getStore)("RunnerRunStore").deleteRun(t.runs);break;case _.ACTION_TYPE_DOWNLOAD:return Object(f.exportRuns)(t.runs);default:pm.logger.warn(`HistorySidebarContainer~handleSelectCollectionRunAction: ${e} - action not handled`)}}handleSelectWebSocketHistoryAction(e,t){if(e===_.ACTION_TYPE_DELETE){if(!Object(c.getStore)("OnlineStatusStore").userCanSave)return Object(y.showOfflineActionDisabledToast)();Object(g.deleteWebSocketHistory)(t.websockethistory)}}async handleproxyHistoryAction(e,t){if(e===_.ACTION_TYPE_DELETE)try{await b.default.deleteProxyHistory(t.proxyhistory)}catch(e){pm.toasts.error("The proxy session is in progress")}}handleSelectAction(t,s,i){return Object(O.isWorkspaceMember)()?"collectionrun"===t?(1===e.size(i.runs)&&s===_.ACTION_TYPE_DELETE&&this.store.unselectItem(i.runs[0]),i.runs&&this.handleSelectCollectionRunAction(s,i)):"websockethistory"===t?(1===e.size(i.websockethistory)&&s===_.ACTION_TYPE_DELETE&&this.store.unselectItem(i.websockethistory[0]),i.websockethistory&&this.handleSelectWebSocketHistoryAction(s,i)):"request"===t?(1===e.size(i.requests)&&s===_.ACTION_TYPE_DELETE&&this.store.unselectItem(i.requests[0]),this.handleSelectHistoryAction(s,i)):"proxyhistory"===t?(1===e.size(i.proxyhistory)&&s===_.ACTION_TYPE_DELETE&&this.store.unselectItem(i.proxyhistory[0]),i.proxyhistory&&this.handleproxyHistoryAction(s,i)):void("all"===t&&(i.runs&&this.handleSelectCollectionRunAction(s,i),i.requests&&this.handleSelectHistoryAction(s,i),i.websockethistory&&this.handleSelectWebSocketHistoryAction(s,i),i.proxyhistory&&this.handleproxyHistoryAction(s,i))):Object(O.canJoinWorkspace)()?pm.mediator.trigger("openUnjoinedWorkspaceModal"):Object(O.isLoggedIn)()?pm.toasts.error("您没有执行该操作所需的权限."):pm.mediator.trigger("showSignInModal",{type:"history",origin:`history_${s}`})}render(){const{isConsistentlyOffline:e}=Object(c.getStore)("SyncStatusStore");if(e&&this.store.loading)return n.a.createElement(I.SidebarOfflineState,null);const t=Object(c.getStore)("HistorySettingsStore"),s=Object(c.getStore)("SyncStatusStore"),i=Object(c.getStore)("CurrentUserStore"),o=Object(c.getStore)("HistoryStore"),r=Object(c.getStore)("ActiveWorkspaceStore"),l=t&&t.enableHistoryResponseSaving,a=t&&t.isUpdating;return n.a.createElement(p.default,{store:this.store,enableHistoryResponseSaving:l,isHistorySettingUpdating:a,initializing:i.isHydrating||o.isHydrating||!r.id,isLoggedIn:i.isLoggedIn,isSocketConnected:s.isSocketConnected,workspace:r.id,onSelectAction:this.handleSelectAction,onDeleteMultiple:this.handleDeleteMultiple,onSelect:this.handleItemSelect,onSaveCurrentRequest:this.handleAddToCollection,onToggleHistoryResponseSaving:this.handleToggleHistoryResponseSaving,ref:"history"})}})||i)||i}.call(this,s(2753))},24788:function(e,t,s){"use strict";s.r(t),function(e){s.d(t,"default",(function(){return S}));var i,o=s(2),n=s.n(o),r=s(5),l=s(7308),a=s.n(l),c=s(2754),d=s(7321),h=s(24789),p=s(5929),m=s(24790),u=s(24793);let S=a()(i=class extends o.Component{constructor(e){super(e),this.store=Object(p.getStore)("HistorySidebarStore"),this.historyStore=Object(p.getStore)("HistoryStore"),this.focus=this.focus.bind(this),this.groupItems=this.groupItems.bind(this),this.selectNext=this.selectNext.bind(this),this.selectPrev=this.selectPrev.bind(this),this.deleteItem=this.deleteItem.bind(this),this.selectItem=this.selectItem.bind(this),this.multiselectNextItem=this.multiselectNextItem.bind(this),this.multiselectPrevItem=this.multiselectPrevItem.bind(this)}getKeyMapHandlers(){return{groupItems:pm.shortcuts.handle("groupItems",this.groupItems),nextItem:pm.shortcuts.handle("nextItem",this.selectNext),prevItem:pm.shortcuts.handle("prevItem",this.selectPrev),delete:pm.shortcuts.handle("delete",this.deleteItem),multiselectNextItem:pm.shortcuts.handle("multiselectNextItem",this.multiselectNextItem),multiselectPrevItem:pm.shortcuts.handle("multiselectPrevtItem",this.multiselectPrevItem),select:pm.shortcuts.handle("select",this.selectItem),search:pm.shortcuts.handle("search"),saveCurrentRequest:e=>{e&&e.stopPropagation(),this.props.onSaveCurrentRequest()}}}focus(){const e=Object(r.findDOMNode)(this.refs.history);e&&e.focus()}selectNext(t){t&&t.preventDefault();const s=this.store.getNextItem();s&&e.invoke(this,"props.onSelect",s)}selectPrev(t){t&&t.preventDefault();const s=this.store.getPrevItem();s&&e.invoke(this,"props.onSelect",s)}deleteItem(t){if(document.activeElement.classList.contains("history-sidebar__filter"))return;t&&t.preventDefault();const s=this.store.getPrevItem();e.invoke(this,"props.onDeleteMultiple","selected",s)}selectItem(t){t&&t.preventDefault(),e.invoke(this,"refs.list.selectItem")}multiselectNextItem(t){t&&t.preventDefault();const s=this.store.getNextItem();s&&e.invoke(this,"props.onSelect",s,{metaKey:!0})}multiselectPrevItem(t){t&&t.preventDefault();const s=this.store.getPrevItem();s&&e.invoke(this,"props.onSelect",s,{metaKey:!0})}groupItems(){this.props.onSelectAction&&this.props.onSelectAction("all",h.ACTION_TYPE_SAVE,{requests:this.store.getSelectedItems(),from:"history_multiple"})}render(){return n.a.createElement(c.default,{handlers:this.getKeyMapHandlers(),keyMap:pm.shortcuts.getShortcuts()},n.a.createElement("div",{className:"history-sidebar",ref:"history"},n.a.createElement("div",{className:"history-sidebar-wrapper"},n.a.createElement(m.default,{historySidebar:this.store,historyStore:this.historyStore,enableHistoryResponseSaving:this.props.enableHistoryResponseSaving,isHistorySettingUpdating:this.props.isHistorySettingUpdating,onDeleteMultiple:this.props.onDeleteMultiple,onSelectAction:this.props.onSelectAction.bind(this,"all"),onToggleHistoryResponseSaving:this.props.onToggleHistoryResponseSaving}),n.a.createElement(d.default,{identifier:"history"},n.a.createElement(u.default,{ref:"list",initializing:this.props.initializing,isSocketConnected:this.props.isSocketConnected,isLoggedIn:this.props.isLoggedIn,workspace:this.props.workspace,onDeleteMultiple:this.props.onDeleteMultiple,onLoadMore:this.props.onLoadMore,onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction})))))}})||i}.call(this,s(2753))},24789:function(e,t,s){"use strict";s.r(t),s.d(t,"ACTION_TYPE_SAVE",(function(){return i})),s.d(t,"ACTION_TYPE_MONITOR",(function(){return o})),s.d(t,"ACTION_TYPE_DOCUMENT",(function(){return n})),s.d(t,"ACTION_TYPE_MOCK",(function(){return r})),s.d(t,"ACTION_TYPE_DELETE",(function(){return l})),s.d(t,"ACTION_TYPE_DOWNLOAD",(function(){return a}));const i="save",o="monitor",n="document",r="mock",l="delete",a="download"},24790:function(e,t,s){"use strict";s.r(t),function(e){s.d(t,"default",(function(){return I}));var i,o=s(2),n=s.n(o),r=s(2825),l=s.n(r),a=s(2353),c=s(9),d=s(7124),h=s(8977),p=s(7307),m=s(7125),u=s(6732),S=s(24789),g=s(9578),b=s(5929),T=s(24586),E=s(8759),y=s(6367),O=s(24791),_=s(24792);let I=Object(a.observer)(i=class extends o.Component{constructor(e){super(e),this.state={dropdownOpen:!1,showResponseToggleTooltip:!1},this.handleDeleteClick=this.handleDeleteClick.bind(this),this.handleDropdownToggle=this.handleDropdownToggle.bind(this),this.handleDropdownActionSelect=this.handleDropdownActionSelect.bind(this),this.handleAddToCollectionClick=this.handleAddToCollectionClick.bind(this),this.handleDeleteSelected=this.handleDeleteSelected.bind(this),this.handleSearchChange=this.handleSearchChange.bind(this),this.handleActionsDropdownSelect=this.handleActionsDropdownSelect.bind(this),this.handleSaveResponseToggle=this.handleSaveResponseToggle.bind(this),this.showResponseToggleTooltip=this.showResponseToggleTooltip.bind(this),this.hideResponseToggleTooltip=this.hideResponseToggleTooltip.bind(this),this.disableRequestItemOptions=this.disableRequestItemOptions.bind(this)}handleAddToCollectionClick(e){e.stopPropagation(),this.props.onSelectAction(S.ACTION_TYPE_SAVE,{requests:this.props.historySidebar.getSelectedItems(),from:"history_multiple"})}handleDeleteClick(){pm.mediator.trigger("showDeleteHistoryModal",(async()=>{try{this.props.onDeleteMultiple&&await this.props.onDeleteMultiple("all")}catch(e){pm.logger.error("无法删除历史",e),pm.toasts.error("无法删除历史")}}),{identifier:"all"})}handleDropdownToggle(e){e!==this.state.dropdownOpen&&this.setState({dropdownOpen:e})}handleDropdownActionSelect(e){return e===S.ACTION_TYPE_DELETE?Object(b.getStore)("OnlineStatusStore").userCanSave?void pm.mediator.trigger("showDeleteHistoryModal",(()=>{this.props.onDeleteMultiple("selected")}),{identifier:"selected"}):Object(u.showOfflineActionDisabledToast)():e===S.ACTION_TYPE_DOWNLOAD?Object(g.exportRuns)(this.props.historySidebar.getSelectedItems()):void this.props.onSelectAction(e,{requests:this.props.historySidebar.getSelectedItems(),from:"history_multiple"})}handleActionsDropdownSelect(e){if("history-sidebar--clear-all"===e)this.handleDeleteClick()}handleDeleteSelected(){this.handleDropdownActionSelect(S.ACTION_TYPE_DELETE)}disableRequestItemOptions(){const t=e.filter(this.props.historySidebar.historyItems,(e=>this.props.historySidebar.selectedItems.has(e.id)&&"request"===e.type));return e.isEmpty(t)}showResponseToggleTooltip(){this.setState({showResponseToggleTooltip:!0})}hideResponseToggleTooltip(){this.setState({showResponseToggleTooltip:!1})}handleSaveResponseToggle(e){e&&e.stopPropagation(),this.props.onToggleHistoryResponseSaving&&this.props.onToggleHistoryResponseSaving()}handleSearchChange(e){this.props.historySidebar.setSearchQuery(e)}getToggleSaveResponseClasses(e){return l()({"dropdown-menu-item history-sidebar-menu__actions-save-response-toggle":!0,"is-disabled":e})}getDeleteHistoryTooltip(e,t){return e?t?O.ACTION_TYPE_DELETE_REQUESTS_TOOLTIP:E.DISABLED_TOOLTIP_NO_PERMISSION:E.DISABLED_TOOLTIP_IS_OFFLINE}render(){const t=this.props.historySidebar.selectedItems.size,{userCanSave:s}=Object(b.getStore)("OnlineStatusStore"),i=Object(b.getStore)("ActiveWorkspacePermissionStore"),o=i&&i.permissions,r=e.get(o,y.WORKSPACE_PERMISSIONS.REMOVE_HISTORY_FROM_WORKSPACE,!0),l=!s||!r,a=!e.get(o,y.WORKSPACE_PERMISSIONS.UPDATE_WORKSPACE_META,!0);return t>1?n.a.createElement("div",{className:"history-sidebar-menu multiple-request-selected"},n.a.createElement("div",{className:"history-sidebar-menu__left"},n.a.createElement(c.Text,{type:"body-small",color:"content-color-primary"},t," ","项已选择")),n.a.createElement("div",{className:"history-sidebar-menu__right"},n.a.createElement("div",{className:"history-sidebar-menu__actions-delete-history-wrapper"},n.a.createElement(d.Button,{disabled:!s||!r,className:"history-sidebar-list-item__button__delete",type:"icon",onClick:this.handleDeleteSelected,tooltip:this.getDeleteHistoryTooltip(s,r)},n.a.createElement(c.Icon,{name:"icon-action-delete-stroke",size:"large",className:"history-sidebar-list-item__actions__delete pm-icon pm-icon-normal"})),n.a.createElement(_.default,{count:t,onSelect:this.handleDropdownActionSelect,onToggle:this.handleDropdownToggle,disableRequestSpecificActions:this.disableRequestItemOptions()})))):n.a.createElement("div",{className:"history-sidebar-menu"},n.a.createElement(T.default,{className:"history-sidebar__filter",onSearch:this.handleSearchChange,onActionsDropdownSelect:this.handleActionsDropdownSelect,searchQuery:this.props.historySidebar.searchQuery,moreActions:n.a.createElement(p.DropdownMenu,{className:"history-sidebar__header-actions-dropdown--menu"},!e.isEmpty(this.props.historySidebar.historyItems)&&n.a.createElement(p.MenuItem,{className:"history-sidebar__header-actions-dropdown--menu-item history-sidebar-menu__actions-delete-history-wrapper",key:"history-sidebar--clear-all",refKey:"history-sidebar--clear-all",disabled:l,disabledText:s?E.DISABLED_TOOLTIP_NO_PERMISSION:"你需要联网才能清除历史."},n.a.createElement("span",null,"全部清除")),n.a.createElement("div",{className:this.getToggleSaveResponseClasses(a||this.props.isHistorySettingUpdating),onClick:a?void 0:this.handleSaveResponseToggle,ref:e=>{this.saveResponseToggleContainerRef=e},onMouseEnter:this.showResponseToggleTooltip,onMouseLeave:this.hideResponseToggleTooltip},this.props.isHistorySettingUpdating?this.props.enableHistoryResponseSaving?"Disabling...":"Enabling...":"保存响应",n.a.createElement(h.default,{isActive:this.props.enableHistoryResponseSaving,activeLabel:"",inactiveLabel:"",disabled:a||this.props.isHistorySettingUpdating}),n.a.createElement(m.Tooltip,{className:"history-sidebar-menu--save-response__tooltip",show:this.state.showResponseToggleTooltip,target:this.saveResponseToggleContainerRef},n.a.createElement(m.TooltipBody,null,a?"您没有权限来执行此操作.":"关闭时, 不会保存响应标头和正文, 但会保存响应代码、时间、大小和语言将被保存以用于报告."))))}))}})||i}.call(this,s(2753))},24791:function(e,t,s){"use strict";s.r(t),s.d(t,"ACTION_TYPE_DELETE_REQUEST_TOOLTIP",(function(){return i})),s.d(t,"ACTION_TYPE_DELETE_REQUESTS_TOOLTIP",(function(){return o})),s.d(t,"ACTION_TYPE_SAVE_REQUEST_TOOLTIP",(function(){return n})),s.d(t,"ACTION_TYPE_SAVE_REQUESTS_TOOLTIP",(function(){return r}));const i="删除请求",o="删除项目",n="将请求添加到集合",r="将请求添加到集合"},24792:function(e,t,s){"use strict";s.r(t),function(e){s.d(t,"default",(function(){return _}));var i,o=s(2),n=s.n(o),r=s(2825),l=s.n(r),a=s(2353),c=s(9),d=s(7307),h=s(7124),p=s(6907),m=s(24789),u=s(8959),S=s(8759),g=s(5929),b=s(8290),T=s(8908),E=s(6375),y=s(6367);const O="不适用于集合运行项目";let _=Object(a.observer)(i=class extends o.Component{constructor(e){super(e),this.handleSelect=this.handleSelect.bind(this),this.handleShortcutSelect=this.handleShortcutSelect.bind(this),this.handleToggle=this.handleToggle.bind(this)}async componentDidMount(){this.collectionList=await E.default.subscribe()}getKeymapHandlers(){return{delete:pm.shortcuts.handle("delete",this.handleShortcutSelect.bind(this,m.ACTION_TYPE_DELETE))}}handleShortcutSelect(e){pm.mediator.trigger("focusSidebar"),this.handleSelect(e)}handleSelect(e){this.props.onSelect&&this.props.onSelect(e),this.handleToggle(!1)}handleToggle(e){this.props.onToggle&&this.props.onToggle(e)}getDropDownActionWrapperClasses(){return l()({"collection-sidebar-request-dropdown-actions-wrapper":!0})}getDisabledText(e){if(e)return Object(g.getStore)("OnlineStatusStore").userCanSave?S.DISABLED_TOOLTIP_NO_PERMISSION:S.DISABLED_TOOLTIP_IS_OFFLINE}getAddRequestTooltip(e,t){return e?t?O:S.DISABLED_TOOLTIP_NO_PERMISSION:S.DISABLED_TOOLTIP_IS_OFFLINE}render(){const t=p.default.pluralize({count:this.props.count,singular:"请求",plural:"请求"}),{userCanSave:s}=Object(g.getStore)("OnlineStatusStore"),i=Object(g.getStore)("ActiveWorkspacePermissionStore"),o=i&&i.permissions,r=!e.get(o,y.WORKSPACE_PERMISSIONS.ADD_MOCK_TO_WORKSPACE,!0),l=!e.get(o,y.WORKSPACE_PERMISSIONS.ADD_MONITOR_TO_WORKSPACE,!0),a=s&&e.get(o,y.WORKSPACE_PERMISSIONS.REMOVE_HISTORY_FROM_WORKSPACE,!0),E=this.collectionList&&!e.isEmpty(this.collectionList.unsafeEditableCollections),_=e.get(o,y.WORKSPACE_PERMISSIONS.ADD_COLLECTION_TO_WORKSPACE,!0),I=E||_;return n.a.createElement("div",{className:this.getDropDownActionWrapperClasses()},n.a.createElement(d.Dropdown,{keyMapHandlers:this.getKeymapHandlers(),ref:"menu",onSelect:this.handleSelect,onToggle:this.handleToggle,className:"collection-sidebar-request-actions-dropdown history-sidebar-multiple-request-selected-dropdown"},n.a.createElement(d.DropdownButton,{dropdownStyle:"nocaret",type:"custom"},n.a.createElement(h.Button,{className:"history-sidebar-list-item__button__options",tooltip:b.ACTION_TYPE_VIEW_MORE_ACTIONS_TOOLTIP}," ",n.a.createElement(c.Icon,{name:"icon-action-options-stroke",className:"history-sidebar-list-item__actions__options pm-icon pm-icon-normal"}))),n.a.createElement(d.DropdownMenu,{"align-right":!0},n.a.createElement(d.MenuItem,{refKey:m.ACTION_TYPE_SAVE,disabled:!s||this.props.disableRequestSpecificActions||!I,disabledText:this.getAddRequestTooltip(s,I)},n.a.createElement("div",{className:"dropdown-menu-item-label"},`保存${t}`)),n.a.createElement(d.MenuItem,{refKey:m.ACTION_TYPE_MONITOR,disabled:!s||this.props.disableRequestSpecificActions||l,disabledText:s?this.props.disableRequestSpecificActions?O:S.DISABLED_TOOLTIP_WORKSPACE_VIEWER:S.DISABLED_TOOLTIP_IS_OFFLINE},n.a.createElement("div",{className:"dropdown-menu-item-label"},`监视${t}`)),n.a.createElement(d.MenuItem,{refKey:m.ACTION_TYPE_DOCUMENT,disabled:!s||this.props.disableRequestSpecificActions,disabledText:s?this.props.disableRequestSpecificActions?O:u.DISABLED_IN_SCRATCHPAD_TOOLTIP:S.DISABLED_TOOLTIP_IS_OFFLINE},n.a.createElement("div",{className:"dropdown-menu-item-label"},`${t}文档`)),n.a.createElement(d.MenuItem,{refKey:m.ACTION_TYPE_MOCK,disabled:!s||this.props.disableRequestSpecificActions||r,disabledText:s?this.props.disableRequestSpecificActions?O:S.DISABLED_TOOLTIP_WORKSPACE_VIEWER:S.DISABLED_TOOLTIP_IS_OFFLINE},n.a.createElement("div",{className:"dropdown-menu-item-label"},`模拟${t}`)),"browser"!==window.SDK_PLATFORM&&n.a.createElement(d.MenuItem,{refKey:m.ACTION_TYPE_DOWNLOAD,disabled:!s||!this.props.disableRequestSpecificActions,disabledText:s?"您只能导出集合运行":S.DISABLED_TOOLTIP_IS_OFFLINE},n.a.createElement("div",{className:"dropdown-menu-item-label"},"导出")),n.a.createElement(d.MenuItem,{refKey:m.ACTION_TYPE_DELETE,disabled:!a,disabledText:this.getDisabledText(!a)},n.a.createElement("div",{className:"dropdown-menu-item-label"},"删除"),n.a.createElement("div",{className:"dropdown-menu-item-shortcut"},Object(T.getShortcutByName)("delete"))))))}})||i}.call(this,s(2753))},24793:function(e,t,s){"use strict";s.r(t),function(e){s.d(t,"default",(function(){return f}));var i,o=s(2),n=s.n(o),r=s(2353),l=s(8276),a=s(10228),c=s(9),d=s(7124),h=s(6907),p=s(24794),m=s(5929),u=s(24795),S=s(24588),g=s(24796),b=s(24797),T=s(24798),E=s(24799),y=s(24800),O=s(11789),_=s(24801);function I(){return I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e},I.apply(this,arguments)}let f=Object(r.observer)(i=class extends o.Component{constructor(t){super(t),this.store=Object(m.getStore)("HistorySidebarStore"),this.requesterSidebarStore=Object(m.getStore)("RequesterSidebarStore"),this.handleToggleGroup=this.handleToggleGroup.bind(this),this.getListItem=this.getListItem.bind(this),this.getItemSize=this.getItemSize.bind(this),this.handleClearCachedHeight=this.handleClearCachedHeight.bind(this),this.observeSizeChange=this.observeSizeChange.bind(this),this.unobserveSizeChange=this.unobserveSizeChange.bind(this),this.handleItemsRender=this.handleItemsRender.bind(this),this.handleItemsRenderDebounced=e.debounce(this.handleItemsRender,1e3),this.handleListScroll=this.handleListScroll.bind(this),this.handleListScrollDebounced=e.debounce(this.handleListScroll,300),this.handleJumpToTop=this.handleJumpToTop.bind(this),this.handleRefresh=this.handleRefresh.bind(this),this.heightSet={},this.resizeObserver=new ResizeObserver((e=>{for(const t of e){if(!(t&&t.target&&t.target.dataset))return;const{index:e}=t.target.dataset;this.heightSet[e]=t.target.offsetHeight}this.handleClearCachedHeight(0)}))}componentDidMount(){this.props.initializing||this.store.load()}componentDidUpdate(e){this.props.initializing||(e.initializing?this.store.load():(this.props.workspace!==e.workspace||this.props.isLoggedIn&&!e.isLoggedIn)&&(this.store.load(),this.listRef&&this.listRef.scrollTo(0),this.store.setScrollOffset(0)))}observeSizeChange(e){this.resizeObserver&&this.resizeObserver.observe(e)}unobserveSizeChange(e,t){this.resizeObserver&&this.resizeObserver.unobserve(e),delete this.heightSet[t]}handleClearCachedHeight(e){this.listRef.resetAfterIndex(e)}handleToggleGroup(e){if(this.store.isItemCollapsed(e))return this.store.expandItem(e);this.store.collapseItem(e)}getItemSize(t){const s=e.get(this.store,["historyItems",t]);return"meta"===s.type||"error"===s.type?28:this.heightSet[t]||28}getListItem(t){const s=e.get(this.store,["historyItems",t.index]);return s?"error"===s.type?n.a.createElement("div",{className:"history-list__error",style:t.style},n.a.createElement(T.default,{key:s.name,onRetry:()=>"load-error"===s.key?this.store.load(!0):"load-more-error"===s.key?this.store.loadMore():void 0})):"meta"===s.type?n.a.createElement("div",{className:"history-list__meta",style:t.style},n.a.createElement(b.default,{name:s.name,key:s.name,onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction.bind(this,"all"),items:s.items,disableRequestSpecificActions:s.disableRequestSpecificActions})):"collectionrun"===s.type?n.a.createElement("div",{className:"history-list__collection-run",style:t.style},n.a.createElement(E.default,I({},s,{name:s.name,hideActions:e.size(this.store.getSelectedItems())>1,key:s.id,selected:this.store.isItemSelected(s.id),onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction.bind(this,"collectionrun"),observeSizeChange:this.observeSizeChange,unobserveSizeChange:this.unobserveSizeChange,index:t.index}))):"websockethistory"===s.type?n.a.createElement("div",{className:"history-list__websocket",style:t.style},n.a.createElement(p.default,I({},s,{key:s.id,isSelected:this.store.isItemSelected(s.id),onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction.bind(this,"websockethistory"),observeSizeChange:this.observeSizeChange,unobserveSizeChange:this.unobserveSizeChange,index:t.index}))):"proxyhistory"===s.type?n.a.createElement("div",{className:"history-list__proxy",style:t.style},n.a.createElement(_.default,I({},s,{key:s.id,isSelected:this.store.isItemSelected(s.id),onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction.bind(this,"proxyhistory"),observeSizeChange:this.observeSizeChange,unobserveSizeChange:this.unobserveSizeChange,index:t.index}))):n.a.createElement("div",{className:"history-list__item",style:t.style},n.a.createElement(g.default,I({},s,{hideActions:e.size(this.store.getSelectedItems())>1,key:s.id,selected:this.store.isItemSelected(s.id),onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction.bind(this,"request"),observeSizeChange:this.observeSizeChange,unobserveSizeChange:this.unobserveSizeChange,viewLargeBody:this.props.viewLargeBody,index:t.index}))):null}getNotification(){return this.store.showReloadNotification?n.a.createElement("div",{className:"history-sidebar-list__notification"},n.a.createElement(d.Button,{type:"primary",size:"small",className:"history-sidebar-list__refresh",onClick:this.handleRefresh},n.a.createElement(c.Icon,{name:"icon-action-refresh-stroke",color:"content-color-primary",size:"small",className:"pm-icon"}),"刷新")):this.store.newHistoryIds.size?n.a.createElement("div",{className:"history-sidebar-list__notification"},n.a.createElement(d.Button,{type:"primary",size:"small",className:"history-sidebar-list__more-on-top",onClick:this.handleJumpToTop},n.a.createElement(c.Icon,{name:"icon-direction-up",color:"content-color-primary",size:"small",className:"pm-icon"}),n.a.createElement("span",null,this.store.newHistoryIds.size," ","new"," ",h.default.pluralize({count:this.store.newHistoryIds.size,singular:"item",plural:"items"})))):null}handleListScroll({scrollOffset:e}){0===e&&this.store.newHistoryIds.size&&this.store.showNewHistory(),this.store.setScrollOffset(e)}handleItemsRender(e){this.store.scrolledToEnd||this.store.loadingMore||this.requesterSidebarStore.query||e.overscanStopIndex===e.visibleStopIndex&&this.store.loadMore()}handleJumpToTop(){this.listRef&&this.listRef.scrollTo(0)}handleRefresh(){this.listRef&&this.listRef.scrollTo(0),this.store.load(!0)}render(){const t=e=>n.a.createElement(r.Observer,null,this.getListItem.bind(this,e)),s=({height:e,width:s})=>n.a.createElement(r.Observer,null,(()=>n.a.createElement(l.VariableSizeList,{height:e,itemCount:this.store.historyItems.length,itemSize:this.getItemSize,width:s,ref:e=>{this.listRef=e},overscanCount:10,onItemsRendered:this.handleItemsRenderDebounced,onScroll:this.handleListScrollDebounced},t)));return e.isEmpty(this.store.historyItems)?this.props.initializing||this.store.loading?n.a.createElement("div",{className:"history-sidebar-list"},n.a.createElement(O.default,{hasHierarchy:!0})):this.store.loadError?"您没有权限查看历史在这个工作区"===this.store.loadError.message?n.a.createElement("div",{className:"history-sidebar-list-permission-error"},n.a.createElement(S.default,{illustration:n.a.createElement(c.IllustrationNoPermission,null),title:"您没有权限查看历史",message:"只有团队成员才能查看此工作区的历史"})):n.a.createElement("div",{className:"history-sidebar-list"},n.a.createElement(y.default,{onRetry:()=>this.store.load(!0)})):n.a.createElement("div",{className:"history-sidebar-list"},n.a.createElement(u.default,{query:this.store.searchQuery})):n.a.createElement("div",{className:"history-sidebar-list",ref:"history"},this.getNotification(),n.a.createElement(a.default,null,s))}})||i}.call(this,s(2753))},24794:function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return E}));var i,o=s(2),n=s.n(o),r=s(5),l=s(6743),a=s.n(l),c=s(2825),d=s.n(c),h=s(9),p=s(2353),m=s(8767),u=s(7125),S=s(24584),g=s(5929),b=s(24789),T=s(8759);let E=Object(p.observer)(i=class extends o.Component{constructor(e){super(e),this.state={isTooltipVisible:!1},this.userAvatar=n.a.createRef(),this.handleSelect=this.handleSelect.bind(this),this.handleAction=this.handleAction.bind(this),this.handleDelete=this.handleDelete.bind(this),this.showTooltip=this.showTooltip.bind(this),this.hideTooltip=this.hideTooltip.bind(this),this.getLeftAlignedComponents=this.getLeftAlignedComponents.bind(this),this.getRightAlignedComponents=this.getRightAlignedComponents.bind(this)}componentDidMount(){this.selfNode=Object(r.findDOMNode)(this),this.props.observeSizeChange&&this.props.observeSizeChange(this.selfNode)}componentWillUpdate(e){if(!this.props.selected&&e.selected){const e=Object(r.findDOMNode)(this);e&&e.scrollIntoViewIfNeeded&&e.scrollIntoViewIfNeeded()}}componentWillUnmount(){this.props.unobserveSizeChange&&this.props.unobserveSizeChange(this.selfNode,this.props.index)}getClasses(){return d()({"history-sidebar-list-item":!0,"history-sidebar-list-item__websocket-history":!0,"is-selected":this.props.selected})}getTooltipText(e,t){return e?t?T.DISABLED_TOOLTIP_IS_OFFLINE:T.DISABLED_TOOLTIP_NO_PERMISSION:"删除历史"}getLeftAlignedComponents(e){if(!e)return n.a.createElement("div",{className:"history-sidebar__indent"});const t=d()({"history-sidebar-list-item-updatedBy":!0,hovered:e}),s=Object(g.getStore)("CurrentUserStore").teamMembers.get(String(this.props.owner)),i=s&&(s.name||s.username);return n.a.createElement("div",{className:t,onMouseOver:this.showTooltip,onMouseLeave:this.hideTooltip},this.props.owner&&"0"!==this.props.owner?n.a.createElement(m.default,{ref:this.userAvatar,size:"small",userId:this.props.owner}):n.a.createElement(h.Icon,{name:"icon-descriptive-user-stroke",color:"content-color-secondary"}),this.userAvatar.current&&n.a.createElement(u.Tooltip,{immediate:!0,show:this.state.isTooltipVisible,target:this.userAvatar.current,placement:"right"},n.a.createElement(u.TooltipBody,null,n.a.createElement("div",{className:"history-sidebar-list-item-avatar-tooltip"},n.a.createElement(h.Text,{type:"body-medium"},i),n.a.createElement(h.Text,{type:"body-medium"},a()(this.props.createdAt).format("DD MMM YYYY, h:mm A"))))))}getRightAlignedComponents(e){const t=d()({"sidebar-list-item__right-section-actions":!0,hovered:e});if(!e)return null;const s=Object(g.getStore)("PermissionStore"),{userCanSave:i}=Object(g.getStore)("OnlineStatusStore"),o=i&&s.can("delete","history");return n.a.createElement("div",{className:t},n.a.createElement(h.Button,{type:"tertiary",icon:"icon-action-delete-stroke",onClick:this.handleDelete,isDisabled:!o,tooltip:this.getTooltipText(!o,!i)}))}showTooltip(){this.setState({isTooltipVisible:!0})}hideTooltip(){this.setState({isTooltipVisible:!1})}handleSelect(e){e.stopPropagation();const t={ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};this.props.onSelect&&this.props.onSelect({id:this.props.id,type:"websockethistory"},t)}handleAction(e){this.props.onSelectAction(e,{websockethistory:[this.props.id]})}handleDelete(e){e.stopPropagation(),this.handleAction(b.ACTION_TYPE_DELETE)}render(){return n.a.createElement("div",{"data-index":this.props.index},n.a.createElement(S.default,{text:this.props.url,icon:"icon-entity-websocket-stroke",isSelected:this.props.isSelected,onClick:this.handleSelect,className:this.getClasses(),leftMetaComponent:this.getLeftAlignedComponents,rightMetaComponent:this.getRightAlignedComponents}))}})||i},24795:function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return p}));var i,o=s(2),n=s.n(o),r=s(2353),l=s(9),a=s(7762),c=s(2776),d=s(24588),h=s(11281);let p=Object(r.observer)(i=class extends o.Component{constructor(e){super(e),this.handleShowMeHow=this.handleShowMeHow.bind(this)}handleShowMeHow(){Object(c.openExternalLink)(a.SEND_FIRST_REQUEST_DOCS,"_blank")}render(){return this.props.query?n.a.createElement(h.default,{searchQuery:this.props.query,illustration:n.a.createElement(l.IllustrationNoHistory,null)}):n.a.createElement(d.default,{illustration:n.a.createElement(l.IllustrationNoHistory,null),title:"您尚未发送任何请求.",message:"您在此工作区中发送的任何请求都将显示在此处.",action:{label:"告诉我怎么做",handler:this.handleShowMeHow}})}})||i},24796:function(e,t,s){"use strict";s.r(t),function(e){s.d(t,"default",(function(){return C}));var i,o=s(2),n=s.n(o),r=s(5),l=s(2825),a=s.n(l),c=s(6743),d=s.n(c),h=s(2353),p=s(9),m=s(7124),u=s(7307),S=s(8767),g=s(7125),b=s(24584),T=s(24789),E=s(8759),y=s(8959),O=s(5929),_=s(24791),I=s(7151),f=s(8908),A=s(6375),v=s(6367);let C=Object(h.observer)(i=class extends o.Component{constructor(e){super(e),this.state={dropdownOpen:!1,isTooltipVisible:!1},this.userAvatar=n.a.createRef(),this.handleSelect=this.handleSelect.bind(this),this.handleDropdownToggle=this.handleDropdownToggle.bind(this),this.handleDropdownActionSelect=this.handleDropdownActionSelect.bind(this),this.handleAddRequestToCollectionClick=this.handleAddRequestToCollectionClick.bind(this),this.handleRemoveRequest=this.handleRemoveRequest.bind(this),this.showTooltip=this.showTooltip.bind(this),this.hideTooltip=this.hideTooltip.bind(this),this.getLeftAlignedComponents=this.getLeftAlignedComponents.bind(this),this.getRightAlignedComponents=this.getRightAlignedComponents.bind(this)}async componentDidMount(){this.selfNode=Object(r.findDOMNode)(this),this.props.observeSizeChange&&this.props.observeSizeChange(this.selfNode),this.collectionList=await A.default.subscribe()}componentWillUnmount(){this.props.unobserveSizeChange&&this.props.unobserveSizeChange(this.selfNode,this.props.index)}componentWillUpdate(e){if(!this.props.selected&&e.selected){const e=Object(r.findDOMNode)(this);if(!e)return;e.scrollIntoViewIfNeeded?e.scrollIntoViewIfNeeded():e.scrollIntoView()}}showTooltip(){this.setState({isTooltipVisible:!0})}hideTooltip(){this.setState({isTooltipVisible:!1})}handleSelect(e){e.stopPropagation();const t={ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};this.props.onSelect&&this.props.onSelect({id:this.props.id,type:"request"},t)}getClasses(){return a()({"history-sidebar-list-item":!0,"history-sidebar-list-item__request":!0,"is-hovered":this.state.dropdownOpen,"is-selected":this.props.selected})}handleDropdownToggle(e){e!==this.state.dropdownOpen&&this.setState({dropdownOpen:e})}handleDropdownActionSelect(e){this.props.onSelectAction(e,{requests:[this.props.id],from:"history_single"})}handleAddRequestToCollectionClick(e){e.stopPropagation(),this.handleDropdownActionSelect(T.ACTION_TYPE_SAVE,{from:"history_single"})}handleRemoveRequest(e){e.stopPropagation(),this.handleDropdownActionSelect(T.ACTION_TYPE_DELETE)}getTooltipText(e,t){return e?t?E.DISABLED_TOOLTIP_IS_OFFLINE:E.DISABLED_TOOLTIP_NO_PERMISSION:_.ACTION_TYPE_DELETE_REQUEST_TOOLTIP}getDisabledText(e,t){return t?E.DISABLED_TOOLTIP_IS_OFFLINE:E.DISABLED_TOOLTIP_NO_PERMISSION}getLeftAlignedComponents(e,t){const s=a()({"history-sidebar-list-item-updatedBy":!0,hovered:e});if(!e&&!t)return n.a.createElement("div",{className:"history-sidebar__indent"});const i=Object(O.getStore)("CurrentUserStore").teamMembers.get(this.props.lastUpdatedBy),o=i&&(i.name||i.username);return n.a.createElement("div",{className:s,onMouseEnter:this.showTooltip,onMouseLeave:this.hideTooltip},this.props.lastUpdatedBy&&"0"!==this.props.lastUpdatedBy?n.a.createElement(S.default,{ref:this.userAvatar,size:"small",userId:this.props.lastUpdatedBy}):n.a.createElement(p.Icon,{name:"icon-descriptive-user-stroke",className:"pm-icon pm-icon-normal"}),this.userAvatar.current&&n.a.createElement(g.Tooltip,{immediate:!0,show:this.state.isTooltipVisible,target:this.userAvatar.current,placement:"right"},n.a.createElement(g.TooltipBody,null,n.a.createElement("div",null,n.a.createElement("div",null,o),n.a.createElement("div",null,d()(this.props.createdAt).format("DD MMM YYYY, h:mm A"))))))}getSaveRequestTooltip(e,t){return e?t?_.ACTION_TYPE_SAVE_REQUEST_TOOLTIP:E.DISABLED_TOOLTIP_NO_PERMISSION:E.DISABLED_TOOLTIP_IS_OFFLINE}getRightAlignedComponents(t,s){const i=a()({"sidebar-list-item__right-section-actions":!0,hovered:t});if(!t&&!s)return null;const o=Object(O.getStore)("PermissionStore"),{userCanSave:r}=Object(O.getStore)("OnlineStatusStore"),l=r&&o.can("delete","history",this.props.id),c=this.collectionList&&!e.isEmpty(this.collectionList.unsafeEditableCollections),d=Object(O.getStore)("ActiveWorkspacePermissionStore"),h=d&&d.permissions,u=e.get(h,v.WORKSPACE_PERMISSIONS.ADD_COLLECTION_TO_WORKSPACE,!0),S=c||u;return n.a.createElement("div",{className:i},n.a.createElement(m.Button,{className:"history-sidebar-list-item__button__add",type:"icon",onClick:this.handleAddRequestToCollectionClick,disabled:!r||!S,tooltip:this.getSaveRequestTooltip(r,S)},n.a.createElement(p.Icon,{size:"large",name:"icon-action-add-stroke",className:"history-sidebar-list-item__actions__add pm-icon pm-icon-normal"})),n.a.createElement(m.Button,{className:"history-sidebar-list-item__button__delete",type:"icon",onClick:this.handleRemoveRequest,disabled:!l,tooltip:this.getTooltipText(!l,!r)},n.a.createElement(p.Icon,{name:"icon-action-delete-stroke",size:"large",className:"history-sidebar-list-item__actions__delete pm-icon pm-icon-normal"})))}getDisabledTooltip(e,t){return e?t?E.DISABLED_TOOLTIP_WORKSPACE_VIEWER:y.DISABLED_IN_SCRATCHPAD_TOOLTIP:E.DISABLED_TOOLTIP_IS_OFFLINE}getActionsMenuItems(t){const{userCanSave:s,userCanSaveAndSync:i}=Object(O.getStore)("OnlineStatusStore"),o=Object(O.getStore)("ActiveWorkspacePermissionStore"),r=o&&o.permissions,l=!e.get(r,v.WORKSPACE_PERMISSIONS.ADD_MOCK_TO_WORKSPACE,!0),a=!e.get(r,v.WORKSPACE_PERMISSIONS.ADD_MONITOR_TO_WORKSPACE,!0),c=!e.get(r,v.WORKSPACE_PERMISSIONS.ADD_COLLECTION_TO_WORKSPACE,!0),d=this.collectionList&&!e.isEmpty(this.collectionList.unsafeEditableCollections),h=e.get(r,v.WORKSPACE_PERMISSIONS.ADD_COLLECTION_TO_WORKSPACE,!0),p=d||h;return n.a.createElement(u.DropdownMenu,{"align-right":!0},n.a.createElement(u.MenuItem,{refKey:T.ACTION_TYPE_SAVE,disabled:!s||!p,disabledText:this.getSaveRequestTooltip(s,p)},n.a.createElement("div",{className:"dropdown-menu-item-label"},"保存请求")),n.a.createElement(u.MenuItem,{refKey:T.ACTION_TYPE_MONITOR,disabled:!i||a,disabledText:s?E.DISABLED_TOOLTIP_WORKSPACE_VIEWER:E.DISABLED_TOOLTIP_IS_OFFLINE},n.a.createElement("div",{className:"dropdown-menu-item-label"},"监视请求")),n.a.createElement(u.MenuItem,{refKey:T.ACTION_TYPE_DOCUMENT,disabled:!i||c,disabledText:this.getDisabledTooltip(s,c)},n.a.createElement("div",{className:"dropdown-menu-item-label"},"请求文档")),n.a.createElement(u.MenuItem,{refKey:T.ACTION_TYPE_MOCK,disabled:!i||l,disabledText:s?E.DISABLED_TOOLTIP_WORKSPACE_VIEWER:E.DISABLED_TOOLTIP_IS_OFFLINE},n.a.createElement("div",{className:"dropdown-menu-item-label"},"模拟请求")),n.a.createElement(u.MenuItem,{refKey:T.ACTION_TYPE_DELETE,disabled:!s||!t,disabledText:this.getDisabledText(!s)},n.a.createElement("div",{className:"dropdown-menu-item-label"},"删除"),n.a.createElement("div",{className:"dropdown-menu-item-shortcut"},Object(f.getShortcutByName)("delete"))))}render(){const e=Object(O.getStore)("PermissionStore").can("delete","history",this.props.id);return n.a.createElement(b.default,{"data-index":this.props.index,text:this.props.url,onClick:this.handleSelect,isSelected:this.props.selected,icon:n.a.createElement(I.default,{method:this.props.method||"GET"}),className:this.getClasses(),moreActions:this.getActionsMenuItems(e),rightMetaComponent:this.getRightAlignedComponents,leftMetaComponent:this.getLeftAlignedComponents,onActionsDropdownSelect:this.handleDropdownActionSelect})}})||i}.call(this,s(2753))},24797:function(e,t,s){"use strict";s.r(t),function(e){s.d(t,"default",(function(){return g}));var i=s(2),o=s.n(i),n=s(2825),r=s.n(n),l=s(9),a=s(7124),c=s(24789),d=s(8759),h=s(5929),p=s(24791),m=s(6375),u=s(6367),S=s(24792);class g extends i.PureComponent{constructor(e){super(e),this.state={dropdownOpen:!1,isHovered:!1},this.store=Object(h.getStore)("HistorySidebarStore"),this.handleToggleGroup=this.handleToggleGroup.bind(this),this.handleDropdownToggle=this.handleDropdownToggle.bind(this),this.handleDropdownActionSelect=this.handleDropdownActionSelect.bind(this),this.handleAddRequestToCollectionClick=this.handleAddRequestToCollectionClick.bind(this),this.handleRemoveRequest=this.handleRemoveRequest.bind(this),this.handleMouseEnter=this.handleMouseEnter.bind(this),this.handleMouseLeave=this.handleMouseLeave.bind(this)}async componentDidMount(){this.collectionList=await m.default.subscribe()}handleMouseEnter(){this.setState({isHovered:!0})}handleMouseLeave(){!this.state.dropdownOpen&&this.setState({isHovered:!1})}getCollapseButtonClasses(){return r()({caret:!0,"pm-icon":!0,"pm-icon-normal":!0,"is-closed":this.store.isItemCollapsed(this.props.name)})}getMetaClasses(){return r()({"history-sidebar-list-item-group__meta":!0,"is-hovered":this.state.dropdownOpen})}handleToggleGroup(){const{name:e}=this.props;if(this.store.isItemCollapsed(e))return this.store.expandItem(e);this.store.collapseItem(e)}handleDropdownToggle(e){e!==this.state.dropdownOpen&&this.setState({dropdownOpen:e})}handleDropdownActionSelect(t){const s={requests:e.reduce(this.props.items,((e,t)=>("request"===t.type&&e.push(t.id),e)),[]),runs:e.reduce(this.props.items,((e,t)=>("collectionrun"===t.type&&e.push(t.id),e)),[]),websockethistory:e.reduce(this.props.items,((e,t)=>("websockethistory"===t.type&&e.push(t.id),e)),[]),proxyhistory:e.reduce(this.props.items,((e,t)=>("proxyhistory"===t.type&&e.push(t.id),e)),[]),defaultCollectionName:this.props.name,from:"history_date_group"};t!==c.ACTION_TYPE_DELETE?this.props.onSelectAction(t,s):pm.mediator.trigger("showDeleteHistoryModal",(()=>{this.props.onSelectAction(t,s)}),{identifier:"selected"})}handleAddRequestToCollectionClick(e){e.stopPropagation(),this.handleDropdownActionSelect(c.ACTION_TYPE_SAVE)}handleRemoveRequest(e){e.stopPropagation(),this.handleDropdownActionSelect(c.ACTION_TYPE_DELETE)}getHistoryDeleteTooltip(e,t){return e?t?p.ACTION_TYPE_DELETE_REQUESTS_TOOLTIP:d.DISABLED_TOOLTIP_NO_PERMISSION:d.DISABLED_TOOLTIP_IS_OFFLINE}getAddRequestTooltip(e,t,s){return e?t?s?"不适用于集合运行项目":p.ACTION_TYPE_SAVE_REQUESTS_TOOLTIP:d.DISABLED_TOOLTIP_NO_PERMISSION:d.DISABLED_TOOLTIP_IS_OFFLINE}render(){const t=e.size(this.store.getSelectedItems())>1,{userCanSave:s}=Object(h.getStore)("OnlineStatusStore"),i=Object(h.getStore)("ActiveWorkspacePermissionStore"),n=i&&i.permissions,r=e.get(n,u.WORKSPACE_PERMISSIONS.REMOVE_HISTORY_FROM_WORKSPACE,!0),c=this.collectionList&&!e.isEmpty(this.collectionList.unsafeEditableCollections),d=e.get(n,u.WORKSPACE_PERMISSIONS.ADD_COLLECTION_TO_WORKSPACE,!0),p=c||d;return o.a.createElement("div",{className:"history-sidebar-list-item-group",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},o.a.createElement("div",{className:this.getMetaClasses(),onClick:this.handleToggleGroup},o.a.createElement("div",{className:"history-sidebar-list-item-group__name"},o.a.createElement(l.Icon,{name:"icon-direction-down",className:this.getCollapseButtonClasses()}),o.a.createElement("span",null,this.props.name)),!t&&this.state.isHovered&&o.a.createElement("div",{className:"history-sidebar-list-item-group__actions"},o.a.createElement(a.Button,{className:"history-sidebar-list-item__button__add",type:"icon",disabled:!s||this.props.disableRequestSpecificActions||!p,onClick:this.handleAddRequestToCollectionClick,tooltip:this.getAddRequestTooltip(s,p,this.props.disableRequestSpecificActions)},o.a.createElement(l.Icon,{name:"icon-action-add-stroke",className:"history-sidebar-list-item__actions__add pm-icon pm-icon-normal"})),o.a.createElement(a.Button,{className:"history-sidebar-list-item__button__delete",type:"icon",onClick:this.handleRemoveRequest,disabled:!s||!r,tooltip:this.getHistoryDeleteTooltip(s,r)},o.a.createElement(l.Icon,{name:"icon-action-delete-stroke",className:"history-sidebar-list-item__actions__delete pm-icon pm-icon-normal"})),o.a.createElement(S.default,{count:e.size(this.props.items),onSelect:this.handleDropdownActionSelect,onToggle:this.handleDropdownToggle,disableRequestSpecificActions:this.props.disableRequestSpecificActions,canAddRequest:this.props.canAddRequest}))))}}}.call(this,s(2753))},24798:function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return n}));var i=s(2),o=s.n(i);function n(e){return o.a.createElement("div",{className:"history-sidebar-list-item-group"},o.a.createElement("div",{className:"history-sidebar-list-item-group__error"},"无法加载项."," ",o.a.createElement("span",{onClick:e.onRetry},"重试")))}},24799:function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return y}));var i,o=s(2),n=s.n(o),r=s(5),l=s(2825),a=s.n(l),c=s(9),d=s(6743),h=s.n(d),p=s(2353),m=s(7124),u=s(8767),S=s(7125),g=s(24789),b=s(8759),T=s(5929),E=s(24584);let y=Object(p.observer)(i=class extends o.Component{constructor(e){super(e),this.state={dropdownOpen:!1,isTooltipVisible:!1},this.userAvatar=n.a.createRef(),this.handleSelect=this.handleSelect.bind(this),this.handleDropdownToggle=this.handleDropdownToggle.bind(this),this.handleDropdownActionSelect=this.handleDropdownActionSelect.bind(this),this.handleRemoveRun=this.handleRemoveRun.bind(this),this.showTooltip=this.showTooltip.bind(this),this.hideTooltip=this.hideTooltip.bind(this),this.getRightAlignedComponents=this.getRightAlignedComponents.bind(this),this.getLeftAlignedComponents=this.getLeftAlignedComponents.bind(this)}componentDidMount(){this.selfNode=Object(r.findDOMNode)(this),this.props.observeSizeChange&&this.props.observeSizeChange(this.selfNode)}componentWillUnmount(){this.props.unobserveSizeChange&&this.props.unobserveSizeChange(this.selfNode,this.props.index)}componentWillUpdate(e){if(!this.props.selected&&e.selected){const e=Object(r.findDOMNode)(this);e&&e.scrollIntoViewIfNeeded&&e.scrollIntoViewIfNeeded()}}showTooltip(){this.setState({isTooltipVisible:!0})}hideTooltip(){this.setState({isTooltipVisible:!1})}handleSelect(e){e.stopPropagation();const t={ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};this.props.onSelect&&this.props.onSelect({id:this.props.id,type:"collectionrun"},t)}getClasses(){return a()({"history-sidebar-list-item":!0,"history-sidebar-list-item__collection":!0,"is-hovered":this.state.dropdownOpen,"is-selected":this.props.selected})}handleDropdownToggle(e){e!==this.state.dropdownOpen&&this.setState({dropdownOpen:e})}handleDropdownActionSelect(e){this.props.onSelectAction(e,{runs:[this.props.id]})}handleRemoveRun(e){e.stopPropagation(),this.handleDropdownActionSelect(g.ACTION_TYPE_DELETE)}getTooltipText(e){return e?Object(T.getStore)("OnlineStatusStore").userCanSave?b.DISABLED_TOOLTIP_NO_PERMISSION:b.DISABLED_TOOLTIP_IS_OFFLINE:"删除集合运行"}getLeftAlignedComponents(e,t){const s=a()({"history-sidebar-list-item-updatedBy":!0,hovered:e});if(!e&&!t)return n.a.createElement("div",{className:"history-sidebar__indent"});const i=Object(T.getStore)("CurrentUserStore").teamMembers.get(this.props.owner),o=i&&(i.name||i.username);return n.a.createElement("div",{className:s,onMouseEnter:this.showTooltip,onMouseLeave:this.hideTooltip},this.props.owner&&"0"!==this.props.owner?n.a.createElement(u.default,{ref:this.userAvatar,size:"small",userId:this.props.owner}):n.a.createElement(c.Icon,{name:"icon-descriptive-user-stroke",className:"pm-icon pm-icon-normal"}),this.userAvatar.current&&n.a.createElement(S.Tooltip,{immediate:!0,show:this.state.isTooltipVisible,target:this.userAvatar.current,placement:"right"},n.a.createElement(S.TooltipBody,null,n.a.createElement("div",null,n.a.createElement("div",null,o),n.a.createElement("div",null,h()(this.props.createdAt).format("DD MMM YYYY, h:mm A"))))))}getRightAlignedComponents(e,t){const s=a()({"sidebar-list-item__right-section-actions":!0,hovered:e});if(!e&&!t)return null;const i=Object(T.getStore)("PermissionStore"),{userCanSave:o}=Object(T.getStore)("OnlineStatusStore"),r=o&&i.can("delete","collectionrun",this.props.id);return n.a.createElement("div",{className:s},n.a.createElement(m.Button,{className:"history-sidebar-list-item__button__delete",type:"icon",onClick:this.handleRemoveRun,disabled:!r,tooltip:this.getTooltipText(!r)},n.a.createElement(c.Icon,{name:"icon-action-delete-stroke",className:"history-sidebar-list-item__actions__delete pm-icon pm-icon-normal"})))}render(){return n.a.createElement(E.default,{"data-index":this.props.index,text:this.props.name,icon:"icon-action-run-stroke",isSelected:this.props.selected,onClick:this.handleSelect,className:this.getClasses(),rightMetaComponent:this.getRightAlignedComponents,leftMetaComponent:this.getLeftAlignedComponents})}})||i},24800:function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return r}));var i=s(2),o=s.n(i),n=s(7124);function r(e){return o.a.createElement("div",{className:"history-sidebar-list-error"},o.a.createElement("h4",null,"无法加载历史"),o.a.createElement("p",null,"尝试加载历史项目时出了点问题. 检查您的互联网,然后重试."),o.a.createElement(n.Button,{type:"secondary",onClick:e.onRetry},"重试"))}},24801:function(e,t,s){"use strict";s.r(t),function(e){s.d(t,"default",(function(){return f}));var i,o=s(2),n=s.n(o),r=s(5),l=s(6743),a=s.n(l),c=s(2825),d=s.n(c),h=s(9),p=s(2353),m=s(8767),u=s(7125),S=s(24584),g=s(5929),b=s(8759),T=s(7307),E=s(2765),y=s(12679),O=s(8908),_=s(12592),I=s(10445);let f=Object(p.observer)(i=class extends o.Component{constructor(e){super(e),this.state={isTooltipVisible:!1},this.proxyStore=Object(g.getStore)("ProxySessionsSettingsStore"),this.userAvatar=n.a.createRef(),this.handleSelect=this.handleSelect.bind(this),this.handleAction=this.handleAction.bind(this),this.showTooltip=this.showTooltip.bind(this),this.hideTooltip=this.hideTooltip.bind(this),this.getLeftAlignedComponents=this.getLeftAlignedComponents.bind(this),this.getActionMenuItems=this.getActionMenuItems.bind(this),this.handleRenameSubmit=this.handleRenameSubmit.bind(this),this.containerRef=this.containerRef.bind(this),this.handleDropdownActionSelect=this.handleDropdownActionSelect.bind(this)}componentDidMount(){this.selfNode=Object(r.findDOMNode)(this),this.props.observeSizeChange&&this.props.observeSizeChange(this.selfNode)}componentWillUpdate(e){if(!this.props.selected&&e.selected){const e=Object(r.findDOMNode)(this);e&&e.scrollIntoViewIfNeeded&&e.scrollIntoViewIfNeeded()}}componentWillUnmount(){this.props.unobserveSizeChange&&this.props.unobserveSizeChange(this.selfNode,this.props.index)}getClasses(){return d()({"history-sidebar-list-item":!0,"history-sidebar-list-item__proxy-history":!0,"is-selected":this.props.selected})}getTooltipText(e,t){return e?t?b.DISABLED_TOOLTIP_IS_OFFLINE:b.DISABLED_TOOLTIP_NO_PERMISSION:"删除历史"}getLeftAlignedComponents(e){if(!e)return n.a.createElement("div",{className:"history-sidebar__indent"});const t=d()({"history-sidebar-list-item-updatedBy":!0,hovered:e}),s=Object(g.getStore)("CurrentUserStore").teamMembers.get(String(this.props.owner)),i=s&&(s.name||s.username);return n.a.createElement("div",{className:t,onMouseOver:this.showTooltip,onMouseLeave:this.hideTooltip},this.props.owner&&"0"!==this.props.owner?n.a.createElement(m.default,{ref:this.userAvatar,size:"small",userId:this.props.owner}):n.a.createElement(h.Icon,{name:"icon-descriptive-user-stroke",color:"content-color-secondary"}),this.userAvatar.current&&n.a.createElement(u.Tooltip,{immediate:!0,show:this.state.isTooltipVisible,target:this.userAvatar.current,placement:"right"},n.a.createElement(u.TooltipBody,null,n.a.createElement("div",{className:"history-sidebar-list-item-avatar-tooltip"},n.a.createElement(h.Text,{type:"body-medium"},i),n.a.createElement(h.Text,{type:"body-medium"},a()(this.props.createdAt).format("DD MMM YYYY, h:mm A"))))))}showTooltip(){this.setState({isTooltipVisible:!0})}hideTooltip(){this.setState({isTooltipVisible:!1})}handleSelect(){this.proxyStore.find(this.props.id)?this.proxyStore.update({id:this.props.id,name:this.props.name}):this.proxyStore.add({id:this.props.id,name:this.props.name,reqData:[],source:this.props.source,totalRecords:0});let t,s,i={name:this.props.name,source:this.props.source};this.props.state===_.SESSION_STATES.RUNNING?(t=I.CAPTURE_REQUESTS_SESSIONS_CONFIGURE_PAGE_IDENTIFIER,s={proxyId:_.CONFIGURE_PAGE_ID}):(t=I.CAPTURE_REQUEST_POST_SESSION_PAGE_IDENTIFIER,s={proxySessionId:this.props.id},e.assign(i,{createdAt:this.props.createdAt,fromActiveSession:!1})),E.default.transitionTo(t,s,{},{additionalContext:i})}handleAction(e){this.props.onSelectAction(e,{proxyhistory:[this.props.id]})}getProxySidebarIcon(e){return e==_.SESSION_STATES.RUNNING?n.a.createElement(h.IconActionCaptureStroke,{color:"content-color-success"}):n.a.createElement(h.IconActionCaptureStroke,null)}getActionMenuItems(e){let t=!1;return e===_.SESSION_STATES.RUNNING&&(t=!0),n.a.createElement(T.DropdownMenu,{"align-right":!0},n.a.createElement(T.MenuItem,{key:"proxy-rename",refKey:"proxy-rename"},n.a.createElement("div",{className:"dropdown-menu-item-label"},"Rename Session")),n.a.createElement(T.MenuItem,{key:"proxy-delete",refKey:"delete",disabled:t,disabledText:"Session is in progress"},n.a.createElement("div",{className:"dropdown-menu-item-label"},"Delete Session"),n.a.createElement("div",{className:"dropdown-menu-item-shortcut"},Object(O.getShortcutByName)("delete"))))}async handleRenameSubmit(e){await y.default.updateProxyHistory({id:this.props.id,name:e}),this.proxyStore.update({id:this.props.id,name:e}),pm.toasts.success("Session renamed successfully")}containerRef(e){this.listItemRef=e}handleEditName(){e.invoke(this.listItemRef,"editText")}handleDropdownActionSelect(e){"proxy-rename"===e&&this.handleEditName(),"delete"===e&&this.props.onSelectAction("delete",{proxyhistory:[this.props.id]})}render(){return n.a.createElement("div",{"data-index":this.props.index},n.a.createElement(S.default,{ref:this.containerRef,text:this.props.name,icon:this.getProxySidebarIcon(this.props.state),isSelected:this.props.isSelected,onClick:this.handleSelect,className:this.getClasses(),leftMetaComponent:this.getLeftAlignedComponents,state:this.props.state,moreActions:this.getActionMenuItems(this.props.state),onRename:this.handleRenameSubmit,onActionsDropdownSelect:this.handleDropdownActionSelect}))}})||i}.call(this,s(2753))},24802:function(e,t,s){"use strict";s.r(t),function(e){s.d(t,"openWebSocketHistoryTab",(function(){return l})),s.d(t,"deleteWebSocketHistory",(function(){return a}));var i=s(2765),o=s(5929),n=s(6734),r=s(10233);function l(e,t={preview:!0}){return i.default.transitionTo(n.WORKFLOW_IDENTIFIER.OPEN_WEBSOCKET_HISTORY,{whid:e},{},{tabOptions:{preview:t.preview,forceNew:t.forceNew}})}function a(t){e.isString(t)&&(t=[t]),e.isArray(t)||void 0===t?(Object(o.getStore)("WebSocketHistoryStore").remove(t),r.default.deleteHistory(Object(o.getStore)("ActiveWorkspaceStore").id,t).catch((e=>{pm.logger.error("WebSocketRequestInterface~deleteHistory: Error in deleting websocket history",e)}))):pm.logger.warn("WebSocketRequestInterface~deleteWebSocketHistory: Invalid input.")}}.call(this,s(2753))}}]);